<?xml version="1.0" encoding="UTF-8"?><rss xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:content="http://purl.org/rss/1.0/modules/content/" xmlns:atom="http://www.w3.org/2005/Atom" version="2.0"><channel><title><![CDATA[Freckie et al.]]></title><description><![CDATA[나는야 깃허브 스타될거야.]]></description><link>https://blog.frec.kr</link><generator>GatsbyJS</generator><lastBuildDate>Sun, 18 Feb 2024 13:20:29 GMT</lastBuildDate><item><title><![CDATA[Ingress에 정의된 path에 regex 사용시 라우팅되지 않던 이슈]]></title><description><![CDATA[문제 상황  표면적으로 보이던 에러 상황 프론트엔드에서 로의 모든 request가 404 에러 발생 request가 도착해야할 pod에 어떠한 로그도 찍히지 않았다. 다만, ingress-nginx-controller 로그에는 request…]]></description><link>https://blog.frec.kr/troubleshooting/ingress_nginx_regex/</link><guid isPermaLink="false">https://blog.frec.kr/troubleshooting/ingress_nginx_regex/</guid><pubDate>Sun, 18 Feb 2024 21:48:00 GMT</pubDate><content:encoded>&lt;h2 id=&quot;문제-상황&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#%EB%AC%B8%EC%A0%9C-%EC%83%81%ED%99%A9&quot; aria-label=&quot;문제 상황 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;문제 상황&lt;/h2&gt;
&lt;p&gt;&lt;code class=&quot;language-text&quot;&gt;Ingress.yaml&lt;/code&gt;&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;yaml&quot;&gt;&lt;pre class=&quot;language-yaml&quot;&gt;&lt;code class=&quot;language-yaml&quot;&gt;&lt;span class=&quot;token key atrule&quot;&gt;apiVersion&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; networking.k8s.io/v1
&lt;span class=&quot;token key atrule&quot;&gt;kind&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; Ingress
&lt;span class=&quot;token key atrule&quot;&gt;metadata&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
  &lt;span class=&quot;token key atrule&quot;&gt;name&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; api&lt;span class=&quot;token punctuation&quot;&gt;-&lt;/span&gt;ingress
  &lt;span class=&quot;token key atrule&quot;&gt;namespace&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; mynamespace
  &lt;span class=&quot;token key atrule&quot;&gt;annotations&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
    &lt;span class=&quot;token key atrule&quot;&gt;kubernetes.io/ingress.class&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;nginx&quot;&lt;/span&gt;
    &lt;span class=&quot;token key atrule&quot;&gt;nginx.ingress.kubernetes.io/use-regex&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;true&quot;&lt;/span&gt;
    &lt;span class=&quot;token key atrule&quot;&gt;nginx.ingress.kubernetes.io/rewrite-target&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; /$2
&lt;span class=&quot;token key atrule&quot;&gt;spec&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
  &lt;span class=&quot;token key atrule&quot;&gt;rules&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
    &lt;span class=&quot;token punctuation&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;token key atrule&quot;&gt;http&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
        &lt;span class=&quot;token key atrule&quot;&gt;paths&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
          &lt;span class=&quot;token punctuation&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;token key atrule&quot;&gt;path&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;/api(/|$)(.*)&quot;&lt;/span&gt;
            &lt;span class=&quot;token key atrule&quot;&gt;pathType&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; Prefix
            &lt;span class=&quot;token key atrule&quot;&gt;backend&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
              &lt;span class=&quot;token key atrule&quot;&gt;service&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
                &lt;span class=&quot;token key atrule&quot;&gt;name&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; api&lt;span class=&quot;token punctuation&quot;&gt;-&lt;/span&gt;spring&lt;span class=&quot;token punctuation&quot;&gt;-&lt;/span&gt;service
                &lt;span class=&quot;token key atrule&quot;&gt;port&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
                  &lt;span class=&quot;token key atrule&quot;&gt;number&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;80&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;h3 id=&quot;표면적으로-보이던-에러-상황&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#%ED%91%9C%EB%A9%B4%EC%A0%81%EC%9C%BC%EB%A1%9C-%EB%B3%B4%EC%9D%B4%EB%8D%98-%EC%97%90%EB%9F%AC-%EC%83%81%ED%99%A9&quot; aria-label=&quot;표면적으로 보이던 에러 상황 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;표면적으로 보이던 에러 상황&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;프론트엔드에서 &lt;code class=&quot;language-text&quot;&gt;/api/*&lt;/code&gt;로의 모든 request가 404 에러 발생&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;request가 도착해야할 pod에 어떠한 로그도 찍히지 않았다.&lt;/li&gt;
&lt;li&gt;다만, ingress-nginx-controller 로그에는 request가 도착했고 404를 돌려줬다는 로그가 찍혔다.&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;여기서, 다음 상황이라고 추측했다.&lt;/li&gt;
&lt;/ul&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;text&quot;&gt;&lt;pre class=&quot;language-text&quot;&gt;&lt;code class=&quot;language-text&quot;&gt;프론트엔드 → ingress-nginx-controller —(연결 두절?)→ 백엔드 service → pod&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;h3 id=&quot;원인-추적&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#%EC%9B%90%EC%9D%B8-%EC%B6%94%EC%A0%81&quot; aria-label=&quot;원인 추적 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;원인 추적&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;Ingress를 살짝 바꿔 적용 후 ingress-nginx-controller 로그를 살펴봄.&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;text&quot;&gt;&lt;pre class=&quot;language-text&quot;&gt;&lt;code class=&quot;language-text&quot;&gt;I0216 08:16:46.523876       7 main.go:100] &amp;quot;successfully validated configuration, accepting&amp;quot; ingress=&amp;quot;mynamespace/api-ingress&amp;quot;

I0216 08:16:46.529334       7 store.go:434] &amp;quot;Found valid IngressClass&amp;quot; ingress=&amp;quot;mynamespace/api-ingress&amp;quot; ingressclass=&amp;quot;nginx&amp;quot;

W0216 08:16:46.529372       7 store.go:869] ingress mynamespace/api-ingress contains invalid path /api(/|$)(.*)&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;ul&gt;
&lt;li&gt;ingress가 변경된 후, controller에서 변경을 감지해 reconcile하는 과정에서 path가 잘못되었다고 얘기하고 있다.&lt;/li&gt;
&lt;li&gt;에러도 아니고 경고였기 때문에 무시하고 지나쳤지만.. 해당 path는 아예 라우팅을 못해준다는 상황을 겨우 경고로 내뱉다니?&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;이전에 성공적으로 동작하던 클러스터와 동작하지 않는 클러스터의 ingress-nginx-controller 이미지를 비교해봤다.&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;이전 클러스터 (동작O) : &lt;code class=&quot;language-text&quot;&gt;registry.k8s.io/ingress-nginx/controller:v1.6.4&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;&lt;span
      class=&quot;gatsby-resp-image-wrapper&quot;
      style=&quot;position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 1200px; &quot;
    &gt;
      &lt;span
    class=&quot;gatsby-resp-image-background-image&quot;
    style=&quot;padding-bottom: 56.333333333333336%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAALCAYAAAB/Ca1DAAAACXBIWXMAABYlAAAWJQFJUiTwAAACiUlEQVQozzWSTW/bRhCGeWoNJKgtS9SS3G/ukiuSomRJVuwyVCMjQdDmFORYoC7QP1cg7KG/rUiUD0YzXdHO4cHMuzOYnZnd4NpafbMt/l5tn/1zvb19v1pvu2px1dm86ExedcvVdbf75a67bdquXq47k80668ohnrmic7PBvrd5+a8/a4JwOt3VRYLtiz3u7l5iVi4w4ilOCMURn2GoCkxdiYm0OIkFXkYMxxEfiChHqRgKybwVyJX5KyDRtHEZ/Zym9tuUp18viOjHieqJtH3MXU953itd9FLP+oTbPmH+nJp+4nPCRPoc2RPKv4jU4NXm5o/gPFJNnFa+iEZpZ+DmS2DGgS5roNxCnKTgC3geLGUZxMxAmCgYx9KjYETEMVIOr2/b++CCZg2189ONaGcllIslRkwhoRKnTCLhahhzNPUrOK3B25Oe+JEn8QCMCT3GKsfNzfP74GnIfcG6Z9nCd+ggzQtU1qEwOUqP9loYh4lIMX7ktL9Lwh7hcBHSYySzh4I/EdEwW/a+S6TagqsqyMs5FPXC+3OoVhvYv3kH86sV1Os1LDcbKBZLyH0sr+ohNy+rY1Ytcf2suQ+ejFkjVNbr1GFM1VG5BZhZBambgR8dyAkqBz/mGmKhgSozkMgUqDTHROhv3Ba4fhz5ud69PBa/vcX1vsHXO4smtziKpEcMXH73yQMXhA981+chAyIy/yi7P4MwZjf5/tV/5u7XT3Wz/bjfsoM2+hBSfaDKerIDYfoQC3Ng3vf/8UA9TOdDbNAq+6BsAVV99XuQRNGTURD8fB4Eu7Pgxzb4gbejS9LGJGy1lK3RqiXhpOU0aTOTtkrwVivR5ta0qZKDdpk9xXZnZ2eT/wH07QzFKQsH4AAAAABJRU5ErkJggg==&apos;); background-size: cover; display: block;&quot;
  &gt;&lt;/span&gt;
  &lt;img
        class=&quot;gatsby-resp-image-image&quot;
        alt=&quot;20240218-1.png&quot;
        title=&quot;20240218-1.png&quot;
        src=&quot;/static/6a91092c17055b05312ca502c046a1c6/c1b63/20240218-1.png&quot;
        srcset=&quot;/static/6a91092c17055b05312ca502c046a1c6/5a46d/20240218-1.png 300w,
/static/6a91092c17055b05312ca502c046a1c6/0a47e/20240218-1.png 600w,
/static/6a91092c17055b05312ca502c046a1c6/c1b63/20240218-1.png 1200w,
/static/6a91092c17055b05312ca502c046a1c6/d61c2/20240218-1.png 1800w,
/static/6a91092c17055b05312ca502c046a1c6/97a96/20240218-1.png 2400w,
/static/6a91092c17055b05312ca502c046a1c6/6149e/20240218-1.png 2784w&quot;
        sizes=&quot;(max-width: 1200px) 100vw, 1200px&quot;
        style=&quot;width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;&quot;
        loading=&quot;lazy&quot;
      /&gt;
    &lt;/span&gt;    &lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;지금 클러스터 (동작X) : &lt;code class=&quot;language-text&quot;&gt;registry.k8s.io/ingress-nginx/controller:v1.6.3&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;&lt;span
      class=&quot;gatsby-resp-image-wrapper&quot;
      style=&quot;position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 1200px; &quot;
    &gt;
      &lt;span
    class=&quot;gatsby-resp-image-background-image&quot;
    style=&quot;padding-bottom: 56.333333333333336%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAALCAYAAAB/Ca1DAAAACXBIWXMAABYlAAAWJQFJUiTwAAACaElEQVQoz0WSS2/UMBDHcwIkkLqPZBPHdvyI89o8lrYspWmWLqJA1RPiiIADXw6p4cBnQ7A80rWZ9bbi8NN/xhn9PTOxs1RKnCzzL0+enX5tz55fHx0/7cv6ca/SoldZ1Sd52Z+tzvu2O++TbL4/vyXJij7LrV6rdP4NtHVm/mxV58hcvH5jXl1eGTVvTEClcX1sxlFuPF4Ymc1NyJRxUWQmATHTgFoCTA3jxERsB+SEf3b8YNZmCf4tpbrxiPw78ukwDfngMzUgmg2YpgMXxcBEPoRUDZgkAyLxMEVs8EIGNWwISPQnjDhcwD44BwFvkSzBRBimcp1VC03iTMuy0SFROgilRjgG9kppas/dkOsp2jMJ2NbFMXQoPjojnLRYVQMUGJXPdV43xsfMMiMMxhdm4hMznsEKYA0j0N3YLqJ3aDegWw+LveEjj4JhPZCkgQ4zLdJ8pxYOiCQ3VKYmjCTsMba4QWQvuUUDWze8NTzwozZKKzCsDRZKZ2Wp03ml580CYtDFkV5fvdPV4aFujo/1AijqRufVjtrWpmW1lXllZiGDDl3aUpYMUhUGEbHlWaPjvNQyzTX8NQuMbxVRoVEkNGaxhXC1023I5A1iCayJ25HPxOrltrh8a47WrXm9UiZOlRkHDIgsk7vY/w+8BouNZ1RPkB35k+MhcpKuL77HLy5/1e3y53pJNiIWG1jyBnMFJBufiA2K4g2BGN7jBgNEpPZbuI9/UJHqAEfvnTAIHo4d5/TAcVYPnPudc49244nfId/rBGNdLHjne25Hcdglsex4RDvBoy5VcSc5s3mWqF2+Go1G7j9RRQpU+9vKRgAAAABJRU5ErkJggg==&apos;); background-size: cover; display: block;&quot;
  &gt;&lt;/span&gt;
  &lt;img
        class=&quot;gatsby-resp-image-image&quot;
        alt=&quot;20240218-2.png&quot;
        title=&quot;20240218-2.png&quot;
        src=&quot;/static/18a1dad3cfdb365d4d4cb289df1ce7c6/c1b63/20240218-2.png&quot;
        srcset=&quot;/static/18a1dad3cfdb365d4d4cb289df1ce7c6/5a46d/20240218-2.png 300w,
/static/18a1dad3cfdb365d4d4cb289df1ce7c6/0a47e/20240218-2.png 600w,
/static/18a1dad3cfdb365d4d4cb289df1ce7c6/c1b63/20240218-2.png 1200w,
/static/18a1dad3cfdb365d4d4cb289df1ce7c6/d61c2/20240218-2.png 1800w,
/static/18a1dad3cfdb365d4d4cb289df1ce7c6/97a96/20240218-2.png 2400w,
/static/18a1dad3cfdb365d4d4cb289df1ce7c6/6149e/20240218-2.png 2784w&quot;
        sizes=&quot;(max-width: 1200px) 100vw, 1200px&quot;
        style=&quot;width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;&quot;
        loading=&quot;lazy&quot;
      /&gt;
    &lt;/span&gt;    &lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;태그의 마이너 버전이 하나가 다운그레이드 된 것.&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;현재 클러스터는 ingress-nginx-controller를 다음 가이드대로 설치하고 있다.&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;bash&quot;&gt;&lt;pre class=&quot;language-bash&quot;&gt;&lt;code class=&quot;language-bash&quot;&gt;kubectl apply -f https://raw.githubusercontent.com/kubernetes/ingress-nginx/controller-v1.6.4/deploy/static/provider/baremetal/deploy.yaml&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;ul&gt;
&lt;li&gt;yaml 파일의 브랜치도 controller-v1.6.4로 설정돼있으니 설치되는 것들도 동일하다 판단했으나, 실제로 구동된 이미지의 버전이 달랐다.&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&quot;원인&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#%EC%9B%90%EC%9D%B8&quot; aria-label=&quot;원인 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;원인&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;ingress-nginx 리포지토리가 v1.6.3 → v1.6.4로 업데이트될 때, controller 부분에 변경사항이 있었다. (&lt;a href=&quot;https://github.com/kubernetes/ingress-nginx/pull/9626/files#diff-5f4da05f4716a8d567db533819486a784e3f4993c11021da3b569564c78a5935L868&quot;&gt;이슈 #9626&lt;/a&gt;)&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;1.6.4에선 다음 코드가 삭제됐다. (L868)&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;go&quot;&gt;&lt;pre class=&quot;language-go&quot;&gt;&lt;code class=&quot;language-go&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;!&lt;/span&gt;ingressutils&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;IsSafePath&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;copyIng&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; path&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;Path&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
    klog&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;Warningf&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&quot;ingress %s contains invalid path %s&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; key&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; path&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;Path&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;return&lt;/span&gt;
&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;/li&gt;
&lt;li&gt;ingress path를 검증하고 warning을 내뱉는 코드로, 위에서 발생했던 로그와 일치한다.&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;해당 검증 코드가 문제를 일으켰는지 1.6.4에서 검증이 제거됐고, v1.6.4를 설치한 기존 클러스터는 잘 동작한 것.&lt;/li&gt;
&lt;li&gt;다만 무슨 이유에서인지 deploy.yaml 파일에 이미지들의 버전이 1.6.3으로 변경됐고, 오류가 있는 검증 코드가 동작하게 된 것이다.&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;span
      class=&quot;gatsby-resp-image-wrapper&quot;
      style=&quot;position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 1168px; &quot;
    &gt;
      &lt;span
    class=&quot;gatsby-resp-image-background-image&quot;
    style=&quot;padding-bottom: 12%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAACCAYAAABYBvyLAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAgElEQVQI1x2NQQ6DIBREvf+huuoJml6gaYyKIF/gA0baJ+1iMslMZt4Qk2JWi6pyno3WPl2NXA/es+c1bRivWFHWn+8Zs0VW59lTxucDt0ckKM4Hhlwqtpdyv1Gmkdq+lJ6VWgkhkDrIeMviHMYJi5X/MPUjkYh9PpjHqQMTdgtcZECYWGroHqgAAAAASUVORK5CYII=&apos;); background-size: cover; display: block;&quot;
  &gt;&lt;/span&gt;
  &lt;img
        class=&quot;gatsby-resp-image-image&quot;
        alt=&quot;20240218-3.png&quot;
        title=&quot;20240218-3.png&quot;
        src=&quot;/static/9ae38dded346d9270ca37159c9651b16/8cdda/20240218-3.png&quot;
        srcset=&quot;/static/9ae38dded346d9270ca37159c9651b16/5a46d/20240218-3.png 300w,
/static/9ae38dded346d9270ca37159c9651b16/0a47e/20240218-3.png 600w,
/static/9ae38dded346d9270ca37159c9651b16/8cdda/20240218-3.png 1168w&quot;
        sizes=&quot;(max-width: 1168px) 100vw, 1168px&quot;
        style=&quot;width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;&quot;
        loading=&quot;lazy&quot;
      /&gt;
    &lt;/span&gt;    &lt;/p&gt;
&lt;h2 id=&quot;해결-방법&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#%ED%95%B4%EA%B2%B0-%EB%B0%A9%EB%B2%95&quot; aria-label=&quot;해결 방법 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;해결 방법&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;딱히 ingress-nginx-controller 버전에 민감한 클러스터나 프로젝트가 아니었기 때문에, 바로 윗 버전인 v1.7.0으로 업데이트했다.&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;strong&gt;느낀 점&lt;/strong&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;웹에 있는 yaml 파일은 static 하지 않다.. 같은 파일인 듯 해도 언제든지 바뀔 수 있었다.&lt;/li&gt;
&lt;/ul&gt;</content:encoded></item><item><title><![CDATA[Spring Batch 5.0에서 배치용 메타데이터 DB와 서비스 DB 분리하기]]></title><description><![CDATA[스프링 배치 메타데이터 스프링 배치에서는 과 의 실행 상태, 파라미터, 컨텍스트 등을 관리하기 위해 메타데이터 테이블을 필요로 한다. 1 메타데이터 엔티티들은 , , ,  등이 있고, 이들을 관리하는 테이블들은 총 6개로 다음과 같다.  : Job…]]></description><link>https://blog.frec.kr/spring/spring-batch-5-metadata-db/</link><guid isPermaLink="false">https://blog.frec.kr/spring/spring-batch-5-metadata-db/</guid><pubDate>Fri, 26 May 2023 16:54:00 GMT</pubDate><content:encoded>&lt;h2 id=&quot;스프링-배치-메타데이터&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#%EC%8A%A4%ED%94%84%EB%A7%81-%EB%B0%B0%EC%B9%98-%EB%A9%94%ED%83%80%EB%8D%B0%EC%9D%B4%ED%84%B0&quot; aria-label=&quot;스프링 배치 메타데이터 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;스프링 배치 메타데이터&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;스프링 배치에서는 &lt;code class=&quot;language-text&quot;&gt;Job&lt;/code&gt;과 &lt;code class=&quot;language-text&quot;&gt;Step&lt;/code&gt;의 실행 상태, 파라미터, 컨텍스트 등을 관리하기 위해 메타데이터 테이블을 필요로 한다. [1]&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;메타데이터 엔티티들은 &lt;code class=&quot;language-text&quot;&gt;JobInstance&lt;/code&gt;, &lt;code class=&quot;language-text&quot;&gt;JobExecution&lt;/code&gt;, &lt;code class=&quot;language-text&quot;&gt;JobParameters&lt;/code&gt;, &lt;code class=&quot;language-text&quot;&gt;StepExecution&lt;/code&gt; 등이 있고, 이들을 관리하는 테이블들은 총 6개로 다음과 같다.&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;code class=&quot;language-text&quot;&gt;BATCH_JOB_INSTANCE&lt;/code&gt; : Job이 실행될 때마다 생성된 JobInstance&lt;/li&gt;
&lt;li&gt;&lt;code class=&quot;language-text&quot;&gt;BATCH_JOB_EXECUTION&lt;/code&gt; : JobInstance의 시작/종료 시간, 상태, 종료 메세지 등 정보&lt;/li&gt;
&lt;li&gt;&lt;code class=&quot;language-text&quot;&gt;BATCH_JOB_EXECUTION_PARAMS&lt;/code&gt; : JobExecution에 전달되는 JobParameters&lt;/li&gt;
&lt;li&gt;&lt;code class=&quot;language-text&quot;&gt;BATCH_JOB_EXECUTION_CONTEXT&lt;/code&gt; : Job 범위에서 관리하는 컨텍스트가 serialize되어 기록됨.&lt;/li&gt;
&lt;li&gt;&lt;code class=&quot;language-text&quot;&gt;BATCH_STEP_EXECUTION&lt;/code&gt; : Job 하위 Step들의 시작/종료 시간, 상태, read/write/skip/commit 카운트 등 상세한 정보&lt;/li&gt;
&lt;li&gt;&lt;code class=&quot;language-text&quot;&gt;BATCH_STEP_EXECUTION_CONTEXT&lt;/code&gt; : Step 범위에서 관리하는 컨텍스트가 serialize되어 기록됨.&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;span
      class=&quot;gatsby-resp-image-wrapper&quot;
      style=&quot;position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 831px; &quot;
    &gt;
      &lt;span
    class=&quot;gatsby-resp-image-background-image&quot;
    style=&quot;padding-bottom: 81.66666666666667%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAQCAIAAACZeshMAAAACXBIWXMAAAsTAAALEwEAmpwYAAACT0lEQVQoz4VTaW/TQBD1//8nQCUEAtSWAoW2aRNKnMTnem3vrm8nduw2vq8wcaV+IRGr0Wr9PO/N7Mws96iyz3eLi6nw5XZ+ORW+88jwt/v9fhiG/f8W57g2UlWsIYRUy7Lqum6b2ouz38heGN5MoSINT+lwiNhzEfGS9igoIia8gp1g7YSbq8mfn7PFr9lCNp3+BJt7PeV58XpOn59sRpipr3136Luu74+Td0X14WZ+9m0K9uZyciuYgLrBeilrc1HhRUXG5gu57wdI4bC/2DBwVdMYlKqqZphkvYnKqoJSVe2Q1V38lD3lVQYfp+5cN43jupQQ0zSDMKzrBtA5Ym+/Ppxd3b+7nJxPxabrg3h3tzKmkjlZ4fsVvlthFm65pm1t1yXjatt27NAQRxvDMEDQ87w8z0DO8jfX0wWU8HrKAxG7UZjsRrLjMEoxxlEU9X3fdt0mjimlkAs0DxS7rnvOdq5jhb7r2Ax6CXIAck3TABmcNE1br9cAlWUJZMYYyMVxDH5VVW2ThFkWKPpB8HJhCHOIzGybjUvX9TRN4UeSJhajkA5knqYJINs0hTECB9uymrouirwsiwPZsm168KQmIclIZo63FJWFIPOCJCEMmYdxImpEwnQ0slQMywsOZD/wGSWUmI5td2PN8rKGJgVREj/nyS7vTw1JUZYy0peSuoBQokIth/jxxxv+/EF4/+P3p1v+YibNkH2cDNOTZmWaV2BJVu6KepsmkqoqKkJYVzW8y4uqaY8+Mu5faBNvVzISZBV2WdNVneiEHY38F+2HdOuc9sscAAAAAElFTkSuQmCC&apos;); background-size: cover; display: block;&quot;
  &gt;&lt;/span&gt;
  &lt;img
        class=&quot;gatsby-resp-image-image&quot;
        alt=&quot;20230526 1&quot;
        title=&quot;20230526 1&quot;
        src=&quot;/static/51ef1ae3594608675717babc0d7d96ad/5b4a1/20230526-1.png&quot;
        srcset=&quot;/static/51ef1ae3594608675717babc0d7d96ad/5a46d/20230526-1.png 300w,
/static/51ef1ae3594608675717babc0d7d96ad/0a47e/20230526-1.png 600w,
/static/51ef1ae3594608675717babc0d7d96ad/5b4a1/20230526-1.png 831w&quot;
        sizes=&quot;(max-width: 831px) 100vw, 831px&quot;
        style=&quot;width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;&quot;
        loading=&quot;lazy&quot;
      /&gt;
    &lt;/span&gt;&lt;/p&gt;
&lt;p&gt;(이미지 출처 : &lt;a href=&quot;https://docs.spring.io/spring-batch/docs/current/reference/html/schema-appendix.html&quot;&gt;https://docs.spring.io/spring-batch/docs/current/reference/html/schema-appendix.html&lt;/a&gt;)&lt;/p&gt;
&lt;br&gt;
&lt;p&gt;&lt;strong&gt;문제 상황&lt;/strong&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;배치 Job에서 사용하는 서비스 DB에 배치 메타데이터 테이블이 위치하는 것이 바람직하지 않을 수 있다.&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;혹은 비주류 DB에 메타데이터를 저장하려 할 경우, 스프링 배치에서 지원하지 않을 수 있다. [2] (ex. Tibero)&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;지원하는 DB: DB2, Derby, H2, HANA, HSQL, MariaDB, MySQL, Postgres, Sqlite, SqlServer, Sybase&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id=&quot;메타데이터-db-분리하기-spring-batch-50-이전&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#%EB%A9%94%ED%83%80%EB%8D%B0%EC%9D%B4%ED%84%B0-db-%EB%B6%84%EB%A6%AC%ED%95%98%EA%B8%B0-spring-batch-50-%EC%9D%B4%EC%A0%84&quot; aria-label=&quot;메타데이터 db 분리하기 spring batch 50 이전 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;메타데이터 DB 분리하기 (Spring Batch 5.0 이전)&lt;/h2&gt;
&lt;p&gt;웹에서 찾아보면 주로 다음 솔루션이 보인다.&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;&lt;code class=&quot;language-text&quot;&gt;DefaultBatchConfigurer&lt;/code&gt;를 구현하고 DataSource를 설정하는 부분을 비워두는 방법&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;ex) &lt;a href=&quot;https://stackoverflow.com/a/42677607&quot;&gt;https://stackoverflow.com/a/42677607&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;DataSource가 설정되지 않을 때, 스프링 배치는 &lt;code class=&quot;language-text&quot;&gt;MapJobRepositoryFactoryBean&lt;/code&gt;을 이용해 메타데이터를 &lt;strong&gt;Map 기반으로 인메모리 관리&lt;/strong&gt;한다.&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;이 경우 Thread-safe하지 않아 Job을 병렬로 구동할 경우 문제가 발생할 수 있으며,&lt;/li&gt;
&lt;li&gt;퍼포먼스 또한 형편없어서 deprecated 처리되었다. [3]&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;또한 Spring Batch 5.0에서는 DefaultBatchConfigurer가 제거되어 이 방법을 사용할 수 없는데,&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;대체로 생긴 DefaultBatchConfiguration은 DataSource 설정을 지원하지 않는다.&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id=&quot;spring-batch-50에서&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#spring-batch-50%EC%97%90%EC%84%9C&quot; aria-label=&quot;spring batch 50에서 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;Spring Batch 5.0에서&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;&lt;code class=&quot;language-text&quot;&gt;@EnableBatchProcessing&lt;/code&gt; 어노테이션은 5.0 버전에서 몇가지 변경점이 있다.&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;dataSourceRef 속성을 통해 DataSource 빈을 직접 지정해줄 수 있고,&lt;/li&gt;
&lt;li&gt;transactionManagerRef 속성을 통해 TransactionManager 빈을 직접 지정할 수 있다.&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Configuration에서 DataSource 빈을 두 개 등록해주고 서비스 데이터가 들어갈 데이터소스에 &lt;code class=&quot;language-text&quot;&gt;@Primary&lt;/code&gt; 어노테이션을 설정해두었다.&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;다음 BatchConfig.java 코드와 같이 batch 메타데이터가 저장될 데이터소스(batchDataSource)를 따로 생성하였다.&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;TransactionManager 빈을 등록할 때 사용할 데이터소스를 지정해주었으며,&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;최종적으로 JobConfig에서 &lt;code class=&quot;language-text&quot;&gt;@EnableBatchProcessing(dataSourceRef = &amp;quot;batchDataSource&amp;quot;, transactionManagerRef = &amp;quot;jpaTransactionManager&amp;quot;)&lt;/code&gt; 어노테이션을 통해 두 데이터소스를 분리 지정했다.&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;추가로, batchDataSource 빈을 &lt;code class=&quot;language-text&quot;&gt;EmbeddedDataSource&lt;/code&gt;로 구성하여 H2와 같은 인메모리 DB를 사용할 수 있다.&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;전체 코드는 다음과 같다.&lt;/p&gt;
&lt;p&gt;&lt;code class=&quot;language-text&quot;&gt;config/BatchConfig.java&lt;/code&gt;&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;java&quot;&gt;&lt;pre class=&quot;language-java&quot;&gt;&lt;code class=&quot;language-java&quot;&gt;&lt;span class=&quot;token annotation punctuation&quot;&gt;@Configuration&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;BatchConfig&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;

    &lt;span class=&quot;token annotation punctuation&quot;&gt;@Value&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&quot;${spring.datasource.url}&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;private&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;String&lt;/span&gt; url&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;

    &lt;span class=&quot;token annotation punctuation&quot;&gt;@Value&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&quot;${spring.datasource.username}&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;private&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;String&lt;/span&gt; username&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;

    &lt;span class=&quot;token annotation punctuation&quot;&gt;@Value&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&quot;${spring.datasource.password}&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;private&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;String&lt;/span&gt; password&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;

    &lt;span class=&quot;token annotation punctuation&quot;&gt;@Value&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&quot;${spring.datasource.driver-class-name}&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;private&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;String&lt;/span&gt; driverClassName&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;

    &lt;span class=&quot;token annotation punctuation&quot;&gt;@Value&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&quot;${spring.datasource-batch.url}&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;private&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;String&lt;/span&gt; batchUrl&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;

    &lt;span class=&quot;token annotation punctuation&quot;&gt;@Value&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&quot;${spring.datasource-batch.username}&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;private&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;String&lt;/span&gt; batchUsername&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;

    &lt;span class=&quot;token annotation punctuation&quot;&gt;@Value&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&quot;${spring.datasource-batch.password}&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;private&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;String&lt;/span&gt; batchPassword&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;

    &lt;span class=&quot;token annotation punctuation&quot;&gt;@Value&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&quot;${spring.datasource-batch.driver-class-name}&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;private&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;String&lt;/span&gt; batchDriverClassName&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;

    &lt;span class=&quot;token annotation punctuation&quot;&gt;@Bean&lt;/span&gt;
    &lt;span class=&quot;token annotation punctuation&quot;&gt;@Primary&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;DataSource&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;dataSource&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;token keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;DataSourceBuilder&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;create&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
                &lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;url&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;url&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
                &lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;username&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;username&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
                &lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;password&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;password&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
                &lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;driverClassName&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;driverClassName&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
                &lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;build&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;

    &lt;span class=&quot;token annotation punctuation&quot;&gt;@Bean&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;DataSource&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;batchDataSource&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;token keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;DataSourceBuilder&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;create&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
                &lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;url&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;batchUrl&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
                &lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;username&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;batchUsername&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
                &lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;password&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;batchPassword&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
                &lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;driverClassName&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;batchDriverClassName&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
                &lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;build&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;

    &lt;span class=&quot;token annotation punctuation&quot;&gt;@Bean&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;PlatformTransactionManager&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;jpaTransactionManager&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token class-name&quot;&gt;EntityManagerFactory&lt;/span&gt; entityManagerFactory&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;token class-name&quot;&gt;JpaTransactionManager&lt;/span&gt; jpaTransactionManager &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;JpaTransactionManager&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;entityManagerFactory&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
        jpaTransactionManager&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;setDataSource&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;dataSource&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
        &lt;span class=&quot;token keyword&quot;&gt;return&lt;/span&gt; jpaTransactionManager&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;
&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;&lt;code class=&quot;language-text&quot;&gt;JobConfig&lt;/code&gt;&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;java&quot;&gt;&lt;pre class=&quot;language-java&quot;&gt;&lt;code class=&quot;language-java&quot;&gt;&lt;span class=&quot;token annotation punctuation&quot;&gt;@Configuration&lt;/span&gt;
&lt;span class=&quot;token annotation punctuation&quot;&gt;@RequiredArgsConstructor&lt;/span&gt;
&lt;span class=&quot;token annotation punctuation&quot;&gt;@EnableBatchProcessing&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;dataSourceRef &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;batchDataSource&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; transactionManagerRef &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;jpaTransactionManager&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;DailyAggregationJobConfig&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;

    &lt;span class=&quot;token keyword&quot;&gt;private&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;final&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;static&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;String&lt;/span&gt; jobName &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;dailyAggregationJob&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;

    &lt;span class=&quot;token keyword&quot;&gt;private&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;final&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;JobRepository&lt;/span&gt; jobRepository&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;private&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;final&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;PlatformTransactionManager&lt;/span&gt; jpaTransactionManager&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;private&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;final&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;EntityManagerFactory&lt;/span&gt; entityManagerFactory&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;

    &lt;span class=&quot;token annotation punctuation&quot;&gt;@Bean&lt;/span&gt;
    &lt;span class=&quot;token annotation punctuation&quot;&gt;@Qualifier&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;jobName&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;Job&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;dailyAggregationJob&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;token keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;JobBuilder&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;jobName&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; jobRepository&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
                &lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;start&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;dailyAggregationStep1&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
                &lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;build&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;

    &lt;span class=&quot;token annotation punctuation&quot;&gt;@Bean&lt;/span&gt;
		&lt;span class=&quot;token annotation punctuation&quot;&gt;@JobScope&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;Step&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;dailyAggregationStep1&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;token keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;StepBuilder&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;jobName &lt;span class=&quot;token operator&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;Step1&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; jobRepository&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
                &lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token generics&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;token class-name&quot;&gt;DailyAggregationVo&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;DailyAggregatedData&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;chunk&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;1000&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; jpaTransactionManager&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
                &lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;reader&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;dailyAggregationItemReader&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
                &lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;processor&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;dailyAggregationItemProcessor&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
                &lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;writer&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;dailyAggregationItemWriter&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
                &lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;build&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;

    &lt;span class=&quot;token annotation punctuation&quot;&gt;@Bean&lt;/span&gt;
		&lt;span class=&quot;token annotation punctuation&quot;&gt;@StepScope&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;DailyAggregationItemReader&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;dailyAggregationItemReader&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;token keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;DailyAggregationItemReader&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;entityManagerFactory&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;

    &lt;span class=&quot;token annotation punctuation&quot;&gt;@Bean&lt;/span&gt;
		&lt;span class=&quot;token annotation punctuation&quot;&gt;@StepScope&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;DailyAggregationItemReader&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;dailyAggregationItemProcessor&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;token keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;DailyAggregationItemReader&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;

    &lt;span class=&quot;token annotation punctuation&quot;&gt;@Bean&lt;/span&gt;
		&lt;span class=&quot;token annotation punctuation&quot;&gt;@StepScope&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;DailyAggregationItemReader&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;dailyAggregationItemWriter&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;token keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;DailyAggregationItemReader&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;entityManagerFactory&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;
&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;&lt;code class=&quot;language-text&quot;&gt;resources/application.yaml&lt;/code&gt;&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;java&quot;&gt;&lt;pre class=&quot;language-java&quot;&gt;&lt;code class=&quot;language-java&quot;&gt;spring&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt;
	&lt;span class=&quot;token comment&quot;&gt;// ...&lt;/span&gt;
  datasource&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt;
    driver&lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;token keyword&quot;&gt;class&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt;name&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;&lt;span class=&quot;token namespace&quot;&gt;org&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;mariadb&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;jdbc&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;/span&gt;Driver&lt;/span&gt;
    url&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; jdbc&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt;mariadb&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;/&lt;/span&gt;localhost&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;20000&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;/&lt;/span&gt;playground&lt;span class=&quot;token operator&quot;&gt;?&lt;/span&gt;characterEncoding&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;UTF&lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;8&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;&amp;amp;&lt;/span&gt;serverTimezone&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token class-name&quot;&gt;Asia&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;token class-name&quot;&gt;Seoul&lt;/span&gt;
    username&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; username
    password&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; password
  datasource&lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt;batch&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt;
    driver&lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;token keyword&quot;&gt;class&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt;name&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;&lt;span class=&quot;token namespace&quot;&gt;org&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;mariadb&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;jdbc&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;/span&gt;Driver&lt;/span&gt;
    url&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; jdbc&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt;mariadb&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;/&lt;/span&gt;localhost&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;20001&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;/&lt;/span&gt;batch_metadata&lt;span class=&quot;token operator&quot;&gt;?&lt;/span&gt;characterEncoding&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;UTF&lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;8&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;&amp;amp;&lt;/span&gt;serverTimezone&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token class-name&quot;&gt;Asia&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;token class-name&quot;&gt;Seoul&lt;/span&gt;
    username&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; username
    password&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; password
	&lt;span class=&quot;token comment&quot;&gt;// ...&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;h2 id=&quot;references&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#references&quot; aria-label=&quot;references permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;References&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;[1] &lt;a href=&quot;https://docs.spring.io/spring-batch/docs/current/reference/html/schema-appendix.html&quot;&gt;https://docs.spring.io/spring-batch/docs/current/reference/html/schema-appendix.html&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;[2] org.springframework.batch.support.DatabaseType (&lt;a href=&quot;https://docs.spring.io/spring-batch/docs/current/api/org/springframework/batch/support/DatabaseType.html&quot;&gt;https://docs.spring.io/spring-batch/docs/current/api/org/springframework/batch/support/DatabaseType.html&lt;/a&gt;)&lt;/li&gt;
&lt;li&gt;[3] &lt;a href=&quot;https://github.com/spring-projects/spring-batch/issues/3780&quot;&gt;https://github.com/spring-projects/spring-batch/issues/3780&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;</content:encoded></item><item><title><![CDATA[파이썬 SharedMemory 사용 시 자동으로 unlink가 호출되는 문제]]></title><description><![CDATA[문제점 Python 3.8에서 추가된  모듈의 를 사용하는 경우, SharedMemory를 사용하던 프로세스가 종료되었을 때, 연결된 공유 메모리 블록까지 릴리즈되어 다른 프로세스에서 사용이 불가능한 문제 발생한다. SharedMemory…]]></description><link>https://blog.frec.kr/troubleshooting/py_shm_unlink/</link><guid isPermaLink="false">https://blog.frec.kr/troubleshooting/py_shm_unlink/</guid><pubDate>Fri, 28 Oct 2022 18:42:00 GMT</pubDate><content:encoded>&lt;h2 id=&quot;문제점&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#%EB%AC%B8%EC%A0%9C%EC%A0%90&quot; aria-label=&quot;문제점 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;문제점&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;Python 3.8에서 추가된 &lt;code class=&quot;language-text&quot;&gt;multiprocessing.shared_memory&lt;/code&gt; 모듈의 &lt;code class=&quot;language-text&quot;&gt;SharedMemory&lt;/code&gt;를 사용하는 경우,&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;SharedMemory를 사용하던 프로세스가 종료되었을 때, 연결된 공유 메모리 블록까지 릴리즈되어 다른 프로세스에서 사용이 불가능한 문제 발생한다.&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;SharedMemory 세그먼트를 프로세스의 종료와 관계 없이 유지하는 시나리오도 존재할 수 있지만, 파이썬에서는 &lt;strong&gt;memory leak로 판단하고 강제로 릴리즈함&lt;/strong&gt;으로써 발생한다.&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;Python 3.8 ~ 3.11에서 발생한다.&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&quot;문제-재현-시나리오&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#%EB%AC%B8%EC%A0%9C-%EC%9E%AC%ED%98%84-%EC%8B%9C%EB%82%98%EB%A6%AC%EC%98%A4&quot; aria-label=&quot;문제 재현 시나리오 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;문제 재현 시나리오&lt;/h3&gt;
&lt;p&gt;(파이썬 프로세스 &lt;span class=&quot;katex&quot;&gt;&lt;span class=&quot;katex-mathml&quot;&gt;&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;semantics&gt;&lt;mrow&gt;&lt;msub&gt;&lt;mi&gt;P&lt;/mi&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;annotation encoding=&quot;application/x-tex&quot;&gt;P_1&lt;/annotation&gt;&lt;/semantics&gt;&lt;/math&gt;&lt;/span&gt;&lt;span class=&quot;katex-html&quot; aria-hidden=&quot;true&quot;&gt;&lt;span class=&quot;base&quot;&gt;&lt;span class=&quot;strut&quot; style=&quot;height:0.83333em;vertical-align:-0.15em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;mord&quot;&gt;&lt;span class=&quot;mord mathdefault&quot; style=&quot;margin-right:0.13889em;&quot;&gt;P&lt;/span&gt;&lt;span class=&quot;msupsub&quot;&gt;&lt;span class=&quot;vlist-t vlist-t2&quot;&gt;&lt;span class=&quot;vlist-r&quot;&gt;&lt;span class=&quot;vlist&quot; style=&quot;height:0.30110799999999993em;&quot;&gt;&lt;span style=&quot;top:-2.5500000000000003em;margin-left:-0.13889em;margin-right:0.05em;&quot;&gt;&lt;span class=&quot;pstrut&quot; style=&quot;height:2.7em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;sizing reset-size6 size3 mtight&quot;&gt;&lt;span class=&quot;mord mtight&quot;&gt;1&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;vlist-s&quot;&gt;​&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;vlist-r&quot;&gt;&lt;span class=&quot;vlist&quot; style=&quot;height:0.15em;&quot;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;, &lt;span class=&quot;katex&quot;&gt;&lt;span class=&quot;katex-mathml&quot;&gt;&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;semantics&gt;&lt;mrow&gt;&lt;msub&gt;&lt;mi&gt;P&lt;/mi&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;annotation encoding=&quot;application/x-tex&quot;&gt;P_2&lt;/annotation&gt;&lt;/semantics&gt;&lt;/math&gt;&lt;/span&gt;&lt;span class=&quot;katex-html&quot; aria-hidden=&quot;true&quot;&gt;&lt;span class=&quot;base&quot;&gt;&lt;span class=&quot;strut&quot; style=&quot;height:0.83333em;vertical-align:-0.15em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;mord&quot;&gt;&lt;span class=&quot;mord mathdefault&quot; style=&quot;margin-right:0.13889em;&quot;&gt;P&lt;/span&gt;&lt;span class=&quot;msupsub&quot;&gt;&lt;span class=&quot;vlist-t vlist-t2&quot;&gt;&lt;span class=&quot;vlist-r&quot;&gt;&lt;span class=&quot;vlist&quot; style=&quot;height:0.30110799999999993em;&quot;&gt;&lt;span style=&quot;top:-2.5500000000000003em;margin-left:-0.13889em;margin-right:0.05em;&quot;&gt;&lt;span class=&quot;pstrut&quot; style=&quot;height:2.7em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;sizing reset-size6 size3 mtight&quot;&gt;&lt;span class=&quot;mord mtight&quot;&gt;2&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;vlist-s&quot;&gt;​&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;vlist-r&quot;&gt;&lt;span class=&quot;vlist&quot; style=&quot;height:0.15em;&quot;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;, &lt;span class=&quot;katex&quot;&gt;&lt;span class=&quot;katex-mathml&quot;&gt;&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;semantics&gt;&lt;mrow&gt;&lt;msub&gt;&lt;mi&gt;P&lt;/mi&gt;&lt;mn&gt;3&lt;/mn&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;annotation encoding=&quot;application/x-tex&quot;&gt;P_3&lt;/annotation&gt;&lt;/semantics&gt;&lt;/math&gt;&lt;/span&gt;&lt;span class=&quot;katex-html&quot; aria-hidden=&quot;true&quot;&gt;&lt;span class=&quot;base&quot;&gt;&lt;span class=&quot;strut&quot; style=&quot;height:0.83333em;vertical-align:-0.15em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;mord&quot;&gt;&lt;span class=&quot;mord mathdefault&quot; style=&quot;margin-right:0.13889em;&quot;&gt;P&lt;/span&gt;&lt;span class=&quot;msupsub&quot;&gt;&lt;span class=&quot;vlist-t vlist-t2&quot;&gt;&lt;span class=&quot;vlist-r&quot;&gt;&lt;span class=&quot;vlist&quot; style=&quot;height:0.30110799999999993em;&quot;&gt;&lt;span style=&quot;top:-2.5500000000000003em;margin-left:-0.13889em;margin-right:0.05em;&quot;&gt;&lt;span class=&quot;pstrut&quot; style=&quot;height:2.7em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;sizing reset-size6 size3 mtight&quot;&gt;&lt;span class=&quot;mord mtight&quot;&gt;3&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;vlist-s&quot;&gt;​&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;vlist-r&quot;&gt;&lt;span class=&quot;vlist&quot; style=&quot;height:0.15em;&quot;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;가 같은 공유 메모리 블록에 접근하려는 상황)&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;&lt;span class=&quot;katex&quot;&gt;&lt;span class=&quot;katex-mathml&quot;&gt;&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;semantics&gt;&lt;mrow&gt;&lt;msub&gt;&lt;mi&gt;P&lt;/mi&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;annotation encoding=&quot;application/x-tex&quot;&gt;P_1&lt;/annotation&gt;&lt;/semantics&gt;&lt;/math&gt;&lt;/span&gt;&lt;span class=&quot;katex-html&quot; aria-hidden=&quot;true&quot;&gt;&lt;span class=&quot;base&quot;&gt;&lt;span class=&quot;strut&quot; style=&quot;height:0.83333em;vertical-align:-0.15em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;mord&quot;&gt;&lt;span class=&quot;mord mathdefault&quot; style=&quot;margin-right:0.13889em;&quot;&gt;P&lt;/span&gt;&lt;span class=&quot;msupsub&quot;&gt;&lt;span class=&quot;vlist-t vlist-t2&quot;&gt;&lt;span class=&quot;vlist-r&quot;&gt;&lt;span class=&quot;vlist&quot; style=&quot;height:0.30110799999999993em;&quot;&gt;&lt;span style=&quot;top:-2.5500000000000003em;margin-left:-0.13889em;margin-right:0.05em;&quot;&gt;&lt;span class=&quot;pstrut&quot; style=&quot;height:2.7em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;sizing reset-size6 size3 mtight&quot;&gt;&lt;span class=&quot;mord mtight&quot;&gt;1&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;vlist-s&quot;&gt;​&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;vlist-r&quot;&gt;&lt;span class=&quot;vlist&quot; style=&quot;height:0.15em;&quot;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;이 SharedMemory를 생성&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;span class=&quot;katex&quot;&gt;&lt;span class=&quot;katex-mathml&quot;&gt;&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;semantics&gt;&lt;mrow&gt;&lt;msub&gt;&lt;mi&gt;P&lt;/mi&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;annotation encoding=&quot;application/x-tex&quot;&gt;P_2&lt;/annotation&gt;&lt;/semantics&gt;&lt;/math&gt;&lt;/span&gt;&lt;span class=&quot;katex-html&quot; aria-hidden=&quot;true&quot;&gt;&lt;span class=&quot;base&quot;&gt;&lt;span class=&quot;strut&quot; style=&quot;height:0.83333em;vertical-align:-0.15em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;mord&quot;&gt;&lt;span class=&quot;mord mathdefault&quot; style=&quot;margin-right:0.13889em;&quot;&gt;P&lt;/span&gt;&lt;span class=&quot;msupsub&quot;&gt;&lt;span class=&quot;vlist-t vlist-t2&quot;&gt;&lt;span class=&quot;vlist-r&quot;&gt;&lt;span class=&quot;vlist&quot; style=&quot;height:0.30110799999999993em;&quot;&gt;&lt;span style=&quot;top:-2.5500000000000003em;margin-left:-0.13889em;margin-right:0.05em;&quot;&gt;&lt;span class=&quot;pstrut&quot; style=&quot;height:2.7em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;sizing reset-size6 size3 mtight&quot;&gt;&lt;span class=&quot;mord mtight&quot;&gt;2&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;vlist-s&quot;&gt;​&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;vlist-r&quot;&gt;&lt;span class=&quot;vlist&quot; style=&quot;height:0.15em;&quot;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;가 해당 공유 메모리 블록에 접근하고, 작업을 처리한 후 프로세스 종료&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;Warning 발생&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;python&quot;&gt;&lt;pre class=&quot;language-python&quot;&gt;&lt;code class=&quot;language-python&quot;&gt;UserWarning&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; resource_tracker&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; There appear to be &lt;span class=&quot;token number&quot;&gt;1&lt;/span&gt; leaked shared_memory objects to clean up at shutdown
  warnings&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;warn&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&apos;resource_tracker: There appear to be %d &apos;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;span class=&quot;katex&quot;&gt;&lt;span class=&quot;katex-mathml&quot;&gt;&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;semantics&gt;&lt;mrow&gt;&lt;msub&gt;&lt;mi&gt;P&lt;/mi&gt;&lt;mn&gt;3&lt;/mn&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;annotation encoding=&quot;application/x-tex&quot;&gt;P_3&lt;/annotation&gt;&lt;/semantics&gt;&lt;/math&gt;&lt;/span&gt;&lt;span class=&quot;katex-html&quot; aria-hidden=&quot;true&quot;&gt;&lt;span class=&quot;base&quot;&gt;&lt;span class=&quot;strut&quot; style=&quot;height:0.83333em;vertical-align:-0.15em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;mord&quot;&gt;&lt;span class=&quot;mord mathdefault&quot; style=&quot;margin-right:0.13889em;&quot;&gt;P&lt;/span&gt;&lt;span class=&quot;msupsub&quot;&gt;&lt;span class=&quot;vlist-t vlist-t2&quot;&gt;&lt;span class=&quot;vlist-r&quot;&gt;&lt;span class=&quot;vlist&quot; style=&quot;height:0.30110799999999993em;&quot;&gt;&lt;span style=&quot;top:-2.5500000000000003em;margin-left:-0.13889em;margin-right:0.05em;&quot;&gt;&lt;span class=&quot;pstrut&quot; style=&quot;height:2.7em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;sizing reset-size6 size3 mtight&quot;&gt;&lt;span class=&quot;mord mtight&quot;&gt;3&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;vlist-s&quot;&gt;​&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;vlist-r&quot;&gt;&lt;span class=&quot;vlist&quot; style=&quot;height:0.15em;&quot;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;가 해당 공유 메모리 블록에 접근 시도&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;에러 발생&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;python&quot;&gt;&lt;pre class=&quot;language-python&quot;&gt;&lt;code class=&quot;language-python&quot;&gt;FileNotFoundError&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;Errno &lt;span class=&quot;token number&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt; No such &lt;span class=&quot;token builtin&quot;&gt;file&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;or&lt;/span&gt; directory&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&apos;/test&apos;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;python&quot;&gt;&lt;pre class=&quot;language-python&quot;&gt;&lt;code class=&quot;language-python&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;from&lt;/span&gt; multiprocessing&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;shared_memory &lt;span class=&quot;token keyword&quot;&gt;import&lt;/span&gt; SharedMemory

&lt;span class=&quot;token comment&quot;&gt;### Process 1&lt;/span&gt;
shm &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; SharedMemory&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;name&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&apos;test&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; create&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token boolean&quot;&gt;True&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; size&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;4096&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;token comment&quot;&gt;# 대기&lt;/span&gt;

&lt;span class=&quot;token comment&quot;&gt;### Process 2&lt;/span&gt;
shm &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; SharedMemory&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;name&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&apos;test&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; create&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token boolean&quot;&gt;False&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;token comment&quot;&gt;# ...&lt;/span&gt;
exit&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;token comment&quot;&gt;# Warning 발생&lt;/span&gt;

&lt;span class=&quot;token comment&quot;&gt;### Process 3&lt;/span&gt;
shm &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; SharedMemory&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;name&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&apos;test&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; create&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token boolean&quot;&gt;False&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;token comment&quot;&gt;# 에러 발생&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;h3 id=&quot;문제-원인&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#%EB%AC%B8%EC%A0%9C-%EC%9B%90%EC%9D%B8&quot; aria-label=&quot;문제 원인 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;문제 원인&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;&lt;code class=&quot;language-text&quot;&gt;multiprocessing&lt;/code&gt; 라이브러리에는 &lt;code class=&quot;language-text&quot;&gt;ResourceTracker&lt;/code&gt;가 존재하며, SharedMemory 오브젝트 생성 시 해당 오브젝트는 &lt;strong&gt;ResourceTracker의 감시 대상에 등록&lt;/strong&gt;된다. (create=True인 경우나 False인 경우 모두 포함) [1]&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;python&quot;&gt;&lt;pre class=&quot;language-python&quot;&gt;&lt;code class=&quot;language-python&quot;&gt;&lt;span class=&quot;token comment&quot;&gt;### Lib/multiprocessing/shared_memory.py&lt;/span&gt;

&lt;span class=&quot;token keyword&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;SharedMemory&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
	&lt;span class=&quot;token comment&quot;&gt;# ...&lt;/span&gt;

	&lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;__init__&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;self&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; name&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token boolean&quot;&gt;None&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; create&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token boolean&quot;&gt;False&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; size&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
		  &lt;span class=&quot;token comment&quot;&gt;# ...&lt;/span&gt;
		
		  &lt;span class=&quot;token keyword&quot;&gt;if&lt;/span&gt; _USE_POSIX&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
		
		      &lt;span class=&quot;token comment&quot;&gt;# POSIX Shared Memory&lt;/span&gt;
		
		      &lt;span class=&quot;token keyword&quot;&gt;if&lt;/span&gt; name &lt;span class=&quot;token keyword&quot;&gt;is&lt;/span&gt; &lt;span class=&quot;token boolean&quot;&gt;None&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
		          &lt;span class=&quot;token keyword&quot;&gt;while&lt;/span&gt; &lt;span class=&quot;token boolean&quot;&gt;True&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
		              name &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; _make_filename&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
		              &lt;span class=&quot;token keyword&quot;&gt;try&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
		                  self&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;_fd &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; _posixshmem&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;shm_open&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;
		                      name&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
		                      self&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;_flags&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
		                      mode&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;self&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;_mode
		                  &lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
		              &lt;span class=&quot;token keyword&quot;&gt;except&lt;/span&gt; FileExistsError&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
		                  &lt;span class=&quot;token keyword&quot;&gt;continue&lt;/span&gt;
		              self&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;_name &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; name
		              &lt;span class=&quot;token keyword&quot;&gt;break&lt;/span&gt;
		      &lt;span class=&quot;token keyword&quot;&gt;else&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
		          name &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;/&quot;&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;+&lt;/span&gt; name &lt;span class=&quot;token keyword&quot;&gt;if&lt;/span&gt; self&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;_prepend_leading_slash &lt;span class=&quot;token keyword&quot;&gt;else&lt;/span&gt; name
		          self&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;_fd &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; _posixshmem&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;shm_open&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;
		              name&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
		              self&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;_flags&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
		              mode&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;self&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;_mode
		          &lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
		          self&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;_name &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; name
		      &lt;span class=&quot;token keyword&quot;&gt;try&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
		          &lt;span class=&quot;token keyword&quot;&gt;if&lt;/span&gt; create &lt;span class=&quot;token keyword&quot;&gt;and&lt;/span&gt; size&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
		              os&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;ftruncate&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;self&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;_fd&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; size&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
		          stats &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; os&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;fstat&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;self&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;_fd&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
		          size &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; stats&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;st_size
		          self&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;_mmap &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; mmap&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;mmap&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;self&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;_fd&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; size&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
		      &lt;span class=&quot;token keyword&quot;&gt;except&lt;/span&gt; OSError&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
		          self&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;unlink&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
		          &lt;span class=&quot;token keyword&quot;&gt;raise&lt;/span&gt;
		
		      resource_tracker&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;register&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;self&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;_name&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;shared_memory&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;ResourceTracker는 파이썬 프로세스 종료 시 unlink 되지 않은 SharedMemory 오브젝트가 있다면 &lt;strong&gt;경고를 날리며 unlink를 호출&lt;/strong&gt;한다. [2] (leak으로 간주)&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;python&quot;&gt;&lt;pre class=&quot;language-python&quot;&gt;&lt;code class=&quot;language-python&quot;&gt;&lt;span class=&quot;token comment&quot;&gt;### Lib/multiprocessing/resource_tracker.py&lt;/span&gt;

&lt;span class=&quot;token comment&quot;&gt;# Line 49-51&lt;/span&gt;
_CLEANUP_FUNCS&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;update&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;token string&quot;&gt;&apos;shared_memory&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; _posixshmem&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;shm_unlink&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;token comment&quot;&gt;# Line 229-239&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;for&lt;/span&gt; name &lt;span class=&quot;token keyword&quot;&gt;in&lt;/span&gt; rtype_cache&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
	  &lt;span class=&quot;token comment&quot;&gt;# For some reason the process which created and registered this&lt;/span&gt;
	  &lt;span class=&quot;token comment&quot;&gt;# resource has failed to unregister it. Presumably it has&lt;/span&gt;
	  &lt;span class=&quot;token comment&quot;&gt;# died.  We therefore unlink it.&lt;/span&gt;
	  &lt;span class=&quot;token keyword&quot;&gt;try&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
	      &lt;span class=&quot;token keyword&quot;&gt;try&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
	          _CLEANUP_FUNCS&lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;rtype&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;name&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
		      &lt;span class=&quot;token keyword&quot;&gt;except&lt;/span&gt; Exception &lt;span class=&quot;token keyword&quot;&gt;as&lt;/span&gt; e&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
	          warnings&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;warn&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&apos;resource_tracker: %r: %s&apos;&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;%&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;name&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; e&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
	  &lt;span class=&quot;token keyword&quot;&gt;finally&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
	      &lt;span class=&quot;token keyword&quot;&gt;pass&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id=&quot;해결-방법&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#%ED%95%B4%EA%B2%B0-%EB%B0%A9%EB%B2%95&quot; aria-label=&quot;해결 방법 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;해결 방법&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;ResourceTracker는 세마포어가 프로세스 종료에도 남아있는 상황을 피하기 위해 구현되었으나, SharedMemory에도 적용되어 잘못된 결과를 가져오는 버그가 되었다.&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;파이썬 이슈트래커에 이번 버그에 대해 논의가 있었고 솔루션도 제시되어 PR이 있지만, 2022.10.28기준 3.11 버전에서도 아직 머지되지 않았으며 방치된 상태이다.&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href=&quot;https://github.com/python/cpython/issues/82300&quot;&gt;Issue #82300(bpo-38119)&lt;/a&gt;, &lt;a href=&quot;https://github.com/python/cpython/issues/84140&quot;&gt;Issue #84180(bpo-39959)&lt;/a&gt;, &lt;a href=&quot;https://github.com/python/cpython/pull/15989/files&quot;&gt;PR #15989(bpo-38119)&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;이슈 #84180에서 shared_memory.py 파일을 수정에 로컬로 사용하는 임시 솔루션을 제시한다. (&lt;a href=&quot;https://github.com/python/cpython/issues/84140#issuecomment-1093865808&quot;&gt;해당 코멘트&lt;/a&gt;)&lt;/li&gt;
&lt;/ul&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;python&quot;&gt;&lt;pre class=&quot;language-python&quot;&gt;&lt;code class=&quot;language-python&quot;&gt;&lt;span class=&quot;token comment&quot;&gt;# Lib/multiprocessing/shared_memory.py&lt;/span&gt;

&lt;span class=&quot;token comment&quot;&gt;# Line 120&lt;/span&gt;
resource_tracker&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;register&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;self&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;_name&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;shared_memory&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;python&quot;&gt;&lt;pre class=&quot;language-python&quot;&gt;&lt;code class=&quot;language-python&quot;&gt;&lt;span class=&quot;token comment&quot;&gt;# Lib/multiprocessing/shared_memory.py&lt;/span&gt;

&lt;span class=&quot;token comment&quot;&gt;# Line 120&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;if&lt;/span&gt; create&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
		resource_tracker&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;register&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;self&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;_name&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;shared_memory&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;ul&gt;
&lt;li&gt;혹은 라인 120을 아예 주석처리해서 ResourceTracker가 관여하지 못하게 할 수도 있다.&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id=&quot;참고&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#%EC%B0%B8%EA%B3%A0&quot; aria-label=&quot;참고 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;참고&lt;/h2&gt;
&lt;p&gt;[1] &lt;a href=&quot;https://github.com/python/cpython/blob/3.10/Lib/multiprocessing/shared_memory.py#L120&quot;&gt;Lib/multiprocessing/shared_memory.py - Line 120&lt;/a&gt;
[2] &lt;a href=&quot;https://github.com/python/cpython/blob/3.10/Lib/multiprocessing/resource_tracker.py&quot;&gt;Lib/multiprocessing/resource_tracker.py&lt;/a&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href=&quot;https://stackoverflow.com/questions/62748654/python-3-8-shared-memory-resource-tracker-producing-unexpected-warnings-at-appli&quot;&gt;https://stackoverflow.com/questions/62748654/python-3-8-shared-memory-resource-tracker-producing-unexpected-warnings-at-appli&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://bugs.python.org/issue39959&quot;&gt;https://bugs.python.org/issue39959&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://bugs.python.org/issue38119&quot;&gt;https://bugs.python.org/issue38119&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://github.com/python/cpython/pull/15989/files&quot;&gt;https://github.com/python/cpython/pull/15989/files&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;</content:encoded></item><item><title><![CDATA[Go에서 해시 테이블(Map)은 어떻게 구현되어 있을까?]]></title><description><![CDATA[요약 Hash Table에서 해시 충돌(Hash Collision)에 대한 해결책으로 Open Addressing, Separate Chaining 등이 있다. Go에서는 Separate Chaining…]]></description><link>https://blog.frec.kr/golang/go-hashtable-0/</link><guid isPermaLink="false">https://blog.frec.kr/golang/go-hashtable-0/</guid><pubDate>Thu, 07 Apr 2022 02:00:00 GMT</pubDate><content:encoded>&lt;h2 id=&quot;요약&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#%EC%9A%94%EC%95%BD&quot; aria-label=&quot;요약 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;요약&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;Hash Table에서 해시 충돌(Hash Collision)에 대한 해결책으로 Open Addressing, Separate Chaining 등이 있다.&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Go에서는 &lt;strong&gt;Separate Chaining&lt;/strong&gt; 방법으로 구현되어 있는데, 이 방법은 링크드 리스트와 같이 버킷의 엔트리에 엔트리를 붙이는 방법이다.&lt;/li&gt;
&lt;li&gt;링크드 리스트나 트리의 구조로 chaining을 수행하는 다른 언어들과 달리 &lt;strong&gt;Go는 배열(Array)로 chaining을 수행&lt;/strong&gt;한다.&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;br&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;한 버킷에는 &lt;strong&gt;8개의 tophash 배열과 Key 배열, Value 배열&lt;/strong&gt;이 존재한다.&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;한 버킷에 &lt;strong&gt;8개의 슬롯(slot)이 존재&lt;/strong&gt;한다고 표현한다.&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;tophash 배열에 각 &lt;strong&gt;Key의 해시 값의 최상위 8비트를 저장&lt;/strong&gt;해둔다.&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;해시 충돌이 발생해 같은 버킷에 데이터를 저장할 경우, 그냥 비어있는 슬롯을 사용한다.&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;버킷은 메모리 상에 Key와 Value를 한 쌍으로 저장하지 않고, Key들을 먼저 할당하고 그 뒤에 Value들을 모아서 할당해둔다.&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;이는 &lt;strong&gt;메모리 정렬(memory alignment)의 효율&lt;/strong&gt;을 얻기 위함이다.&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;br&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;Go 해시 테이블의 &lt;strong&gt;Load Factor는 6.5&lt;/strong&gt;로 설정되어 있다.&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;버킷 당 평균 Key-Value 슬롯 사용이 6.5개 이상이면 해시 테이블 &lt;strong&gt;사이즈를 두 배로 늘리는 growing 과정을 수행&lt;/strong&gt;한다.&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;code class=&quot;language-text&quot;&gt;make(map[K]V, 100)&lt;/code&gt;과 같이 맵 생성 시 Key-Value의 개수에 대해 힌트를 주는 경우, 런타임은 다음 과정을 통해 버킷 개수를 설정한다.&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;span class=&quot;katex&quot;&gt;&lt;span class=&quot;katex-mathml&quot;&gt;&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;semantics&gt;&lt;mrow&gt;&lt;mi&gt;m&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;msub&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mi&gt;B&lt;/mi&gt;&lt;/msub&gt;&lt;mtext&gt; &lt;/mtext&gt;&lt;mtext&gt; &lt;/mtext&gt;&lt;mi&gt;L&lt;/mi&gt;&lt;mi&gt;o&lt;/mi&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mi&gt;d&lt;/mi&gt;&lt;mi&gt;F&lt;/mi&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mi&gt;c&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mi&gt;o&lt;/mi&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;mo&gt;∗&lt;/mo&gt;&lt;mi&gt;B&lt;/mi&gt;&lt;mo&gt;≥&lt;/mo&gt;&lt;mi&gt;h&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/mrow&gt;&lt;annotation encoding=&quot;application/x-tex&quot;&gt;min_B \,\,LoadFactor * B \ge hint&lt;/annotation&gt;&lt;/semantics&gt;&lt;/math&gt;&lt;/span&gt;&lt;span class=&quot;katex-html&quot; aria-hidden=&quot;true&quot;&gt;&lt;span class=&quot;base&quot;&gt;&lt;span class=&quot;strut&quot; style=&quot;height:0.84444em;vertical-align:-0.15em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;mord mathdefault&quot;&gt;m&lt;/span&gt;&lt;span class=&quot;mord mathdefault&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;mord&quot;&gt;&lt;span class=&quot;mord mathdefault&quot;&gt;n&lt;/span&gt;&lt;span class=&quot;msupsub&quot;&gt;&lt;span class=&quot;vlist-t vlist-t2&quot;&gt;&lt;span class=&quot;vlist-r&quot;&gt;&lt;span class=&quot;vlist&quot; style=&quot;height:0.32833099999999993em;&quot;&gt;&lt;span style=&quot;top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;&quot;&gt;&lt;span class=&quot;pstrut&quot; style=&quot;height:2.7em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;sizing reset-size6 size3 mtight&quot;&gt;&lt;span class=&quot;mord mathdefault mtight&quot; style=&quot;margin-right:0.05017em;&quot;&gt;B&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;vlist-s&quot;&gt;​&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;vlist-r&quot;&gt;&lt;span class=&quot;vlist&quot; style=&quot;height:0.15em;&quot;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;mspace&quot; style=&quot;margin-right:0.16666666666666666em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;mspace&quot; style=&quot;margin-right:0.16666666666666666em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;mord mathdefault&quot;&gt;L&lt;/span&gt;&lt;span class=&quot;mord mathdefault&quot;&gt;o&lt;/span&gt;&lt;span class=&quot;mord mathdefault&quot;&gt;a&lt;/span&gt;&lt;span class=&quot;mord mathdefault&quot;&gt;d&lt;/span&gt;&lt;span class=&quot;mord mathdefault&quot; style=&quot;margin-right:0.13889em;&quot;&gt;F&lt;/span&gt;&lt;span class=&quot;mord mathdefault&quot;&gt;a&lt;/span&gt;&lt;span class=&quot;mord mathdefault&quot;&gt;c&lt;/span&gt;&lt;span class=&quot;mord mathdefault&quot;&gt;t&lt;/span&gt;&lt;span class=&quot;mord mathdefault&quot;&gt;o&lt;/span&gt;&lt;span class=&quot;mord mathdefault&quot; style=&quot;margin-right:0.02778em;&quot;&gt;r&lt;/span&gt;&lt;span class=&quot;mspace&quot; style=&quot;margin-right:0.2222222222222222em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;mbin&quot;&gt;∗&lt;/span&gt;&lt;span class=&quot;mspace&quot; style=&quot;margin-right:0.2222222222222222em;&quot;&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;base&quot;&gt;&lt;span class=&quot;strut&quot; style=&quot;height:0.8193em;vertical-align:-0.13597em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;mord mathdefault&quot; style=&quot;margin-right:0.05017em;&quot;&gt;B&lt;/span&gt;&lt;span class=&quot;mspace&quot; style=&quot;margin-right:0.2777777777777778em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;mrel&quot;&gt;≥&lt;/span&gt;&lt;span class=&quot;mspace&quot; style=&quot;margin-right:0.2777777777777778em;&quot;&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;base&quot;&gt;&lt;span class=&quot;strut&quot; style=&quot;height:0.69444em;vertical-align:0em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;mord mathdefault&quot;&gt;h&lt;/span&gt;&lt;span class=&quot;mord mathdefault&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;mord mathdefault&quot;&gt;n&lt;/span&gt;&lt;span class=&quot;mord mathdefault&quot;&gt;t&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/li&gt;
&lt;li&gt;버킷 개수는 &lt;span class=&quot;katex&quot;&gt;&lt;span class=&quot;katex-mathml&quot;&gt;&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;semantics&gt;&lt;mrow&gt;&lt;msup&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;mi&gt;B&lt;/mi&gt;&lt;/msup&gt;&lt;/mrow&gt;&lt;annotation encoding=&quot;application/x-tex&quot;&gt;2^B&lt;/annotation&gt;&lt;/semantics&gt;&lt;/math&gt;&lt;/span&gt;&lt;span class=&quot;katex-html&quot; aria-hidden=&quot;true&quot;&gt;&lt;span class=&quot;base&quot;&gt;&lt;span class=&quot;strut&quot; style=&quot;height:0.8413309999999999em;vertical-align:0em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;mord&quot;&gt;&lt;span class=&quot;mord&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;msupsub&quot;&gt;&lt;span class=&quot;vlist-t&quot;&gt;&lt;span class=&quot;vlist-r&quot;&gt;&lt;span class=&quot;vlist&quot; style=&quot;height:0.8413309999999999em;&quot;&gt;&lt;span style=&quot;top:-3.063em;margin-right:0.05em;&quot;&gt;&lt;span class=&quot;pstrut&quot; style=&quot;height:2.7em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;sizing reset-size6 size3 mtight&quot;&gt;&lt;span class=&quot;mord mathdefault mtight&quot; style=&quot;margin-right:0.05017em;&quot;&gt;B&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;개&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;br&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;Key-Value 데이터에 접근하기 위해서 다음과 같이 포인터 연산을 하여 Value를 찾는다.&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;span class=&quot;katex&quot;&gt;&lt;span class=&quot;katex-mathml&quot;&gt;&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;semantics&gt;&lt;mrow&gt;&lt;mi&gt;v&lt;/mi&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mi&gt;l&lt;/mi&gt;&lt;mi&gt;u&lt;/mi&gt;&lt;msub&gt;&lt;mi&gt;e&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mrow&gt;&lt;mi&gt;d&lt;/mi&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mi&gt;O&lt;/mi&gt;&lt;mi&gt;f&lt;/mi&gt;&lt;mi&gt;f&lt;/mi&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mi&gt;e&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/mrow&gt;&lt;mtext&gt; &lt;/mtext&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mtext&gt; &lt;/mtext&gt;&lt;mn&gt;8&lt;/mn&gt;&lt;mo&gt;∗&lt;/mo&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;mi&gt;e&lt;/mi&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;mi&gt;S&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mi&gt;z&lt;/mi&gt;&lt;mi&gt;e&lt;/mi&gt;&lt;mtext&gt; &lt;/mtext&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mtext&gt; &lt;/mtext&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mo&gt;∗&lt;/mo&gt;&lt;mi&gt;e&lt;/mi&gt;&lt;mi&gt;l&lt;/mi&gt;&lt;mi&gt;e&lt;/mi&gt;&lt;mi&gt;m&lt;/mi&gt;&lt;mi&gt;S&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mi&gt;z&lt;/mi&gt;&lt;mi&gt;e&lt;/mi&gt;&lt;/mrow&gt;&lt;annotation encoding=&quot;application/x-tex&quot;&gt;value_i = {dataOffset}\, +\, 8 * keySize\, +\, i*elemSize&lt;/annotation&gt;&lt;/semantics&gt;&lt;/math&gt;&lt;/span&gt;&lt;span class=&quot;katex-html&quot; aria-hidden=&quot;true&quot;&gt;&lt;span class=&quot;base&quot;&gt;&lt;span class=&quot;strut&quot; style=&quot;height:0.84444em;vertical-align:-0.15em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;mord mathdefault&quot; style=&quot;margin-right:0.03588em;&quot;&gt;v&lt;/span&gt;&lt;span class=&quot;mord mathdefault&quot;&gt;a&lt;/span&gt;&lt;span class=&quot;mord mathdefault&quot; style=&quot;margin-right:0.01968em;&quot;&gt;l&lt;/span&gt;&lt;span class=&quot;mord mathdefault&quot;&gt;u&lt;/span&gt;&lt;span class=&quot;mord&quot;&gt;&lt;span class=&quot;mord mathdefault&quot;&gt;e&lt;/span&gt;&lt;span class=&quot;msupsub&quot;&gt;&lt;span class=&quot;vlist-t vlist-t2&quot;&gt;&lt;span class=&quot;vlist-r&quot;&gt;&lt;span class=&quot;vlist&quot; style=&quot;height:0.31166399999999994em;&quot;&gt;&lt;span style=&quot;top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;&quot;&gt;&lt;span class=&quot;pstrut&quot; style=&quot;height:2.7em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;sizing reset-size6 size3 mtight&quot;&gt;&lt;span class=&quot;mord mathdefault mtight&quot;&gt;i&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;vlist-s&quot;&gt;​&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;vlist-r&quot;&gt;&lt;span class=&quot;vlist&quot; style=&quot;height:0.15em;&quot;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;mspace&quot; style=&quot;margin-right:0.2777777777777778em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;mrel&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mspace&quot; style=&quot;margin-right:0.2777777777777778em;&quot;&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;base&quot;&gt;&lt;span class=&quot;strut&quot; style=&quot;height:0.8888799999999999em;vertical-align:-0.19444em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;mord&quot;&gt;&lt;span class=&quot;mord mathdefault&quot;&gt;d&lt;/span&gt;&lt;span class=&quot;mord mathdefault&quot;&gt;a&lt;/span&gt;&lt;span class=&quot;mord mathdefault&quot;&gt;t&lt;/span&gt;&lt;span class=&quot;mord mathdefault&quot;&gt;a&lt;/span&gt;&lt;span class=&quot;mord mathdefault&quot; style=&quot;margin-right:0.02778em;&quot;&gt;O&lt;/span&gt;&lt;span class=&quot;mord mathdefault&quot; style=&quot;margin-right:0.10764em;&quot;&gt;f&lt;/span&gt;&lt;span class=&quot;mord mathdefault&quot; style=&quot;margin-right:0.10764em;&quot;&gt;f&lt;/span&gt;&lt;span class=&quot;mord mathdefault&quot;&gt;s&lt;/span&gt;&lt;span class=&quot;mord mathdefault&quot;&gt;e&lt;/span&gt;&lt;span class=&quot;mord mathdefault&quot;&gt;t&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;mspace&quot; style=&quot;margin-right:0.2222222222222222em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;mspace&quot; style=&quot;margin-right:0.16666666666666666em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;mbin&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;mspace&quot; style=&quot;margin-right:0.2222222222222222em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;mspace&quot; style=&quot;margin-right:0.16666666666666666em;&quot;&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;base&quot;&gt;&lt;span class=&quot;strut&quot; style=&quot;height:0.64444em;vertical-align:0em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;mord&quot;&gt;8&lt;/span&gt;&lt;span class=&quot;mspace&quot; style=&quot;margin-right:0.2222222222222222em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;mbin&quot;&gt;∗&lt;/span&gt;&lt;span class=&quot;mspace&quot; style=&quot;margin-right:0.2222222222222222em;&quot;&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;base&quot;&gt;&lt;span class=&quot;strut&quot; style=&quot;height:0.8888799999999999em;vertical-align:-0.19444em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;mord mathdefault&quot; style=&quot;margin-right:0.03148em;&quot;&gt;k&lt;/span&gt;&lt;span class=&quot;mord mathdefault&quot;&gt;e&lt;/span&gt;&lt;span class=&quot;mord mathdefault&quot; style=&quot;margin-right:0.03588em;&quot;&gt;y&lt;/span&gt;&lt;span class=&quot;mord mathdefault&quot; style=&quot;margin-right:0.05764em;&quot;&gt;S&lt;/span&gt;&lt;span class=&quot;mord mathdefault&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;mord mathdefault&quot; style=&quot;margin-right:0.04398em;&quot;&gt;z&lt;/span&gt;&lt;span class=&quot;mord mathdefault&quot;&gt;e&lt;/span&gt;&lt;span class=&quot;mspace&quot; style=&quot;margin-right:0.2222222222222222em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;mspace&quot; style=&quot;margin-right:0.16666666666666666em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;mbin&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;mspace&quot; style=&quot;margin-right:0.2222222222222222em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;mspace&quot; style=&quot;margin-right:0.16666666666666666em;&quot;&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;base&quot;&gt;&lt;span class=&quot;strut&quot; style=&quot;height:0.65952em;vertical-align:0em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;mord mathdefault&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;mspace&quot; style=&quot;margin-right:0.2222222222222222em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;mbin&quot;&gt;∗&lt;/span&gt;&lt;span class=&quot;mspace&quot; style=&quot;margin-right:0.2222222222222222em;&quot;&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;base&quot;&gt;&lt;span class=&quot;strut&quot; style=&quot;height:0.69444em;vertical-align:0em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;mord mathdefault&quot;&gt;e&lt;/span&gt;&lt;span class=&quot;mord mathdefault&quot; style=&quot;margin-right:0.01968em;&quot;&gt;l&lt;/span&gt;&lt;span class=&quot;mord mathdefault&quot;&gt;e&lt;/span&gt;&lt;span class=&quot;mord mathdefault&quot;&gt;m&lt;/span&gt;&lt;span class=&quot;mord mathdefault&quot; style=&quot;margin-right:0.05764em;&quot;&gt;S&lt;/span&gt;&lt;span class=&quot;mord mathdefault&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;mord mathdefault&quot; style=&quot;margin-right:0.04398em;&quot;&gt;z&lt;/span&gt;&lt;span class=&quot;mord mathdefault&quot;&gt;e&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;br&gt;
&lt;p&gt;이번 포스팅에서는 1.18 버전의 &lt;code class=&quot;language-text&quot;&gt;runtime/map.go&lt;/code&gt; 파일을 훑어보며 Go에서 해시 테이블이 어떻게 구현되어 있는지 살펴본다.&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;&lt;code class=&quot;language-text&quot;&gt;hmap&lt;/code&gt;, &lt;code class=&quot;language-text&quot;&gt;bmap&lt;/code&gt;, &lt;code class=&quot;language-text&quot;&gt;maptype&lt;/code&gt;이 어떻게 정의되어 있는지 살펴본다.&lt;/li&gt;
&lt;li&gt;맵을 생성하는 &lt;code class=&quot;language-text&quot;&gt;makemap()&lt;/code&gt; 함수에 대해 살펴본다.&lt;/li&gt;
&lt;li&gt;키를 통해 맵에 접근하는 &lt;code class=&quot;language-text&quot;&gt;mapaccess()&lt;/code&gt; 계열 함수에 대해 살펴본다.&lt;/li&gt;
&lt;/ol&gt;
&lt;br&gt;
&lt;h2 id=&quot;1-hmap-struct&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#1-hmap-struct&quot; aria-label=&quot;1 hmap struct permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;1. &lt;em&gt;hmap&lt;/em&gt; struct&lt;/h2&gt;
&lt;p&gt;Go 런타임에서는 맵 생성 시 hmap이라는 구조체의 포인터를 리턴하며, 이 hmap은 맵의 헤더라고 할 수 있다.&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;go&quot;&gt;&lt;pre class=&quot;language-go&quot;&gt;&lt;code class=&quot;language-go&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;type&lt;/span&gt; hmap &lt;span class=&quot;token keyword&quot;&gt;struct&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
	count &lt;span class=&quot;token builtin&quot;&gt;int&lt;/span&gt;
	flags &lt;span class=&quot;token builtin&quot;&gt;uint8&lt;/span&gt;
	B &lt;span class=&quot;token builtin&quot;&gt;uint8&lt;/span&gt;
	noverflow &lt;span class=&quot;token builtin&quot;&gt;uint16&lt;/span&gt;
	hash0 &lt;span class=&quot;token builtin&quot;&gt;uint32&lt;/span&gt;

	buckets unsafe&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;Pointer
	oldbuckets unsafe&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;Pointer
	nevacuate &lt;span class=&quot;token builtin&quot;&gt;uintptr&lt;/span&gt;

	extra &lt;span class=&quot;token operator&quot;&gt;*&lt;/span&gt;mapextra
&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;여기서 알고넘어가야 할 중요한 필드들은 다음과 같다.&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;&lt;code class=&quot;language-text&quot;&gt;B&lt;/code&gt; (&lt;em&gt;uint8&lt;/em&gt;) : map이 가지는 버킷의 수에 &lt;span class=&quot;katex&quot;&gt;&lt;span class=&quot;katex-mathml&quot;&gt;&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;semantics&gt;&lt;mrow&gt;&lt;mi&gt;l&lt;/mi&gt;&lt;mi&gt;o&lt;/mi&gt;&lt;msub&gt;&lt;mi&gt;g&lt;/mi&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;annotation encoding=&quot;application/x-tex&quot;&gt;log_2&lt;/annotation&gt;&lt;/semantics&gt;&lt;/math&gt;&lt;/span&gt;&lt;span class=&quot;katex-html&quot; aria-hidden=&quot;true&quot;&gt;&lt;span class=&quot;base&quot;&gt;&lt;span class=&quot;strut&quot; style=&quot;height:0.8888799999999999em;vertical-align:-0.19444em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;mord mathdefault&quot; style=&quot;margin-right:0.01968em;&quot;&gt;l&lt;/span&gt;&lt;span class=&quot;mord mathdefault&quot;&gt;o&lt;/span&gt;&lt;span class=&quot;mord&quot;&gt;&lt;span class=&quot;mord mathdefault&quot; style=&quot;margin-right:0.03588em;&quot;&gt;g&lt;/span&gt;&lt;span class=&quot;msupsub&quot;&gt;&lt;span class=&quot;vlist-t vlist-t2&quot;&gt;&lt;span class=&quot;vlist-r&quot;&gt;&lt;span class=&quot;vlist&quot; style=&quot;height:0.30110799999999993em;&quot;&gt;&lt;span style=&quot;top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;&quot;&gt;&lt;span class=&quot;pstrut&quot; style=&quot;height:2.7em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;sizing reset-size6 size3 mtight&quot;&gt;&lt;span class=&quot;mord mtight&quot;&gt;2&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;vlist-s&quot;&gt;​&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;vlist-r&quot;&gt;&lt;span class=&quot;vlist&quot; style=&quot;height:0.15em;&quot;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;를 취한 값.&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;map이 최대 &lt;span class=&quot;katex&quot;&gt;&lt;span class=&quot;katex-mathml&quot;&gt;&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;semantics&gt;&lt;mrow&gt;&lt;msup&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;mi&gt;B&lt;/mi&gt;&lt;/msup&gt;&lt;/mrow&gt;&lt;annotation encoding=&quot;application/x-tex&quot;&gt;2^B&lt;/annotation&gt;&lt;/semantics&gt;&lt;/math&gt;&lt;/span&gt;&lt;span class=&quot;katex-html&quot; aria-hidden=&quot;true&quot;&gt;&lt;span class=&quot;base&quot;&gt;&lt;span class=&quot;strut&quot; style=&quot;height:0.8413309999999999em;vertical-align:0em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;mord&quot;&gt;&lt;span class=&quot;mord&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;msupsub&quot;&gt;&lt;span class=&quot;vlist-t&quot;&gt;&lt;span class=&quot;vlist-r&quot;&gt;&lt;span class=&quot;vlist&quot; style=&quot;height:0.8413309999999999em;&quot;&gt;&lt;span style=&quot;top:-3.063em;margin-right:0.05em;&quot;&gt;&lt;span class=&quot;pstrut&quot; style=&quot;height:2.7em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;sizing reset-size6 size3 mtight&quot;&gt;&lt;span class=&quot;mord mathdefault mtight&quot; style=&quot;margin-right:0.05017em;&quot;&gt;B&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;개의 버킷을 가질 수 있도록 B값을 결정한다.&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;code class=&quot;language-text&quot;&gt;hash0&lt;/code&gt; (&lt;em&gt;uint32&lt;/em&gt;) : 해시 충돌을 피하기 위한 랜덤 시드.&lt;/li&gt;
&lt;li&gt;&lt;code class=&quot;language-text&quot;&gt;buckets&lt;/code&gt; (&lt;em&gt;unsafe.Pointer&lt;/em&gt;) : 실제 버킷들(array)을 가리키는 포인터.&lt;/li&gt;
&lt;li&gt;&lt;code class=&quot;language-text&quot;&gt;oldbuckets&lt;/code&gt; (&lt;em&gt;unsafe.Pointer&lt;/em&gt;) : 버킷이 충분히 많이 차서 해시 충돌이 우려될 경우 버킷 개수를 늘려 재할당하는데, 이 과정(growing)이 진행될 때 이전 버킷 array를 가리킴. growing이 진행되지 않을 때는 &lt;code class=&quot;language-text&quot;&gt;nil&lt;/code&gt;값을 가짐.&lt;/li&gt;
&lt;li&gt;&lt;code class=&quot;language-text&quot;&gt;nevacuate&lt;/code&gt; (&lt;em&gt;uintptr&lt;/em&gt;) : growing이 진행 중에 oldbuckets에서 새로운 buckets로 버킷이 옮겨가게 되는데, 다음으로 옮겨갈 버킷에 대한 주소를 가리킴.&lt;/li&gt;
&lt;li&gt;&lt;code class=&quot;language-text&quot;&gt;extra&lt;/code&gt; (*mapextra) : 버킷의 수가 오버플로우되는 상황을 대비해서 미리 메모리 할당해둔 부분.&lt;/li&gt;
&lt;/ul&gt;
&lt;br&gt;
&lt;p&gt;💡 (참고) &lt;strong&gt;&lt;code class=&quot;language-text&quot;&gt;uintptr&lt;/code&gt; vs &lt;code class=&quot;language-text&quot;&gt;unsafe.Pointer&lt;/code&gt;&lt;/strong&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;uintptr은 builtin.go의 주석에 따르면 &lt;strong&gt;어떤 포인터든 주소를 담을 수 있게 충분히 큰 integer&lt;/strong&gt; 타입이라고 한다.&lt;/li&gt;
&lt;li&gt;unsafe.Pointer는 &lt;strong&gt;임의의 포인터 타입&lt;/strong&gt;(&lt;code class=&quot;language-text&quot;&gt;*ArbitraryType&lt;/code&gt;)을 표현하며, 실제 Go object를 가리키고 있다. C의 &lt;code class=&quot;language-text&quot;&gt;*void&lt;/code&gt; 처럼 어떤 타입의 포인터로든 변환할 수 있다.&lt;/li&gt;
&lt;li&gt;unsafe.Pointer는 Go object를 가리키는 포인터로서 동작하고 있기 때문에 &lt;strong&gt;Go의 가비지 컬렉터에게 추적&lt;/strong&gt;된다. 그러나 uintptr는 단순히 주소를 담는 정수형 변수기 때문에 가비지 컬렉션될 수 없으며, 사용하기에 매우 위험하다.&lt;/li&gt;
&lt;/ul&gt;
&lt;br&gt;
&lt;h2 id=&quot;2-bmap-struct&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#2-bmap-struct&quot; aria-label=&quot;2 bmap struct permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;2. &lt;em&gt;bmap&lt;/em&gt; struct&lt;/h2&gt;
&lt;p&gt;&lt;em&gt;bmap&lt;/em&gt;은 Go 맵에서 버킷을 가리킨다.&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;go&quot;&gt;&lt;pre class=&quot;language-go&quot;&gt;&lt;code class=&quot;language-go&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;type&lt;/span&gt; bmap &lt;span class=&quot;token keyword&quot;&gt;struct&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
	tophash &lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;bucketCnt&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;token builtin&quot;&gt;uint8&lt;/span&gt;
&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;
&lt;span class=&quot;token comment&quot;&gt;// bucketCnt는 8(1&amp;lt;&amp;lt;3)을 기본값으로 가진다.&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;&lt;code class=&quot;language-text&quot;&gt;bucketCnt&lt;/code&gt;는 8을 기본값으로 가지며 한 버킷 당 저장할 수 있는 키-밸류 데이터 개수(&lt;strong&gt;슬롯 개수&lt;/strong&gt;)를 뜻한다.&lt;/p&gt;
&lt;p&gt;&lt;code class=&quot;language-text&quot;&gt;tophash&lt;/code&gt;는 이 버킷에 포함된 &lt;strong&gt;각 키의 해시 값에서 최상위 바이트(8비트)&lt;/strong&gt;, 즉 키의 해시값에서 왼쪽부터 8비트를 가지고 있는 배열이다.&lt;/p&gt;
&lt;p&gt;이렇게 버킷 내의 키들에 대해 해시 값을 또 갖고 있는 이유는 Go에서의 해시테이블이 &lt;strong&gt;Separate Chaining&lt;/strong&gt; 방식을 사용하는 다른 언어 구현체들과 다르게 버킷이 Linked List 기반이 아니고 그냥 &lt;strong&gt;Array&lt;/strong&gt;이기 때문이다.&lt;/p&gt;
&lt;br&gt;
&lt;p&gt;여기서 버킷이 실제 키-밸류 데이터를 담는 부분이라 &lt;em&gt;bmap&lt;/em&gt;에 키 값과 밸류 값, 혹은 키와 밸류를 가리키는 포인터가 있을 것이라고 생각할 수 있다.&lt;/p&gt;
&lt;p&gt;그러나 &lt;code class=&quot;language-text&quot;&gt;map.go&lt;/code&gt; 코드 상의 구현에는 &lt;em&gt;bmap&lt;/em&gt; struct의 필드로 &lt;code class=&quot;language-text&quot;&gt;tophash&lt;/code&gt;만이 존재하며 키와 밸류는 존재하지 않는다.&lt;/p&gt;
&lt;p&gt;그렇다면 키와 밸류는 어디에 저장되어 있을까?&lt;/p&gt;
&lt;br&gt;
&lt;p&gt;실제로 &lt;em&gt;bmap&lt;/em&gt;이 할당되는 과정이나 밸류를 갖고 오는 과정을 살펴보면 메모리 상에 다음과 같이 할당되어 있음을 알 수 있다.&lt;/p&gt;
&lt;p&gt;&lt;span
      class=&quot;gatsby-resp-image-wrapper&quot;
      style=&quot;position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 1195px; &quot;
    &gt;
      &lt;span
    class=&quot;gatsby-resp-image-background-image&quot;
    style=&quot;padding-bottom: 29.000000000000004%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAGCAYAAADDl76dAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAy0lEQVQY03VRhwrFQAi7///FLtrSTfeeeUTweIMnSDEXY7TmOA4wnufBdV02Wfd9D9/3kSQJwjDEsiy47/uDp0kd9ph931HXNcZx/CGf54lt24RMHrFvDmsmeSJYFAXiOEaapiI8DIOI0808z5imSZKYJnG+K85v0zQiKoKO44gYV6QbTuaKxDiVTsuytI7Ic11XhFmT07Yt1nWFybIMQRBIgzrsug6e5yGKIusqz3PrhttQkL26QVVV4tpwAuP7Nhrvt9K70tG/H/kCy/LP/PxZYNgAAAAASUVORK5CYII=&apos;); background-size: cover; display: block;&quot;
  &gt;&lt;/span&gt;
  &lt;img
        class=&quot;gatsby-resp-image-image&quot;
        alt=&quot;20220407 1&quot;
        title=&quot;20220407 1&quot;
        src=&quot;/static/819e228b9e4b144d9bc599f3256cb6fd/4d383/20220407-1.png&quot;
        srcset=&quot;/static/819e228b9e4b144d9bc599f3256cb6fd/5a46d/20220407-1.png 300w,
/static/819e228b9e4b144d9bc599f3256cb6fd/0a47e/20220407-1.png 600w,
/static/819e228b9e4b144d9bc599f3256cb6fd/4d383/20220407-1.png 1195w&quot;
        sizes=&quot;(max-width: 1195px) 100vw, 1195px&quot;
        style=&quot;width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;&quot;
        loading=&quot;lazy&quot;
      /&gt;
    &lt;/span&gt;&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;go&quot;&gt;&lt;pre class=&quot;language-go&quot;&gt;&lt;code class=&quot;language-go&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;type&lt;/span&gt; bmap &lt;span class=&quot;token keyword&quot;&gt;struct&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
	tophash &lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;8&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;token builtin&quot;&gt;uint8&lt;/span&gt;
&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;
keys &lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;8&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;K
values &lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;8&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;V&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;코드 상에 keys와 values가 이렇게 나타나있지는 않지만 &lt;strong&gt;&lt;em&gt;bmap&lt;/em&gt;이 할당된 메모리 이후에 실제로 8개의 키 함께 할당되어 있고 그 후에 8개의 밸류가 선형적으로 할당&lt;/strong&gt;되어 있다.&lt;/p&gt;
&lt;br&gt;
&lt;p&gt;여기서 &lt;code class=&quot;language-text&quot;&gt;&amp;lt; key0 | key1 | ... | key7 | val0 | val1 | ... | val7 &amp;gt;&lt;/code&gt; 이렇게 키끼리 밸류끼리 묶는 것보다, &lt;code class=&quot;language-text&quot;&gt;&amp;lt; key0 | val0 | ... | key7 | val7 &amp;gt;&lt;/code&gt; 과 같이 키와 밸류를 교대하며 할당하는 것이 더 편하지 않을까 하는 의문이 들 수 있다.&lt;/p&gt;
&lt;p&gt;물론 키-밸류를 교대하며 각각을 한 쌍으로 할당하는 것이 데이터의 접근에 있어 코드가 덜 복잡하다.&lt;/p&gt;
&lt;p&gt;그러나 &lt;code class=&quot;language-text&quot;&gt;map[int64]int8&lt;/code&gt;과 같은 타입의 경우 키-밸류를 페어로 할당하면 &lt;code class=&quot;language-text&quot;&gt;&amp;lt; 64비트 | 8비트 | 64비트 | 8비트 | ... &amp;gt;&lt;/code&gt; 와 같이 할당되는데, &lt;strong&gt;메모리 정렬(memory alignment)&lt;/strong&gt; 관점에서 봤을 때 8비트 후에 다량의 패딩이 추가되어 비효율이 발생할 수밖에 없다.&lt;/p&gt;
&lt;p&gt;따라서 &lt;code class=&quot;language-text&quot;&gt;map[int64]int8&lt;/code&gt;을 Go의 구현대로 생성하면 &lt;code class=&quot;language-text&quot;&gt;&amp;lt; 64비트 | 64비트 | ... | 8비트 | 8비트 | ... &amp;gt;&lt;/code&gt;와 같은 형태로 할당되어 패딩을 제거할 수 있어 더 효율적이다.&lt;/p&gt;
&lt;br&gt;
&lt;p&gt;우선 지금은 &lt;em&gt;bmap&lt;/em&gt;에 대해서 이 정도로만 알아보고 추후에 &lt;code class=&quot;language-text&quot;&gt;mapaccess()&lt;/code&gt;나 &lt;code class=&quot;language-text&quot;&gt;mapassign()&lt;/code&gt; 함수를 설명할 때 자세히 살펴보도록 하겠다.&lt;/p&gt;
&lt;br&gt;
&lt;h2 id=&quot;3-makemap--맵-생성하기&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#3-makemap--%EB%A7%B5-%EC%83%9D%EC%84%B1%ED%95%98%EA%B8%B0&quot; aria-label=&quot;3 makemap  맵 생성하기 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;3. &lt;em&gt;makemap()&lt;/em&gt; :: 맵 생성하기&lt;/h2&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;go&quot;&gt;&lt;pre class=&quot;language-go&quot;&gt;&lt;code class=&quot;language-go&quot;&gt;m1 &lt;span class=&quot;token operator&quot;&gt;:=&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;make&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token keyword&quot;&gt;map&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;k&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;v&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
m2 &lt;span class=&quot;token operator&quot;&gt;:=&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;make&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token keyword&quot;&gt;map&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;k&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;v&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;1234&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;Go에서 맵은 위 코드를 통해 생성한다. &lt;code class=&quot;language-text&quot;&gt;m1&lt;/code&gt;처럼 생성할 수도 있지만, 이렇게 생성되는 초기 맵 사이즈에 비해 담아야 할 값들이 많다면 맵이 growing 과정을 여러번 거칠 수 있어 효율성이 떨어질 수 있다.&lt;/p&gt;
&lt;p&gt;보다 나은 효율을 위해, &lt;code class=&quot;language-text&quot;&gt;m2&lt;/code&gt;처럼 값을 몇개를 담을건지 힌트(&lt;strong&gt;&lt;em&gt;hint&lt;/em&gt;&lt;/strong&gt;)를 주어 생성할 수 있다.
&lt;br&gt;&lt;/p&gt;
&lt;p&gt;&lt;code class=&quot;language-text&quot;&gt;make(map[k]v, hint)&lt;/code&gt; 코드는 Go 런타임에서 &lt;code class=&quot;language-text&quot;&gt;makemap()&lt;/code&gt; 함수를 호출하게 한다.
&lt;code class=&quot;language-text&quot;&gt;makemap()&lt;/code&gt; 함수의 전체 코드는 다음과 같다.&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;go&quot;&gt;&lt;pre class=&quot;language-go&quot;&gt;&lt;code class=&quot;language-go&quot;&gt;&lt;span class=&quot;token comment&quot;&gt;// src/runtime/map.go&lt;/span&gt;
&lt;span class=&quot;token comment&quot;&gt;// makemap() 전체 코드&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;func&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;makemap&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;t &lt;span class=&quot;token operator&quot;&gt;*&lt;/span&gt;maptype&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; hint &lt;span class=&quot;token builtin&quot;&gt;int&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; h &lt;span class=&quot;token operator&quot;&gt;*&lt;/span&gt;hmap&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;*&lt;/span&gt;hmap &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
	mem&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; overflow &lt;span class=&quot;token operator&quot;&gt;:=&lt;/span&gt; math&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;MulUintptr&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;uintptr&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;hint&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; t&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;bucket&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;size&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
	&lt;span class=&quot;token keyword&quot;&gt;if&lt;/span&gt; overflow &lt;span class=&quot;token operator&quot;&gt;||&lt;/span&gt; mem &lt;span class=&quot;token operator&quot;&gt;&gt;&lt;/span&gt; maxAlloc &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
		hint &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;0&lt;/span&gt;
	&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;

	&lt;span class=&quot;token comment&quot;&gt;// initialize Hmap&lt;/span&gt;
	&lt;span class=&quot;token keyword&quot;&gt;if&lt;/span&gt; h &lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt; &lt;span class=&quot;token boolean&quot;&gt;nil&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
		h &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;new&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;hmap&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
	&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;
	h&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;hash0 &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;fastrand&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;

	&lt;span class=&quot;token comment&quot;&gt;// Find the size parameter B which will hold the requested # of elements.&lt;/span&gt;
	&lt;span class=&quot;token comment&quot;&gt;// For hint &amp;lt; 0 overLoadFactor returns false since hint &amp;lt; bucketCnt.&lt;/span&gt;
	B &lt;span class=&quot;token operator&quot;&gt;:=&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;uint8&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
	&lt;span class=&quot;token keyword&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;overLoadFactor&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;hint&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; B&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
		B&lt;span class=&quot;token operator&quot;&gt;++&lt;/span&gt;
	&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;
	h&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;B &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; B

	&lt;span class=&quot;token comment&quot;&gt;// allocate initial hash table&lt;/span&gt;
	&lt;span class=&quot;token comment&quot;&gt;// if B == 0, the buckets field is allocated lazily later (in mapassign)&lt;/span&gt;
	&lt;span class=&quot;token comment&quot;&gt;// If hint is large zeroing this memory could take a while.&lt;/span&gt;
	&lt;span class=&quot;token keyword&quot;&gt;if&lt;/span&gt; h&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;B &lt;span class=&quot;token operator&quot;&gt;!=&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;0&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
		&lt;span class=&quot;token keyword&quot;&gt;var&lt;/span&gt; nextOverflow &lt;span class=&quot;token operator&quot;&gt;*&lt;/span&gt;bmap
		h&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;buckets&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; nextOverflow &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;makeBucketArray&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;t&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; h&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;B&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token boolean&quot;&gt;nil&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
		&lt;span class=&quot;token keyword&quot;&gt;if&lt;/span&gt; nextOverflow &lt;span class=&quot;token operator&quot;&gt;!=&lt;/span&gt; &lt;span class=&quot;token boolean&quot;&gt;nil&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
			h&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;extra &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;new&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;mapextra&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
			h&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;extra&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;nextOverflow &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; nextOverflow
		&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;
	&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;

	&lt;span class=&quot;token keyword&quot;&gt;return&lt;/span&gt; h
&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;br&gt;
&lt;p&gt;파라미터로 &lt;code class=&quot;language-text&quot;&gt;*maptype&lt;/code&gt;, &lt;code class=&quot;language-text&quot;&gt;int&lt;/code&gt;, &lt;code class=&quot;language-text&quot;&gt;*hmap&lt;/code&gt;이 들어가는데, &lt;code class=&quot;language-text&quot;&gt;maptype&lt;/code&gt;은 &lt;code class=&quot;language-text&quot;&gt;runtime/type.go&lt;/code&gt;에 다음과 같이 정의되어 있다.&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;go&quot;&gt;&lt;pre class=&quot;language-go&quot;&gt;&lt;code class=&quot;language-go&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;type&lt;/span&gt; maptype &lt;span class=&quot;token keyword&quot;&gt;struct&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
	typ    _type
	key    &lt;span class=&quot;token operator&quot;&gt;*&lt;/span&gt;_type
	elem   &lt;span class=&quot;token operator&quot;&gt;*&lt;/span&gt;_type
	bucket &lt;span class=&quot;token operator&quot;&gt;*&lt;/span&gt;_type &lt;span class=&quot;token comment&quot;&gt;// internal type representing a hash bucket&lt;/span&gt;
	&lt;span class=&quot;token comment&quot;&gt;// function for hashing keys (ptr to key, seed) -&gt; hash&lt;/span&gt;
	hasher     &lt;span class=&quot;token keyword&quot;&gt;func&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;unsafe&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;Pointer&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token builtin&quot;&gt;uintptr&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token builtin&quot;&gt;uintptr&lt;/span&gt;
	keysize    &lt;span class=&quot;token builtin&quot;&gt;uint8&lt;/span&gt;  &lt;span class=&quot;token comment&quot;&gt;// size of key slot&lt;/span&gt;
	elemsize   &lt;span class=&quot;token builtin&quot;&gt;uint8&lt;/span&gt;  &lt;span class=&quot;token comment&quot;&gt;// size of elem slot&lt;/span&gt;
	bucketsize &lt;span class=&quot;token builtin&quot;&gt;uint16&lt;/span&gt; &lt;span class=&quot;token comment&quot;&gt;// size of bucket&lt;/span&gt;
	flags      &lt;span class=&quot;token builtin&quot;&gt;uint32&lt;/span&gt;
&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;br&gt;
&lt;h3 id=&quot;31-makemap---필요-메모리-계산&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#31-makemap---%ED%95%84%EC%9A%94-%EB%A9%94%EB%AA%A8%EB%A6%AC-%EA%B3%84%EC%82%B0&quot; aria-label=&quot;31 makemap   필요 메모리 계산 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;3.1. &lt;em&gt;makemap()&lt;/em&gt; - 필요 메모리 계산&lt;/h3&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;go&quot;&gt;&lt;pre class=&quot;language-go&quot;&gt;&lt;code class=&quot;language-go&quot;&gt;&lt;span class=&quot;token comment&quot;&gt;// makemap() 부분 1&lt;/span&gt;
mem&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; overflow &lt;span class=&quot;token operator&quot;&gt;:=&lt;/span&gt; math&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;MulUintptr&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;uintptr&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;hint&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; t&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;bucket&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;size&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;if&lt;/span&gt; overflow &lt;span class=&quot;token operator&quot;&gt;||&lt;/span&gt; mem &lt;span class=&quot;token operator&quot;&gt;&gt;&lt;/span&gt; maxAlloc &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
	hint &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;0&lt;/span&gt;
&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;
&lt;span class=&quot;token comment&quot;&gt;// ...&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;&lt;code class=&quot;language-text&quot;&gt;makemap()&lt;/code&gt; 함수에서는 먼저 hint 값과 버킷의 사이즈를 기반으로 메모리가 얼마나 필요한지 계산한다.&lt;/p&gt;
&lt;p&gt;이 때, overflow가 발생하거나 계산된 메모리 양이 &lt;code class=&quot;language-text&quot;&gt;maxAlloc&lt;/code&gt;보다 크다면 &lt;code class=&quot;language-text&quot;&gt;hint&lt;/code&gt;가 0으로 변경되고 나중에 &lt;code class=&quot;language-text&quot;&gt;B&lt;/code&gt;도 0으로 계산되며, 버킷은 추후에 lazily allocated된다.&lt;/p&gt;
&lt;p&gt;(&lt;code class=&quot;language-text&quot;&gt;maxAlloc&lt;/code&gt;은 AMD64 시스템에서 &lt;span class=&quot;katex&quot;&gt;&lt;span class=&quot;katex-mathml&quot;&gt;&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;semantics&gt;&lt;mrow&gt;&lt;msup&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;mn&gt;48&lt;/mn&gt;&lt;/msup&gt;&lt;/mrow&gt;&lt;annotation encoding=&quot;application/x-tex&quot;&gt;2^{48}&lt;/annotation&gt;&lt;/semantics&gt;&lt;/math&gt;&lt;/span&gt;&lt;span class=&quot;katex-html&quot; aria-hidden=&quot;true&quot;&gt;&lt;span class=&quot;base&quot;&gt;&lt;span class=&quot;strut&quot; style=&quot;height:0.8141079999999999em;vertical-align:0em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;mord&quot;&gt;&lt;span class=&quot;mord&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;msupsub&quot;&gt;&lt;span class=&quot;vlist-t&quot;&gt;&lt;span class=&quot;vlist-r&quot;&gt;&lt;span class=&quot;vlist&quot; style=&quot;height:0.8141079999999999em;&quot;&gt;&lt;span style=&quot;top:-3.063em;margin-right:0.05em;&quot;&gt;&lt;span class=&quot;pstrut&quot; style=&quot;height:2.7em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;sizing reset-size6 size3 mtight&quot;&gt;&lt;span class=&quot;mord mtight&quot;&gt;&lt;span class=&quot;mord mtight&quot;&gt;4&lt;/span&gt;&lt;span class=&quot;mord mtight&quot;&gt;8&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;bit로 32TiB에 해당한다.[1])&lt;/p&gt;
&lt;br&gt;
&lt;h3 id=&quot;32-makemap---해시-테이블-초기화&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#32-makemap---%ED%95%B4%EC%8B%9C-%ED%85%8C%EC%9D%B4%EB%B8%94-%EC%B4%88%EA%B8%B0%ED%99%94&quot; aria-label=&quot;32 makemap   해시 테이블 초기화 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;3.2. &lt;em&gt;makemap()&lt;/em&gt; - 해시 테이블 초기화&lt;/h3&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;go&quot;&gt;&lt;pre class=&quot;language-go&quot;&gt;&lt;code class=&quot;language-go&quot;&gt;&lt;span class=&quot;token comment&quot;&gt;// makemap() 부분 2&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;if&lt;/span&gt; h &lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt; &lt;span class=&quot;token boolean&quot;&gt;nil&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
	h &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;new&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;hmap&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;
h&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;hash0 &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;fastrand&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;token comment&quot;&gt;// ...&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;다음 부분에서 hmap을 할당하고, &lt;code class=&quot;language-text&quot;&gt;hash0&lt;/code&gt; (해시 시드)를 설정한다.&lt;/p&gt;
&lt;p&gt;(&lt;a href=&quot;https://github.com/wangyi-fudan/wyhash&quot;&gt;wyhash&lt;/a&gt;라는 알고리즘으로 랜덤 시드를 생성한다.)&lt;/p&gt;
&lt;br&gt;
&lt;h3 id=&quot;33-makemap---할당할-버킷-수-계산&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#33-makemap---%ED%95%A0%EB%8B%B9%ED%95%A0-%EB%B2%84%ED%82%B7-%EC%88%98-%EA%B3%84%EC%82%B0&quot; aria-label=&quot;33 makemap   할당할 버킷 수 계산 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;3.3. &lt;em&gt;makemap()&lt;/em&gt; - 할당할 버킷 수 계산&lt;/h3&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;go&quot;&gt;&lt;pre class=&quot;language-go&quot;&gt;&lt;code class=&quot;language-go&quot;&gt;&lt;span class=&quot;token comment&quot;&gt;// makemap() 부분 3&lt;/span&gt;
B &lt;span class=&quot;token operator&quot;&gt;:=&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;uint8&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;overLoadFactor&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;hint&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; B&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
	B&lt;span class=&quot;token operator&quot;&gt;++&lt;/span&gt;
&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;
h&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;B &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; B
&lt;span class=&quot;token comment&quot;&gt;// ...&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;go&quot;&gt;&lt;pre class=&quot;language-go&quot;&gt;&lt;code class=&quot;language-go&quot;&gt;&lt;span class=&quot;token comment&quot;&gt;// overLoadFactor 함수는 같은 파일에 다음과 같이 구현되어 있다.&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;func&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;overLoadFactor&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;count &lt;span class=&quot;token builtin&quot;&gt;int&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; B &lt;span class=&quot;token builtin&quot;&gt;uint&lt;/span&gt; &lt;span class=&quot;token builtin&quot;&gt;bool&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
	&lt;span class=&quot;token keyword&quot;&gt;return&lt;/span&gt; count &lt;span class=&quot;token operator&quot;&gt;&gt;&lt;/span&gt; bucketCnt &lt;span class=&quot;token operator&quot;&gt;&amp;amp;&amp;amp;&lt;/span&gt;
		&lt;span class=&quot;token function&quot;&gt;uintptr&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;count&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;&gt;&lt;/span&gt; loadFactorNum&lt;span class=&quot;token operator&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;bucketShift&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;B&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;/&lt;/span&gt;loadFactorDen&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;주어진 &lt;code class=&quot;language-text&quot;&gt;hint&lt;/code&gt;값을 토대로 &lt;code class=&quot;language-text&quot;&gt;B&lt;/code&gt;값을 결정하는데, hint개의 키-밸류 데이터를 충분히 저장할 수 있는 버킷의 수를 구하게 된다.&lt;/p&gt;
&lt;p&gt;&lt;code class=&quot;language-text&quot;&gt;map.go&lt;/code&gt; 파일을 보면 윗부분에 &lt;code class=&quot;language-text&quot;&gt;loadFactorNum&lt;/code&gt;, &lt;code class=&quot;language-text&quot;&gt;loadFactorDen&lt;/code&gt; 이라는 정수형 상수가 정의되어 있다.&lt;/p&gt;
&lt;p&gt;기본으로 세팅된 값은 각각 13과 2로 &lt;code class=&quot;language-text&quot;&gt;loadFactorNum&lt;/code&gt;을 &lt;code class=&quot;language-text&quot;&gt;loadFactorDen&lt;/code&gt;으로 나누어 &lt;strong&gt;Load Factor&lt;/strong&gt;를 결정한다.&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Load Factor&lt;/strong&gt;는 &lt;strong&gt;버킷 당 평균 키-밸류 데이터 개수&lt;/strong&gt;를 뜻하며 Go에서는 이 값을 13/2 = &lt;strong&gt;6.5&lt;/strong&gt;로 사용한다.&lt;/p&gt;
&lt;p&gt;결론적으로, 위 코드에서 &lt;span class=&quot;katex&quot;&gt;&lt;span class=&quot;katex-mathml&quot;&gt;&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;semantics&gt;&lt;mrow&gt;&lt;mi&gt;L&lt;/mi&gt;&lt;mi&gt;o&lt;/mi&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mi&gt;d&lt;/mi&gt;&lt;mi&gt;F&lt;/mi&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mi&gt;c&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mi&gt;o&lt;/mi&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;mo&gt;∗&lt;/mo&gt;&lt;mi&gt;B&lt;/mi&gt;&lt;mo&gt;≥&lt;/mo&gt;&lt;mi&gt;h&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/mrow&gt;&lt;annotation encoding=&quot;application/x-tex&quot;&gt;LoadFactor * B \ge hint&lt;/annotation&gt;&lt;/semantics&gt;&lt;/math&gt;&lt;/span&gt;&lt;span class=&quot;katex-html&quot; aria-hidden=&quot;true&quot;&gt;&lt;span class=&quot;base&quot;&gt;&lt;span class=&quot;strut&quot; style=&quot;height:0.69444em;vertical-align:0em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;mord mathdefault&quot;&gt;L&lt;/span&gt;&lt;span class=&quot;mord mathdefault&quot;&gt;o&lt;/span&gt;&lt;span class=&quot;mord mathdefault&quot;&gt;a&lt;/span&gt;&lt;span class=&quot;mord mathdefault&quot;&gt;d&lt;/span&gt;&lt;span class=&quot;mord mathdefault&quot; style=&quot;margin-right:0.13889em;&quot;&gt;F&lt;/span&gt;&lt;span class=&quot;mord mathdefault&quot;&gt;a&lt;/span&gt;&lt;span class=&quot;mord mathdefault&quot;&gt;c&lt;/span&gt;&lt;span class=&quot;mord mathdefault&quot;&gt;t&lt;/span&gt;&lt;span class=&quot;mord mathdefault&quot;&gt;o&lt;/span&gt;&lt;span class=&quot;mord mathdefault&quot; style=&quot;margin-right:0.02778em;&quot;&gt;r&lt;/span&gt;&lt;span class=&quot;mspace&quot; style=&quot;margin-right:0.2222222222222222em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;mbin&quot;&gt;∗&lt;/span&gt;&lt;span class=&quot;mspace&quot; style=&quot;margin-right:0.2222222222222222em;&quot;&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;base&quot;&gt;&lt;span class=&quot;strut&quot; style=&quot;height:0.8193em;vertical-align:-0.13597em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;mord mathdefault&quot; style=&quot;margin-right:0.05017em;&quot;&gt;B&lt;/span&gt;&lt;span class=&quot;mspace&quot; style=&quot;margin-right:0.2777777777777778em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;mrel&quot;&gt;≥&lt;/span&gt;&lt;span class=&quot;mspace&quot; style=&quot;margin-right:0.2777777777777778em;&quot;&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;base&quot;&gt;&lt;span class=&quot;strut&quot; style=&quot;height:0.69444em;vertical-align:0em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;mord mathdefault&quot;&gt;h&lt;/span&gt;&lt;span class=&quot;mord mathdefault&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;mord mathdefault&quot;&gt;n&lt;/span&gt;&lt;span class=&quot;mord mathdefault&quot;&gt;t&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;가 되는 최소 &lt;code class=&quot;language-text&quot;&gt;B&lt;/code&gt;를 구하게 되고, 맵은 &lt;span class=&quot;katex&quot;&gt;&lt;span class=&quot;katex-mathml&quot;&gt;&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;semantics&gt;&lt;mrow&gt;&lt;msup&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;mi&gt;B&lt;/mi&gt;&lt;/msup&gt;&lt;/mrow&gt;&lt;annotation encoding=&quot;application/x-tex&quot;&gt;2^B&lt;/annotation&gt;&lt;/semantics&gt;&lt;/math&gt;&lt;/span&gt;&lt;span class=&quot;katex-html&quot; aria-hidden=&quot;true&quot;&gt;&lt;span class=&quot;base&quot;&gt;&lt;span class=&quot;strut&quot; style=&quot;height:0.8413309999999999em;vertical-align:0em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;mord&quot;&gt;&lt;span class=&quot;mord&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;msupsub&quot;&gt;&lt;span class=&quot;vlist-t&quot;&gt;&lt;span class=&quot;vlist-r&quot;&gt;&lt;span class=&quot;vlist&quot; style=&quot;height:0.8413309999999999em;&quot;&gt;&lt;span style=&quot;top:-3.063em;margin-right:0.05em;&quot;&gt;&lt;span class=&quot;pstrut&quot; style=&quot;height:2.7em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;sizing reset-size6 size3 mtight&quot;&gt;&lt;span class=&quot;mord mathdefault mtight&quot; style=&quot;margin-right:0.05017em;&quot;&gt;B&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;개의 버킷을 가질 수 있게 된다.&lt;/p&gt;
&lt;br&gt;
&lt;p&gt;💡 (참고) &lt;strong&gt;Load Factor&lt;/strong&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Load Factor가 버킷 당 평균 키-밸류 데이터 개수를 뜻하는데 현재 맵에 저장된 데이터가 Load Factor를 넘어가게 된다면 맵은 자동으로 용량을 늘리게 된다. (growing 과정)&lt;/li&gt;
&lt;li&gt;만약 이 Load Factor가 너무 작다면 growing 과정이 자주 트리거되어 오버헤드가 발생하여 접근 시간이 낭비될 것이고, 너무 크다면 메모리 공간이 낭비될 것이다.&lt;/li&gt;
&lt;li&gt;즉, Load Factor에 따라 시간과 공간이 trade-off 관계에 놓이게 되며, 이 값을 적당히 조정하는 것이 성능을 좌우한다고 할 수 있다.&lt;/li&gt;
&lt;li&gt;Java에서는 HashTable의 Load Factor로 75%를 사용한다.&lt;/li&gt;
&lt;/ul&gt;
&lt;br&gt;
&lt;p&gt;추가) &lt;code class=&quot;language-text&quot;&gt;bucketShift(B)&lt;/code&gt; 함수는 &lt;span class=&quot;katex&quot;&gt;&lt;span class=&quot;katex-mathml&quot;&gt;&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;semantics&gt;&lt;mrow&gt;&lt;msup&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;mi&gt;B&lt;/mi&gt;&lt;/msup&gt;&lt;/mrow&gt;&lt;annotation encoding=&quot;application/x-tex&quot;&gt;2^B&lt;/annotation&gt;&lt;/semantics&gt;&lt;/math&gt;&lt;/span&gt;&lt;span class=&quot;katex-html&quot; aria-hidden=&quot;true&quot;&gt;&lt;span class=&quot;base&quot;&gt;&lt;span class=&quot;strut&quot; style=&quot;height:0.8413309999999999em;vertical-align:0em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;mord&quot;&gt;&lt;span class=&quot;mord&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;msupsub&quot;&gt;&lt;span class=&quot;vlist-t&quot;&gt;&lt;span class=&quot;vlist-r&quot;&gt;&lt;span class=&quot;vlist&quot; style=&quot;height:0.8413309999999999em;&quot;&gt;&lt;span style=&quot;top:-3.063em;margin-right:0.05em;&quot;&gt;&lt;span class=&quot;pstrut&quot; style=&quot;height:2.7em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;sizing reset-size6 size3 mtight&quot;&gt;&lt;span class=&quot;mord mathdefault mtight&quot; style=&quot;margin-right:0.05017em;&quot;&gt;B&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;를 리턴하고 B의 범위는 32bit 시스템에서 &lt;span class=&quot;katex&quot;&gt;&lt;span class=&quot;katex-mathml&quot;&gt;&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;semantics&gt;&lt;mrow&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;mo&gt;≤&lt;/mo&gt;&lt;mi&gt;B&lt;/mi&gt;&lt;mo&gt;≤&lt;/mo&gt;&lt;mn&gt;31&lt;/mn&gt;&lt;/mrow&gt;&lt;annotation encoding=&quot;application/x-tex&quot;&gt;0 \le B \le 31&lt;/annotation&gt;&lt;/semantics&gt;&lt;/math&gt;&lt;/span&gt;&lt;span class=&quot;katex-html&quot; aria-hidden=&quot;true&quot;&gt;&lt;span class=&quot;base&quot;&gt;&lt;span class=&quot;strut&quot; style=&quot;height:0.78041em;vertical-align:-0.13597em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;mord&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;mspace&quot; style=&quot;margin-right:0.2777777777777778em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;mrel&quot;&gt;≤&lt;/span&gt;&lt;span class=&quot;mspace&quot; style=&quot;margin-right:0.2777777777777778em;&quot;&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;base&quot;&gt;&lt;span class=&quot;strut&quot; style=&quot;height:0.8193em;vertical-align:-0.13597em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;mord mathdefault&quot; style=&quot;margin-right:0.05017em;&quot;&gt;B&lt;/span&gt;&lt;span class=&quot;mspace&quot; style=&quot;margin-right:0.2777777777777778em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;mrel&quot;&gt;≤&lt;/span&gt;&lt;span class=&quot;mspace&quot; style=&quot;margin-right:0.2777777777777778em;&quot;&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;base&quot;&gt;&lt;span class=&quot;strut&quot; style=&quot;height:0.64444em;vertical-align:0em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;mord&quot;&gt;3&lt;/span&gt;&lt;span class=&quot;mord&quot;&gt;1&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;, 64bit 시스템에서 &lt;span class=&quot;katex&quot;&gt;&lt;span class=&quot;katex-mathml&quot;&gt;&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;semantics&gt;&lt;mrow&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;mo&gt;≤&lt;/mo&gt;&lt;mi&gt;B&lt;/mi&gt;&lt;mo&gt;≤&lt;/mo&gt;&lt;mn&gt;63&lt;/mn&gt;&lt;/mrow&gt;&lt;annotation encoding=&quot;application/x-tex&quot;&gt;0 \le B \le 63&lt;/annotation&gt;&lt;/semantics&gt;&lt;/math&gt;&lt;/span&gt;&lt;span class=&quot;katex-html&quot; aria-hidden=&quot;true&quot;&gt;&lt;span class=&quot;base&quot;&gt;&lt;span class=&quot;strut&quot; style=&quot;height:0.78041em;vertical-align:-0.13597em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;mord&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;mspace&quot; style=&quot;margin-right:0.2777777777777778em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;mrel&quot;&gt;≤&lt;/span&gt;&lt;span class=&quot;mspace&quot; style=&quot;margin-right:0.2777777777777778em;&quot;&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;base&quot;&gt;&lt;span class=&quot;strut&quot; style=&quot;height:0.8193em;vertical-align:-0.13597em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;mord mathdefault&quot; style=&quot;margin-right:0.05017em;&quot;&gt;B&lt;/span&gt;&lt;span class=&quot;mspace&quot; style=&quot;margin-right:0.2777777777777778em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;mrel&quot;&gt;≤&lt;/span&gt;&lt;span class=&quot;mspace&quot; style=&quot;margin-right:0.2777777777777778em;&quot;&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;base&quot;&gt;&lt;span class=&quot;strut&quot; style=&quot;height:0.64444em;vertical-align:0em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;mord&quot;&gt;6&lt;/span&gt;&lt;span class=&quot;mord&quot;&gt;3&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;이다.&lt;/p&gt;
&lt;p&gt;&lt;code class=&quot;language-text&quot;&gt;B&lt;/code&gt;의 정의가 버킷 개수에 &lt;span class=&quot;katex&quot;&gt;&lt;span class=&quot;katex-mathml&quot;&gt;&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;semantics&gt;&lt;mrow&gt;&lt;mi&gt;l&lt;/mi&gt;&lt;mi&gt;o&lt;/mi&gt;&lt;msub&gt;&lt;mi&gt;g&lt;/mi&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;annotation encoding=&quot;application/x-tex&quot;&gt;log_2&lt;/annotation&gt;&lt;/semantics&gt;&lt;/math&gt;&lt;/span&gt;&lt;span class=&quot;katex-html&quot; aria-hidden=&quot;true&quot;&gt;&lt;span class=&quot;base&quot;&gt;&lt;span class=&quot;strut&quot; style=&quot;height:0.8888799999999999em;vertical-align:-0.19444em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;mord mathdefault&quot; style=&quot;margin-right:0.01968em;&quot;&gt;l&lt;/span&gt;&lt;span class=&quot;mord mathdefault&quot;&gt;o&lt;/span&gt;&lt;span class=&quot;mord&quot;&gt;&lt;span class=&quot;mord mathdefault&quot; style=&quot;margin-right:0.03588em;&quot;&gt;g&lt;/span&gt;&lt;span class=&quot;msupsub&quot;&gt;&lt;span class=&quot;vlist-t vlist-t2&quot;&gt;&lt;span class=&quot;vlist-r&quot;&gt;&lt;span class=&quot;vlist&quot; style=&quot;height:0.30110799999999993em;&quot;&gt;&lt;span style=&quot;top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;&quot;&gt;&lt;span class=&quot;pstrut&quot; style=&quot;height:2.7em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;sizing reset-size6 size3 mtight&quot;&gt;&lt;span class=&quot;mord mtight&quot;&gt;2&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;vlist-s&quot;&gt;​&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;vlist-r&quot;&gt;&lt;span class=&quot;vlist&quot; style=&quot;height:0.15em;&quot;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;를 취한 것이기 때문에 &lt;code class=&quot;language-text&quot;&gt;bucketShift(B)&lt;/code&gt; 함수의 역할은 &lt;strong&gt;주어진 B 값을 기반으로 가질 수 있는 버킷 개수를 계산&lt;/strong&gt;하는 것이라고 할 수 있다.&lt;/p&gt;
&lt;br&gt;
&lt;h3 id=&quot;34-makemap---버킷-array-생성&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#34-makemap---%EB%B2%84%ED%82%B7-array-%EC%83%9D%EC%84%B1&quot; aria-label=&quot;34 makemap   버킷 array 생성 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;3.4. &lt;em&gt;makemap()&lt;/em&gt; - 버킷 Array 생성&lt;/h3&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;go&quot;&gt;&lt;pre class=&quot;language-go&quot;&gt;&lt;code class=&quot;language-go&quot;&gt;&lt;span class=&quot;token comment&quot;&gt;// makemap() 부분 4&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;if&lt;/span&gt; h&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;B &lt;span class=&quot;token operator&quot;&gt;!=&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;0&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
	&lt;span class=&quot;token keyword&quot;&gt;var&lt;/span&gt; nextOverflow &lt;span class=&quot;token operator&quot;&gt;*&lt;/span&gt;bmap
	h&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;buckets&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; nextOverflow &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;makeBucketArray&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;t&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; h&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;B&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token boolean&quot;&gt;nil&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
	&lt;span class=&quot;token keyword&quot;&gt;if&lt;/span&gt; nextOverflow &lt;span class=&quot;token operator&quot;&gt;!=&lt;/span&gt; &lt;span class=&quot;token boolean&quot;&gt;nil&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
		h&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;extra &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;new&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;mapextra&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
		h&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;extra&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;nextOverflow &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; nextOverflow
	&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;
&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;return&lt;/span&gt; h&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;마지막 부분에서는 버킷 array를 생성하고 맵에 할당하는 과정이 포함되어 있다.&lt;/p&gt;
&lt;p&gt;만약 위에서 &lt;code class=&quot;language-text&quot;&gt;B&lt;/code&gt;값이 0으로 정해진다면 여기서 버킷 array를 생성하지 않고, 값을 넣는 &lt;code class=&quot;language-text&quot;&gt;mapassign()&lt;/code&gt; 과정에서 버킷을 생성한다고 한다. (lazy allocate)
&lt;br&gt;&lt;/p&gt;
&lt;p&gt;&lt;code class=&quot;language-text&quot;&gt;makemap()&lt;/code&gt; 함수에 파라미터로 받았던 &lt;code class=&quot;language-text&quot;&gt;t *maptype&lt;/code&gt;, 위에서 계산했던 &lt;code class=&quot;language-text&quot;&gt;B&lt;/code&gt;값을 &lt;code class=&quot;language-text&quot;&gt;makeBucketArray()&lt;/code&gt; 함수에 넣으면, 해당 함수에서 버킷 사이즈를 계산하여 메모리를 할당하고 반환해준다.&lt;/p&gt;
&lt;br&gt;
&lt;p&gt;&lt;code class=&quot;language-text&quot;&gt;makeBucketArray()&lt;/code&gt; 함수에서 주목할 점은 버킷 개수가 충분히 클 때(&lt;span class=&quot;katex&quot;&gt;&lt;span class=&quot;katex-mathml&quot;&gt;&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;semantics&gt;&lt;mrow&gt;&lt;mi&gt;B&lt;/mi&gt;&lt;mo&gt;≥&lt;/mo&gt;&lt;mn&gt;4&lt;/mn&gt;&lt;/mrow&gt;&lt;annotation encoding=&quot;application/x-tex&quot;&gt;B \ge 4&lt;/annotation&gt;&lt;/semantics&gt;&lt;/math&gt;&lt;/span&gt;&lt;span class=&quot;katex-html&quot; aria-hidden=&quot;true&quot;&gt;&lt;span class=&quot;base&quot;&gt;&lt;span class=&quot;strut&quot; style=&quot;height:0.8193em;vertical-align:-0.13597em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;mord mathdefault&quot; style=&quot;margin-right:0.05017em;&quot;&gt;B&lt;/span&gt;&lt;span class=&quot;mspace&quot; style=&quot;margin-right:0.2777777777777778em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;mrel&quot;&gt;≥&lt;/span&gt;&lt;span class=&quot;mspace&quot; style=&quot;margin-right:0.2777777777777778em;&quot;&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;base&quot;&gt;&lt;span class=&quot;strut&quot; style=&quot;height:0.64444em;vertical-align:0em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;mord&quot;&gt;4&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;) 미리 overflow 버킷을 할당해둔다는 것이다.&lt;/p&gt;
&lt;p&gt;또한 해당 함수에서 &lt;em&gt;bmap&lt;/em&gt;의 사이즈를 계산해서 메모리를 할당하는데, bmap struct 구현에는 필드가 tophash [8]uint8만 있지만 &lt;strong&gt;실제로는 8개의 키와 8개의 밸류를 담을 공간까지 계산&lt;/strong&gt;하여 메모리를 할당한다.&lt;/p&gt;
&lt;br&gt;
&lt;h2 id=&quot;4-mapaccess--맵에-접근하기&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#4-mapaccess--%EB%A7%B5%EC%97%90-%EC%A0%91%EA%B7%BC%ED%95%98%EA%B8%B0&quot; aria-label=&quot;4 mapaccess  맵에 접근하기 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;4. &lt;em&gt;mapaccess()&lt;/em&gt; :: 맵에 접근하기&lt;/h2&gt;
&lt;p&gt;2016년 GopherCon에서 Keith Randall은 다음과 같이 설명했다. [2]&lt;/p&gt;
&lt;p&gt;Generic이 존재하는 다른 언어 같은 경우 맵에서 특정 키에 대한 값을 갖고오고자 할 때(lookup), &lt;code class=&quot;language-text&quot;&gt;v = m[k]&lt;/code&gt; 코드는 다음과 같이 컴파일 될 것이다.&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;go&quot;&gt;&lt;pre class=&quot;language-go&quot;&gt;&lt;code class=&quot;language-go&quot;&gt;&lt;span class=&quot;token comment&quot;&gt;// lookup&lt;/span&gt;
v &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; m&lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;k&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;

&lt;span class=&quot;token comment&quot;&gt;// compiles to&lt;/span&gt;
v &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; runtime&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;lookup&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;m&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; k&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;token comment&quot;&gt;// where the runtime has the function&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;func&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;&amp;lt;&lt;/span&gt;K&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; V&lt;span class=&quot;token operator&quot;&gt;&gt;&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;lookup&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;m &lt;span class=&quot;token keyword&quot;&gt;map&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;K&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;V&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; k K&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; V&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;그러나 Go에는 generic이 없으니 (1.18 이전) 위와 같은 개념과는 다르게 런타임을 구현해야했다.
(Generic이 도입된 1.18에도 런타임에서 맵의 구현은 변경되지 않았다.)&lt;/p&gt;
&lt;p&gt;런타임에서 generic 타입의 값을 가질 수 없으니 &lt;code class=&quot;language-text&quot;&gt;unsafe.Pointer&lt;/code&gt;를 사용해서 런타임에 키에 대한 정보를 얻을 수 있도록 구현했다.&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;go&quot;&gt;&lt;pre class=&quot;language-go&quot;&gt;&lt;code class=&quot;language-go&quot;&gt;&lt;span class=&quot;token comment&quot;&gt;// lookup&lt;/span&gt;
v &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; m&lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;k&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;

&lt;span class=&quot;token comment&quot;&gt;// compiles to&lt;/span&gt;
pk &lt;span class=&quot;token operator&quot;&gt;:=&lt;/span&gt; unsafe&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;Pointer&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;&amp;amp;&lt;/span&gt;k&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
pv &lt;span class=&quot;token operator&quot;&gt;:=&lt;/span&gt; runtime&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;lookup&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;typeOf&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;m&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; m&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; pk&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
v &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;*&lt;/span&gt;V&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;pv

&lt;span class=&quot;token comment&quot;&gt;// where the runtime has the function&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;func&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;lookup&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;t &lt;span class=&quot;token operator&quot;&gt;*&lt;/span&gt;mapType&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; m &lt;span class=&quot;token operator&quot;&gt;*&lt;/span&gt;mapHeader&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; k unsafe&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;Pointer&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; unsafe&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;Pointer&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;특정 타입에 대해 따로 구현되어 있는 lookup 함수를 호출하는 대신, 단일로 존재하는 lookup 함수에 맵 타입, 헤더, 그리고 키에 대한 포인터를 파라미터로 입력함으로써 값에 대해 접근한다.&lt;/p&gt;
&lt;p&gt;키가 어떤 타입인지 런타임에 알 수 있으므로 파라미터에 키(k)가 unsafe.Pointer로 설정되어 있다.&lt;/p&gt;
&lt;br&gt;
&lt;p&gt;실제 &lt;code class=&quot;language-text&quot;&gt;map.go&lt;/code&gt; 파일에는 맵 접근 함수가 리턴 타입에 따라 여러 버전으로 구현되어 있다.&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;go&quot;&gt;&lt;pre class=&quot;language-go&quot;&gt;&lt;code class=&quot;language-go&quot;&gt;&lt;span class=&quot;token comment&quot;&gt;// elem에 대한 포인터를 반환&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;func&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;mapaccess1&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;t &lt;span class=&quot;token operator&quot;&gt;*&lt;/span&gt;maptype&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; h &lt;span class=&quot;token operator&quot;&gt;*&lt;/span&gt;hmap&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; key unsafe&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;Pointer&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; unsafe&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;Pointer

&lt;span class=&quot;token comment&quot;&gt;// key가 존재하는지에 대한 불린 값도 반환&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;func&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;mapaccess2&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;t &lt;span class=&quot;token operator&quot;&gt;*&lt;/span&gt;maptype&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; h &lt;span class=&quot;token operator&quot;&gt;*&lt;/span&gt;hmap&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; key unsafe&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;Pointer&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;unsafe&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;Pointer&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token builtin&quot;&gt;bool&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;token comment&quot;&gt;// key와 elem 모두 map iterator를 이용하여 반환&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;func&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;mapaccessK&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;t &lt;span class=&quot;token operator&quot;&gt;*&lt;/span&gt;maptype&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; h &lt;span class=&quot;token operator&quot;&gt;*&lt;/span&gt;hmap&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; key unsafe&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;Pointer&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;unsafe&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;Pointer&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; unsafe&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;Pointer&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;계획으로는 &lt;code class=&quot;language-text&quot;&gt;mapaccess1()&lt;/code&gt; 코드를 하나하나 살펴보려 했으나, 전문을 살펴보기에 코드가 조금 길어서 16년 GopherCon에서 발표한 자료[2]를 토대로 살펴보고자 한다.&lt;/p&gt;
&lt;p&gt;해당 자료는 pseudo code 느낌이 나기는 하지만 실제 구현에서 중요한 부분을 충실하게 담고 있기 때문에 이해에는 큰 문제가 없을 것이라 생각한다.&lt;/p&gt;
&lt;p&gt;&lt;em&gt;lookup&lt;/em&gt;을 &lt;code class=&quot;language-text&quot;&gt;mapaccess&lt;/code&gt;로, &lt;em&gt;mapHeader&lt;/em&gt;를 &lt;code class=&quot;language-text&quot;&gt;hmap&lt;/code&gt;으로, &lt;em&gt;bucket&lt;/em&gt;을 &lt;code class=&quot;language-text&quot;&gt;bmap&lt;/code&gt;으로 바꿔서 봐도 무방하다.&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;go&quot;&gt;&lt;pre class=&quot;language-go&quot;&gt;&lt;code class=&quot;language-go&quot;&gt;&lt;span class=&quot;token comment&quot;&gt;// lookup looks up a key in a map and returns a pointer to the associated value.&lt;/span&gt;
&lt;span class=&quot;token comment&quot;&gt;// t = type of the map&lt;/span&gt;
&lt;span class=&quot;token comment&quot;&gt;// m = map&lt;/span&gt;
&lt;span class=&quot;token comment&quot;&gt;// key = pointer to key&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;func&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;lookup&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;t&lt;span class=&quot;token operator&quot;&gt;*&lt;/span&gt; mapType&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; m &lt;span class=&quot;token operator&quot;&gt;*&lt;/span&gt;mapHeader&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; key unsafe&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;Pointer&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; unsafe&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;Pointer &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
	&lt;span class=&quot;token keyword&quot;&gt;if&lt;/span&gt; m &lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt; &lt;span class=&quot;token boolean&quot;&gt;nil&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;||&lt;/span&gt; m&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;count &lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;0&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
		&lt;span class=&quot;token keyword&quot;&gt;return&lt;/span&gt; zero
	&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;

	hash &lt;span class=&quot;token operator&quot;&gt;:=&lt;/span&gt; t&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;key&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;hash&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;key&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; m&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;seed&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token comment&quot;&gt;// hash := hashfn(key)&lt;/span&gt;
	bucket &lt;span class=&quot;token operator&quot;&gt;:=&lt;/span&gt; hash &lt;span class=&quot;token operator&quot;&gt;&amp;amp;&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;1&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;&amp;lt;&amp;lt;&lt;/span&gt; m&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;log B&lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token comment&quot;&gt;// bucket := hash % nbuckets&lt;/span&gt;
	extra &lt;span class=&quot;token operator&quot;&gt;:=&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;byte&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;hash &lt;span class=&quot;token operator&quot;&gt;&gt;&gt;&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;56&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token comment&quot;&gt;// extra := top 8 bits of hash&lt;/span&gt;
	b &lt;span class=&quot;token operator&quot;&gt;:=&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;bucket&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;add&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;m&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;buckets&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; bucket&lt;span class=&quot;token operator&quot;&gt;*&lt;/span&gt;t&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;bucketsize&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token comment&quot;&gt;// b := &amp;amp;m.buckets[bucket]&lt;/span&gt;

bucketloop&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
	&lt;span class=&quot;token keyword&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt; b &lt;span class=&quot;token operator&quot;&gt;!=&lt;/span&gt; &lt;span class=&quot;token boolean&quot;&gt;nil&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt; b &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; b&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;overflow &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
		&lt;span class=&quot;token keyword&quot;&gt;for&lt;/span&gt; i &lt;span class=&quot;token operator&quot;&gt;:=&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt; i &lt;span class=&quot;token operator&quot;&gt;&amp;lt;&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;8&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt; i&lt;span class=&quot;token operator&quot;&gt;++&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
		&lt;span class=&quot;token keyword&quot;&gt;if&lt;/span&gt; b&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;extra&lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;i&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;!=&lt;/span&gt; extra &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt; &lt;span class=&quot;token comment&quot;&gt;// check 8 extra hash bits&lt;/span&gt;
			&lt;span class=&quot;token keyword&quot;&gt;continue&lt;/span&gt;
		&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;
	
		k &lt;span class=&quot;token operator&quot;&gt;:=&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;add&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;b&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; dataOffset &lt;span class=&quot;token operator&quot;&gt;+&lt;/span&gt; i&lt;span class=&quot;token operator&quot;&gt;*&lt;/span&gt;t&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;keysize&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
		&lt;span class=&quot;token keyword&quot;&gt;if&lt;/span&gt; t&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;key&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;equal&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;key&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; k&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
			&lt;span class=&quot;token comment&quot;&gt;// return pointer to value_i&lt;/span&gt;
			&lt;span class=&quot;token keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;add&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;b&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; dataOffset &lt;span class=&quot;token operator&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;8&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;*&lt;/span&gt;t&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;keysize &lt;span class=&quot;token operator&quot;&gt;+&lt;/span&gt; i&lt;span class=&quot;token operator&quot;&gt;*&lt;/span&gt;t&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;valuesize&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
		&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;
	&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;
	&lt;span class=&quot;token keyword&quot;&gt;return&lt;/span&gt; zero
&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;br&gt;
&lt;h3 id=&quot;41-mapaccess---버킷-탐색&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#41-mapaccess---%EB%B2%84%ED%82%B7-%ED%83%90%EC%83%89&quot; aria-label=&quot;41 mapaccess   버킷 탐색 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;4.1. &lt;em&gt;mapaccess()&lt;/em&gt; - 버킷 탐색&lt;/h3&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;go&quot;&gt;&lt;pre class=&quot;language-go&quot;&gt;&lt;code class=&quot;language-go&quot;&gt;&lt;span class=&quot;token comment&quot;&gt;// mapaccess() 부분 1&lt;/span&gt;
hash &lt;span class=&quot;token operator&quot;&gt;:=&lt;/span&gt; t&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;key&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;hash&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;key&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; m&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;seed&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token comment&quot;&gt;// hash := hashfn(key)&lt;/span&gt;
bucket &lt;span class=&quot;token operator&quot;&gt;:=&lt;/span&gt; hash &lt;span class=&quot;token operator&quot;&gt;&amp;amp;&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;1&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;&amp;lt;&amp;lt;&lt;/span&gt; m&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;log B&lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token comment&quot;&gt;// bucket := hash % nbuckets&lt;/span&gt;
extra &lt;span class=&quot;token operator&quot;&gt;:=&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;byte&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;hash &lt;span class=&quot;token operator&quot;&gt;&gt;&gt;&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;56&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token comment&quot;&gt;// extra := top 8 bits of hash&lt;/span&gt;
b &lt;span class=&quot;token operator&quot;&gt;:=&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;bucket&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;add&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;m&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;buckets&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; bucket&lt;span class=&quot;token operator&quot;&gt;*&lt;/span&gt;t&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;bucketsize&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token comment&quot;&gt;// b := &amp;amp;m.buckets[bucket]&lt;/span&gt;
&lt;span class=&quot;token comment&quot;&gt;// ...&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;먼저 조회하고자 하는 키의 해시값을 계산하고 버킷의 개수와 모듈러 연산(%)을 하여 키가 위치한 버킷을 구한다. (해싱할 때 hmap 생성 시 설정했던 &lt;code class=&quot;language-text&quot;&gt;hash0&lt;/code&gt;이라는 랜덤 시드를 사용한다.)&lt;/p&gt;
&lt;p&gt;그리고 해시값의 최상위 8비트를 구하고 버킷의 주소를 가져온다.&lt;/p&gt;
&lt;p&gt;여기서 &lt;code class=&quot;language-text&quot;&gt;add(p, x)&lt;/code&gt; 함수는 &lt;code class=&quot;language-text&quot;&gt;runtime/stubs.go&lt;/code&gt; 파일에 포인터(p)를 x만큼 다음 주소로 옮기라는 의미로 구현되어 있다.&lt;/p&gt;
&lt;br&gt;
&lt;h3 id=&quot;42-mapaccess---키-탐색&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#42-mapaccess---%ED%82%A4-%ED%83%90%EC%83%89&quot; aria-label=&quot;42 mapaccess   키 탐색 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;4.2. &lt;em&gt;mapaccess()&lt;/em&gt; - 키 탐색&lt;/h3&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;go&quot;&gt;&lt;pre class=&quot;language-go&quot;&gt;&lt;code class=&quot;language-go&quot;&gt;&lt;span class=&quot;token comment&quot;&gt;// mapaccess() 부분 2&lt;/span&gt;
bucketloop&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
	&lt;span class=&quot;token keyword&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt; b &lt;span class=&quot;token operator&quot;&gt;!=&lt;/span&gt; &lt;span class=&quot;token boolean&quot;&gt;nil&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt; b &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; b&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;overflow &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
		&lt;span class=&quot;token keyword&quot;&gt;for&lt;/span&gt; i &lt;span class=&quot;token operator&quot;&gt;:=&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt; i &lt;span class=&quot;token operator&quot;&gt;&amp;lt;&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;8&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt; i&lt;span class=&quot;token operator&quot;&gt;++&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
		&lt;span class=&quot;token keyword&quot;&gt;if&lt;/span&gt; b&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;extra&lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;i&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;!=&lt;/span&gt; extra &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt; &lt;span class=&quot;token comment&quot;&gt;// check 8 extra hash bits&lt;/span&gt;
			&lt;span class=&quot;token keyword&quot;&gt;continue&lt;/span&gt;
		&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;
	
		k &lt;span class=&quot;token operator&quot;&gt;:=&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;add&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;b&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; dataOffset &lt;span class=&quot;token operator&quot;&gt;+&lt;/span&gt; i&lt;span class=&quot;token operator&quot;&gt;*&lt;/span&gt;t&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;keysize&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
		&lt;span class=&quot;token keyword&quot;&gt;if&lt;/span&gt; t&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;key&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;equal&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;key&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; k&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
			&lt;span class=&quot;token comment&quot;&gt;// return pointer to value_i&lt;/span&gt;
			&lt;span class=&quot;token keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;add&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;b&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; dataOffset &lt;span class=&quot;token operator&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;8&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;*&lt;/span&gt;t&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;keysize &lt;span class=&quot;token operator&quot;&gt;+&lt;/span&gt; i&lt;span class=&quot;token operator&quot;&gt;*&lt;/span&gt;t&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;elemsize&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
		&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;
	&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;return&lt;/span&gt; zero&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;여기 &lt;code class=&quot;language-text&quot;&gt;bucketloop&lt;/code&gt;는 버킷 내부에서 키를 탐색하는 과정이다.&lt;/p&gt;
&lt;p&gt;찾고자하는 키의 해시값의 최상위 8비트를 b.extra 배열(실제로는 &lt;code class=&quot;language-text&quot;&gt;tophash&lt;/code&gt; 배열)에서 탐색하는데, &lt;strong&gt;버킷 내의 8개 슬롯에서 해당 키가 몇 번째 인덱스에 존재하는지&lt;/strong&gt; 결과를 얻게 된다.&lt;/p&gt;
&lt;p&gt;그리고 키가 존재하는지 한 번 더 확인 후 다음 과정을 통해 밸류(elem)에 접근하여 포인터를 반환한다.&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;span class=&quot;katex&quot;&gt;&lt;span class=&quot;katex-mathml&quot;&gt;&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;semantics&gt;&lt;mrow&gt;&lt;mi&gt;v&lt;/mi&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mi&gt;l&lt;/mi&gt;&lt;mi&gt;u&lt;/mi&gt;&lt;msub&gt;&lt;mi&gt;e&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mrow&gt;&lt;mi&gt;d&lt;/mi&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mi&gt;O&lt;/mi&gt;&lt;mi&gt;f&lt;/mi&gt;&lt;mi&gt;f&lt;/mi&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mi&gt;e&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/mrow&gt;&lt;mtext&gt; &lt;/mtext&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mtext&gt; &lt;/mtext&gt;&lt;mn&gt;8&lt;/mn&gt;&lt;mo&gt;∗&lt;/mo&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;mi&gt;e&lt;/mi&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;mi&gt;S&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mi&gt;z&lt;/mi&gt;&lt;mi&gt;e&lt;/mi&gt;&lt;mtext&gt; &lt;/mtext&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mtext&gt; &lt;/mtext&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mo&gt;∗&lt;/mo&gt;&lt;mi&gt;e&lt;/mi&gt;&lt;mi&gt;l&lt;/mi&gt;&lt;mi&gt;e&lt;/mi&gt;&lt;mi&gt;m&lt;/mi&gt;&lt;mi&gt;S&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mi&gt;z&lt;/mi&gt;&lt;mi&gt;e&lt;/mi&gt;&lt;/mrow&gt;&lt;annotation encoding=&quot;application/x-tex&quot;&gt;value_i = {dataOffset}\, +\, 8 * keySize\, +\, i*elemSize&lt;/annotation&gt;&lt;/semantics&gt;&lt;/math&gt;&lt;/span&gt;&lt;span class=&quot;katex-html&quot; aria-hidden=&quot;true&quot;&gt;&lt;span class=&quot;base&quot;&gt;&lt;span class=&quot;strut&quot; style=&quot;height:0.84444em;vertical-align:-0.15em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;mord mathdefault&quot; style=&quot;margin-right:0.03588em;&quot;&gt;v&lt;/span&gt;&lt;span class=&quot;mord mathdefault&quot;&gt;a&lt;/span&gt;&lt;span class=&quot;mord mathdefault&quot; style=&quot;margin-right:0.01968em;&quot;&gt;l&lt;/span&gt;&lt;span class=&quot;mord mathdefault&quot;&gt;u&lt;/span&gt;&lt;span class=&quot;mord&quot;&gt;&lt;span class=&quot;mord mathdefault&quot;&gt;e&lt;/span&gt;&lt;span class=&quot;msupsub&quot;&gt;&lt;span class=&quot;vlist-t vlist-t2&quot;&gt;&lt;span class=&quot;vlist-r&quot;&gt;&lt;span class=&quot;vlist&quot; style=&quot;height:0.31166399999999994em;&quot;&gt;&lt;span style=&quot;top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;&quot;&gt;&lt;span class=&quot;pstrut&quot; style=&quot;height:2.7em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;sizing reset-size6 size3 mtight&quot;&gt;&lt;span class=&quot;mord mathdefault mtight&quot;&gt;i&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;vlist-s&quot;&gt;​&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;vlist-r&quot;&gt;&lt;span class=&quot;vlist&quot; style=&quot;height:0.15em;&quot;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;mspace&quot; style=&quot;margin-right:0.2777777777777778em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;mrel&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mspace&quot; style=&quot;margin-right:0.2777777777777778em;&quot;&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;base&quot;&gt;&lt;span class=&quot;strut&quot; style=&quot;height:0.8888799999999999em;vertical-align:-0.19444em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;mord&quot;&gt;&lt;span class=&quot;mord mathdefault&quot;&gt;d&lt;/span&gt;&lt;span class=&quot;mord mathdefault&quot;&gt;a&lt;/span&gt;&lt;span class=&quot;mord mathdefault&quot;&gt;t&lt;/span&gt;&lt;span class=&quot;mord mathdefault&quot;&gt;a&lt;/span&gt;&lt;span class=&quot;mord mathdefault&quot; style=&quot;margin-right:0.02778em;&quot;&gt;O&lt;/span&gt;&lt;span class=&quot;mord mathdefault&quot; style=&quot;margin-right:0.10764em;&quot;&gt;f&lt;/span&gt;&lt;span class=&quot;mord mathdefault&quot; style=&quot;margin-right:0.10764em;&quot;&gt;f&lt;/span&gt;&lt;span class=&quot;mord mathdefault&quot;&gt;s&lt;/span&gt;&lt;span class=&quot;mord mathdefault&quot;&gt;e&lt;/span&gt;&lt;span class=&quot;mord mathdefault&quot;&gt;t&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;mspace&quot; style=&quot;margin-right:0.2222222222222222em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;mspace&quot; style=&quot;margin-right:0.16666666666666666em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;mbin&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;mspace&quot; style=&quot;margin-right:0.2222222222222222em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;mspace&quot; style=&quot;margin-right:0.16666666666666666em;&quot;&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;base&quot;&gt;&lt;span class=&quot;strut&quot; style=&quot;height:0.64444em;vertical-align:0em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;mord&quot;&gt;8&lt;/span&gt;&lt;span class=&quot;mspace&quot; style=&quot;margin-right:0.2222222222222222em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;mbin&quot;&gt;∗&lt;/span&gt;&lt;span class=&quot;mspace&quot; style=&quot;margin-right:0.2222222222222222em;&quot;&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;base&quot;&gt;&lt;span class=&quot;strut&quot; style=&quot;height:0.8888799999999999em;vertical-align:-0.19444em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;mord mathdefault&quot; style=&quot;margin-right:0.03148em;&quot;&gt;k&lt;/span&gt;&lt;span class=&quot;mord mathdefault&quot;&gt;e&lt;/span&gt;&lt;span class=&quot;mord mathdefault&quot; style=&quot;margin-right:0.03588em;&quot;&gt;y&lt;/span&gt;&lt;span class=&quot;mord mathdefault&quot; style=&quot;margin-right:0.05764em;&quot;&gt;S&lt;/span&gt;&lt;span class=&quot;mord mathdefault&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;mord mathdefault&quot; style=&quot;margin-right:0.04398em;&quot;&gt;z&lt;/span&gt;&lt;span class=&quot;mord mathdefault&quot;&gt;e&lt;/span&gt;&lt;span class=&quot;mspace&quot; style=&quot;margin-right:0.2222222222222222em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;mspace&quot; style=&quot;margin-right:0.16666666666666666em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;mbin&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;mspace&quot; style=&quot;margin-right:0.2222222222222222em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;mspace&quot; style=&quot;margin-right:0.16666666666666666em;&quot;&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;base&quot;&gt;&lt;span class=&quot;strut&quot; style=&quot;height:0.65952em;vertical-align:0em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;mord mathdefault&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;mspace&quot; style=&quot;margin-right:0.2222222222222222em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;mbin&quot;&gt;∗&lt;/span&gt;&lt;span class=&quot;mspace&quot; style=&quot;margin-right:0.2222222222222222em;&quot;&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;base&quot;&gt;&lt;span class=&quot;strut&quot; style=&quot;height:0.69444em;vertical-align:0em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;mord mathdefault&quot;&gt;e&lt;/span&gt;&lt;span class=&quot;mord mathdefault&quot; style=&quot;margin-right:0.01968em;&quot;&gt;l&lt;/span&gt;&lt;span class=&quot;mord mathdefault&quot;&gt;e&lt;/span&gt;&lt;span class=&quot;mord mathdefault&quot;&gt;m&lt;/span&gt;&lt;span class=&quot;mord mathdefault&quot; style=&quot;margin-right:0.05764em;&quot;&gt;S&lt;/span&gt;&lt;span class=&quot;mord mathdefault&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;mord mathdefault&quot; style=&quot;margin-right:0.04398em;&quot;&gt;z&lt;/span&gt;&lt;span class=&quot;mord mathdefault&quot;&gt;e&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;br&gt;
&lt;p&gt;&lt;code class=&quot;language-text&quot;&gt;dataOffset&lt;/code&gt;은 map.go 상단에 다음과 같이 상수로 정의되어 있다.&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;go&quot;&gt;&lt;pre class=&quot;language-go&quot;&gt;&lt;code class=&quot;language-go&quot;&gt;dataOffset &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; unsafe&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;Offsetof&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token keyword&quot;&gt;struct&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
	b bmap
	v &lt;span class=&quot;token builtin&quot;&gt;int64&lt;/span&gt;
&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;v&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;이번 포스트의 1번 섹션에서 &lt;em&gt;bmap&lt;/em&gt;에는 tophash만 구현되어 있고 키와 밸류에 대한 정보가 없다고 소개한 바 있다.&lt;/p&gt;
&lt;p&gt;&lt;code class=&quot;language-text&quot;&gt;dataOffset&lt;/code&gt;이 bmap과 int64를 필드로 가지는 구조체에서 int64가 시작하는 위치의 오프셋을 가리키게 되므로, 키와 밸류에 대한 정보는 bmap 바깥에 저장된다는 것을 알 수 있다.&lt;/p&gt;
&lt;p&gt;&lt;span
      class=&quot;gatsby-resp-image-wrapper&quot;
      style=&quot;position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 1190px; &quot;
    &gt;
      &lt;span
    class=&quot;gatsby-resp-image-background-image&quot;
    style=&quot;padding-bottom: 33.33333333333333%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAHCAYAAAAIy204AAAACXBIWXMAAAsTAAALEwEAmpwYAAABFUlEQVQoz2VRa6uCQBTc//9XIoQw8kuBYBDhB5EgIlCQMkIT8pGPyrnMgXOReweGZc/OecxZ8/l8QIzjiO/3+0uiqiokSYL7/Y7r9Yqu6/7plKzDN0NR0zTo+16CwzAI3+832rbF8/mUwjypZXxK1b5eL8k3ZVkijmNkWSZF2YWkSCflXU+dUN+VzGXMpGkqF9LzPMznc6xWK7F5Op2w3+8RBAFmsxls24ZlWRKr61ri2+0W5/MZjuPIlOZ2u6EoCrHt+z6WyyVc10We5zgcDpJwPB6xWCywXq8lMQxD0BnjzOGeN5uN1DDcz263AwsrODqLXS4X+Qy1rHg8HjIdmxK0rKsw0x0ppr9GG1EUyQqmDVXzFz+E7RBw5h2DpQAAAABJRU5ErkJggg==&apos;); background-size: cover; display: block;&quot;
  &gt;&lt;/span&gt;
  &lt;img
        class=&quot;gatsby-resp-image-image&quot;
        alt=&quot;20220407 2&quot;
        title=&quot;20220407 2&quot;
        src=&quot;/static/9a7bdb56da0c936df31a0091eff9f4ec/393aa/20220407-2.png&quot;
        srcset=&quot;/static/9a7bdb56da0c936df31a0091eff9f4ec/5a46d/20220407-2.png 300w,
/static/9a7bdb56da0c936df31a0091eff9f4ec/0a47e/20220407-2.png 600w,
/static/9a7bdb56da0c936df31a0091eff9f4ec/393aa/20220407-2.png 1190w&quot;
        sizes=&quot;(max-width: 1190px) 100vw, 1190px&quot;
        style=&quot;width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;&quot;
        loading=&quot;lazy&quot;
      /&gt;
    &lt;/span&gt;&lt;/p&gt;
&lt;br&gt;
&lt;h2 id=&quot;5-mapassign--맵에-키-할당하기&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#5-mapassign--%EB%A7%B5%EC%97%90-%ED%82%A4-%ED%95%A0%EB%8B%B9%ED%95%98%EA%B8%B0&quot; aria-label=&quot;5 mapassign  맵에 키 할당하기 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;5. &lt;em&gt;mapassign()&lt;/em&gt; :: 맵에 키 할당하기&lt;/h2&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;go&quot;&gt;&lt;pre class=&quot;language-go&quot;&gt;&lt;code class=&quot;language-go&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;func&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;mapassign&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;t &lt;span class=&quot;token operator&quot;&gt;*&lt;/span&gt;maptype&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; h &lt;span class=&quot;token operator&quot;&gt;*&lt;/span&gt;hmap&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; key unsafe&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;Pointer&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; unsafe&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;Pointer&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;&lt;code class=&quot;language-text&quot;&gt;mapassign()&lt;/code&gt; 함수는 인풋 파라미터와 리턴 값이 &lt;code class=&quot;language-text&quot;&gt;mapaccess1()&lt;/code&gt;과 같고 수행하는 기능 또한 유사하다.&lt;/p&gt;
&lt;p&gt;다만 &lt;code class=&quot;language-text&quot;&gt;mapaccess1()&lt;/code&gt;이 현재 존재하는 키를 찾아 밸류를 포인터로 돌려줬다면, &lt;code class=&quot;language-text&quot;&gt;mapassign()&lt;/code&gt;은 키가 존재할 경우 밸류에 대한 포인터를 돌려주고 &lt;strong&gt;키가 존재하지 않을 경우 버킷에 슬롯을 할당하는 과정이 추가&lt;/strong&gt;되어 있다.&lt;/p&gt;
&lt;p&gt;또한 슬롯을 추가하기 전에 현재 맵이 Load Factor에 도달했거나 overflow 버킷이 너무 많을 경우 &lt;strong&gt;growing을 시작하는 과정을 포함&lt;/strong&gt;한다.&lt;/p&gt;
&lt;br&gt;
&lt;p&gt;이전에 &lt;em&gt;bmap&lt;/em&gt;과 mapaccess 과정을 살펴볼 때 Go에서의 해시테이블은 Linked List가 아니라 버킷마다 8개의 슬롯을 가진 Array를 미리 할당하여 chaining을 구현한다고 소개했다.&lt;/p&gt;
&lt;p&gt;따라서 새로운 키를 할당할 시, 해시 충돌이 발생하여 같은 버킷에 키가 할당될 경우 mapassign() 함수는 mapaccess()와 마찬가지로 &lt;strong&gt;버킷 내부 Array를 선형 탐색하다 빈 슬롯에 단순히 키를 할당&lt;/strong&gt;하는 방법을 사용한다.&lt;/p&gt;
&lt;p&gt;키를 할당하고 밸류가 들어갈 슬롯의 주소를 가리키는 포인터를 리턴하여 키를 할당하는 과정이 완료된다.&lt;/p&gt;
&lt;br&gt;
&lt;p&gt;Java와 같이 링크드 리스트, 혹은 트리로 chaining이 구현되었다면 버킷에 키를 할당하는 과정이 보다 더 복잡했을 것이다.&lt;/p&gt;
&lt;p&gt;그러나 Go는 포인터 연산과 비트 연산이 언어 차원에서 지원되므로, &lt;strong&gt;미리 할당해둔 배열에 빈 공간(슬롯)을 찾아 값을 넣기만 하면 할당이 완료&lt;/strong&gt;된다.&lt;/p&gt;
&lt;br&gt;
&lt;h2 id=&quot;마무리&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#%EB%A7%88%EB%AC%B4%EB%A6%AC&quot; aria-label=&quot;마무리 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;마무리&lt;/h2&gt;
&lt;p&gt;이번 포스팅에서는 Go의 해시 테이블 구현에 대해 코드 기반으로 살펴보았다.&lt;/p&gt;
&lt;p&gt;글이 너무 길어져 growing 과정이나 맵 순회에 대해서는 다음 포스팅에서 다루고자 한다.&lt;/p&gt;
&lt;br&gt;
&lt;p&gt;&lt;strong&gt;References&lt;/strong&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href=&quot;https://github.com/golang/go/blob/master/src/runtime/map.go&quot;&gt;golang/go :: src/runtime/map.go&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://medium.com/kalamsilicon/hash-tables-implementation-in-go-48c165c54553&quot;&gt;Hash Tables Implementation in Go&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://utcc.utoronto.ca/~cks/space/blog/programming/GoUintptrVsUnsafePointer&quot;&gt;Why Go cares about the difference between unsafe.Pointer and uintptr&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://dave.cheney.net/2018/05/29/how-the-go-runtime-implements-maps-efficiently-without-generics&quot;&gt;How the Go runtime implements maps efficiently (without generics)&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;br&gt;
&lt;ul&gt;
&lt;li&gt;[1] &lt;a href=&quot;https://github.com/golang/go/blob/23756207fb68c34ae15a030319dc31248e21cf45/src/runtime/malloc.go#L225&quot;&gt;golang/go :: src/runtime/malloc.go&lt;/a&gt; (accessed on 2022/04/06)&lt;/li&gt;
&lt;li&gt;[2] &lt;a href=&quot;https://youtu.be/Tl7mi9QmLns&quot;&gt;Keith Randall, “Inside the Map Implementation”, GopherCon 2016.&lt;/a&gt; (&lt;a href=&quot;https://docs.google.com/presentation/d/1CxamWsvHReswNZc7N2HMV7WPFqS8pvlPVZcDegdC_T4/edit#slide=id.g15413b4d29_0_6&quot;&gt;slide&lt;/a&gt;)&lt;/li&gt;
&lt;/ul&gt;</content:encoded></item><item><title><![CDATA[쿠버네티스 서비스 2 | 쿲벖넶팂슶 Ep.4]]></title><description><![CDATA[이 포스팅은 Marko Lukša의 Kubernetes in Action (1st edition)에서 Chapter 5. Services: Enabling Clients to Discover and Talk to Pods…]]></description><link>https://blog.frec.kr/cloud/service_2/</link><guid isPermaLink="false">https://blog.frec.kr/cloud/service_2/</guid><pubDate>Thu, 29 Jul 2021 02:13:00 GMT</pubDate><content:encoded>&lt;p&gt;이 포스팅은 Marko Lukša의 Kubernetes in Action (1st edition)에서 &lt;em&gt;Chapter 5. Services: Enabling Clients to Discover and Talk to Pods&lt;/em&gt;를 기반으로 재구성하였습니다.&lt;/p&gt;
&lt;p&gt;서비스에 관련된 내용은 총 3편의 시리즈로 포스팅할 예정입니다.&lt;/p&gt;
&lt;h2 id=&quot;들어가기-전에&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#%EB%93%A4%EC%96%B4%EA%B0%80%EA%B8%B0-%EC%A0%84%EC%97%90&quot; aria-label=&quot;들어가기 전에 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;들어가기 전에&lt;/h2&gt;
&lt;p&gt;지난 포스팅에서는 서비스라는 리소스에 대해 간략하게 알아봤고 가장 기본적인 서비스인 ClusterIP 타입의 서비스를 예시로 들었다. 다만 이 ClusterIP 타입은 이름에서도 알 수 있듯이 클러스터의 IP를 할당받는다. 다시 말하면, 서비스를 생성했는데 &lt;strong&gt;이 서비스는 클러스터 내부에서만 접속이 가능&lt;/strong&gt;하다는 의미이다.&lt;/p&gt;
&lt;p&gt;지난 포스팅에서 소개했던 서비스의 사용 예시 중에 웹 서비스 예시가 있었다. 웹 프론트엔드 파드가 있었고 이 파드들은 API 서버를 구동 중인 백엔드 파드에 요청을 하는 구조였다. 이 API 서버 파드들을 클러스터 내부에서 사용하기 위해서 ClusterIP 타입의 서비스를 통해 노출하는 것은 적절했다.&lt;/p&gt;
&lt;p&gt;&lt;span
      class=&quot;gatsby-resp-image-wrapper&quot;
      style=&quot;position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 886px; &quot;
    &gt;
      &lt;span
    class=&quot;gatsby-resp-image-background-image&quot;
    style=&quot;padding-bottom: 65.66666666666667%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAANCAYAAACpUE5eAAAACXBIWXMAAAsTAAALEwEAmpwYAAACDUlEQVQ4y4VT227aQBD1f7ef0D70rapKL89RH1JVCVGSBtImBhJoREsoEG7lEhvbgeALtnfXp7PLpYBQutJo7ZnROWeOxxq2DuMcURSB0XMsErAopJxAHMcIwxlFqIIxDt/3Yds2HMeBZVlwXRfa0Gmi3M7gV/c7qn0d7sSGILDw7BB+6hWE4BAswvRxjNFoCMPoYzy2CDBGkiSKaBmSSOuYFWRu9pC9+YR87QsejDZCAnBfPof74hlmPEZgDTAlIsu6x8ik5+kYURwpwPUjQbXtkbkQSCj4bIbA8+fsZIO8gyBQY0lLliFVyZo88l1LkCgmFZQUnOGi+Qep8wLenedxULlTzYXOAKlsHh+yBXwu11Wu1DPwNpND6uwS+z/r8IhQW4Et5DNiuzMs6LWmisrAJAUR2paDQr2N42IOV50uOGPo2g/Q6y1cVhso9+7h0UdajbwElPIFNZNUhL4HRl9WjsmjGIbdRb56hIjs8DxP3UJ6ydZG3gZkBCbEfHzpp5CeLmqeN8F41F/5LdfGNE3Y62uzG1DgX35+N5pDHJ78wNFJCbliA8EslFWlamNtngJc9/abfovX79N48zGNvX0dk0dve0E21+Z/gPLPMK0JBkOHdjDeqC97nvBwHXBeb3VMnGaL+Jq9RqncUj5vk+5UKJOcFnnZKBb521oPB8dXSJ9e46Lwm3rEToV/Afdy4Kpv0TqnAAAAAElFTkSuQmCC&apos;); background-size: cover; display: block;&quot;
  &gt;&lt;/span&gt;
  &lt;img
        class=&quot;gatsby-resp-image-image&quot;
        alt=&quot;20210729 1&quot;
        title=&quot;20210729 1&quot;
        src=&quot;/static/ec05e81a97b54d87c501e968b17e21ba/cc155/20210729-1.png&quot;
        srcset=&quot;/static/ec05e81a97b54d87c501e968b17e21ba/5a46d/20210729-1.png 300w,
/static/ec05e81a97b54d87c501e968b17e21ba/0a47e/20210729-1.png 600w,
/static/ec05e81a97b54d87c501e968b17e21ba/cc155/20210729-1.png 886w&quot;
        sizes=&quot;(max-width: 886px) 100vw, 886px&quot;
        style=&quot;width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;&quot;
        loading=&quot;lazy&quot;
      /&gt;
    &lt;/span&gt;&lt;/p&gt;
&lt;p&gt;다만 웹 프론트엔드 서비스는 외부에서 클라이언트가 접근해야 할텐데, &lt;strong&gt;ClusterIP 타입 서비스로는 클러스터 외부로 노출할 수 없다&lt;/strong&gt;는 단점이 있다. 다행히도 &lt;em&gt;NodePort&lt;/em&gt; 타입, &lt;em&gt;LoadBalancer&lt;/em&gt; 타입 서비스는 클러스터 외부로 노출이 가능하다.&lt;/p&gt;
&lt;p&gt;따라서 이번 포스팅에서는 두 가지 타입의 서비스를 소개하고자 하고, 그 전에 서비스를 구성하는 &lt;strong&gt;&lt;em&gt;엔드포인트(Endpoints)&lt;/em&gt;&lt;/strong&gt;라는 리소스와 그 확장 버전인 &lt;strong&gt;&lt;em&gt;엔드포인트슬라이스(EndpointSlice)&lt;/em&gt;&lt;/strong&gt;에 대해 먼저 간단히 소개한다.&lt;/p&gt;
&lt;h2 id=&quot;4-endpoints-리소스&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#4-endpoints-%EB%A6%AC%EC%86%8C%EC%8A%A4&quot; aria-label=&quot;4 endpoints 리소스 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;4. Endpoints 리소스&lt;/h2&gt;
&lt;p&gt;서비스와 파드는 우리가 생각하는 것처럼 직접 연결되어 있는 구조가 아니라, 실제로는 그 사이에 엔드포인트 리소스가 위치해서 관리한다고 한다.&lt;/p&gt;
&lt;p&gt;&lt;span
      class=&quot;gatsby-resp-image-wrapper&quot;
      style=&quot;position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 872px; &quot;
    &gt;
      &lt;span
    class=&quot;gatsby-resp-image-background-image&quot;
    style=&quot;padding-bottom: 35.333333333333336%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAHCAYAAAAIy204AAAACXBIWXMAAAsTAAALEwEAmpwYAAABbElEQVQoz3WRT2+bQBDF+f5foLdeeqtUNYrTQw+RqlZpm1DbUGNbdixs/mPAAQwkmMD+shAlUqX0SaO382Z35u2uMpo4nI8tPt3s+PjbZDSxGU2dIe/5QnP5OvP4ontc6D7nU4/PY5ezsSPD5sOVyfvvG95drvm2DFHiKOKQJJTFkSSOOebZkO/DACE6XtCcarI0Hep5liK6lregbLdbXNelaZpXcS+HOI4zrIUQA2dZhqZpzGYGhmFQ16dB94MA0zTZ7ayhh2JbFoEU27Z9PRxLp5vNhjzPh7yvlUXBerXC931Op+dmXdcNmqqqzOdzOaRGieKETvxrOz8WuJ5HEO453KV0vI1OGojk8yyWSyxprB+khD8uSSbXVAud5naB2N2SzybEf35RGFMi9SfV8i/lXJOsc5S1nvv99dog11Ua2+RRun3srxxuTez1ijTwqQ4JbVVwf3eglg/Pwz3ioaKryv9GWxYI+WEveAIJEQrh/G7H8wAAAABJRU5ErkJggg==&apos;); background-size: cover; display: block;&quot;
  &gt;&lt;/span&gt;
  &lt;img
        class=&quot;gatsby-resp-image-image&quot;
        alt=&quot;20210729 2&quot;
        title=&quot;20210729 2&quot;
        src=&quot;/static/aae4a53d86ae38ad4e2d5ddcacf2a124/65654/20210729-2.png&quot;
        srcset=&quot;/static/aae4a53d86ae38ad4e2d5ddcacf2a124/5a46d/20210729-2.png 300w,
/static/aae4a53d86ae38ad4e2d5ddcacf2a124/0a47e/20210729-2.png 600w,
/static/aae4a53d86ae38ad4e2d5ddcacf2a124/65654/20210729-2.png 872w&quot;
        sizes=&quot;(max-width: 872px) 100vw, 872px&quot;
        style=&quot;width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;&quot;
        loading=&quot;lazy&quot;
      /&gt;
    &lt;/span&gt;&lt;/p&gt;
&lt;p&gt;책에서 생성한 서비스를 &lt;code class=&quot;language-text&quot;&gt;kubectl describe&lt;/code&gt; 명령을 통해 확인한 예시이다. 서비스 하위에 Endpoints라는 항목이 &lt;strong&gt;서비스와 연결된 파드들의 IP와 포트를 리스트 형태&lt;/strong&gt;로 가지고 있다. 쿠버네티스는 서비스에 요청이 들어오면 이 엔드포인트 중 하나로 리다이렉트한다.&lt;/p&gt;
&lt;p&gt;쿠버네티스에서는 서비스와 엔드포인트의 연결 관리를 프록시 모듈에서 수행하고 있다. (&lt;code class=&quot;language-text&quot;&gt;/pkg/proxy/endpoints.go&lt;/code&gt;)&lt;/p&gt;
&lt;h2 id=&quot;5-endpointslice-리소스&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#5-endpointslice-%EB%A6%AC%EC%86%8C%EC%8A%A4&quot; aria-label=&quot;5 endpointslice 리소스 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;5. EndpointSlice 리소스&lt;/h2&gt;
&lt;p&gt;엔드포인트 리소스는 위에서 언급한대로 서비스와 연결된 파드의 IP, 포트를 가지고 있다. 다만 쿠버네티스 클러스터에서 서비스가 초창기 설계보다 더 많은 수의 파드로 더 많은 트래픽을 전송하는 방향으로 성장함에 따라, 엔드포인트 리소스가 처리할 수 있는 한계에 도달했다고 한다. [1]&lt;/p&gt;
&lt;p&gt;서비스에 연결된 모든 네트워크 엔드포인트가 한 엔드포인트 리소스에 연결되다보니 엔드포인트가 변경될 때 성능에 큰 영향을 미쳤다고 공식 문서에서 표현하고 있다.&lt;/p&gt;
&lt;p&gt;엔드포인트슬라이스는 &lt;strong&gt;기존의 엔드포인트를 포함&lt;/strong&gt;하는 형태로 한 단계 더 추상화된 리소스이다. 기본적으로 엔드포인트슬라이스는 각각 100개 이하의 엔드포인트를 가지도록 관리된다.&lt;/p&gt;
&lt;h2 id=&quot;6-nodeport-타입-서비스&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#6-nodeport-%ED%83%80%EC%9E%85-%EC%84%9C%EB%B9%84%EC%8A%A4&quot; aria-label=&quot;6 nodeport 타입 서비스 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;6. NodePort 타입 서비스&lt;/h2&gt;
&lt;p&gt;이제 NodePort 타입의 서비스를 이용해서 클러스터 외부로 서비스 리소스를 노출하는 방법에 대해 알아보고자 한다. &lt;/p&gt;
&lt;p&gt;NodePort 타입은 기본형 서비스였던 &lt;strong&gt;ClusterIP 타입 서비스를 기반&lt;/strong&gt;으로 하고 있다. ClusterIP 타입 서비스가 생성되고 이 서비스를 노드(Node)의 특정한 포트와 연결한다. 예시로, NodePort를 30123으로 설정한다면 &lt;strong&gt;클러스터를 구성하고 있는 모든 노드&lt;/strong&gt;의 30123 포트와 서비스가 연결된다.&lt;/p&gt;
&lt;p&gt;&lt;span
      class=&quot;gatsby-resp-image-wrapper&quot;
      style=&quot;position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 900px; &quot;
    &gt;
      &lt;span
    class=&quot;gatsby-resp-image-background-image&quot;
    style=&quot;padding-bottom: 41%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAICAYAAAD5nd/tAAAACXBIWXMAAAsTAAALEwEAmpwYAAABUUlEQVQoz4WR/UrDMBTF+/7vIPgAguCUTUFw+J9Oi3Nzg7br+pmka7pu1X53xyTCYGjxwiHh3uR3z0200TvBcBriVqwXzy6uXj0MdA+XE1fkA8j6/QfDUKx3sxDXuo+RyMvaQOzPHy2ls7Gp7mg8jsE3EbYJR1UWOInDARGjCANfqWsb/BcaoQy24yLiHHlVIS9KlGWpim3bghACSimCIEAl6sdeqt/hl7QtCZH6DjJGsA88pBFDWdXKXdd1yPMcruvCcRxYlgXbtpGmqWqGP6AaWeowxjdgsyfQyQMyauOryRWsaRrUdQ0u3EuHYRgqMcb6gclnAp8SbHiiRi7KCnHKxEg/ByS4KAqsVius12ssl0vE4t3RN3Ky3+Bt/oLpXIdPHNieqYASJF2ZpqlkGMZxLy/2AqX1KIrAxS9nWXbyYxK4WCyOoCRJsNvtVLM+4Dfi3Vy6rF4GPAAAAABJRU5ErkJggg==&apos;); background-size: cover; display: block;&quot;
  &gt;&lt;/span&gt;
  &lt;img
        class=&quot;gatsby-resp-image-image&quot;
        alt=&quot;20210729 3&quot;
        title=&quot;20210729 3&quot;
        src=&quot;/static/59acd0a185844d5efdbf26e99db602f0/1cfc2/20210729-3.png&quot;
        srcset=&quot;/static/59acd0a185844d5efdbf26e99db602f0/5a46d/20210729-3.png 300w,
/static/59acd0a185844d5efdbf26e99db602f0/0a47e/20210729-3.png 600w,
/static/59acd0a185844d5efdbf26e99db602f0/1cfc2/20210729-3.png 900w&quot;
        sizes=&quot;(max-width: 900px) 100vw, 900px&quot;
        style=&quot;width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;&quot;
        loading=&quot;lazy&quot;
      /&gt;
    &lt;/span&gt;&lt;/p&gt;
&lt;p&gt;책에서 제시하는 NodePort 타입 서비스의 YAML 파일 예시인데, 타입이 ClusterIP에서 NodePort로 설정된 것과, &lt;code class=&quot;language-text&quot;&gt;spec.ports&lt;/code&gt; 항목에서 &lt;code class=&quot;language-text&quot;&gt;nodePort&lt;/code&gt; 값이 추가된 것 정도가 변경된 점이다. 만약 &lt;code class=&quot;language-text&quot;&gt;nodePort&lt;/code&gt; 항목을 설정하지 않는다면 쿠버네티스가 &lt;strong&gt;30000-32767&lt;/strong&gt; 범위 내에서 자동으로 할당할 것이다. 이 범위는 &lt;em&gt;kube-apiserver&lt;/em&gt;의 설정을 바꿈으로써 변경할 수 있다. (방법에 대해서는 &lt;a href=&quot;https://blog.frec.kr/cloud/modify_nodeport_range/&quot;&gt;7월 23일 포스팅&lt;/a&gt;을 참고)&lt;/p&gt;
&lt;p&gt;위의 YAML 파일을 통해 생성된 NodePort 서비스로 요청이 들어올 경우, 연결된 파드로 라우팅되는 과정은 다음 그림과 같을 것이다.&lt;/p&gt;
&lt;p&gt;&lt;span
      class=&quot;gatsby-resp-image-wrapper&quot;
      style=&quot;position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 853px; &quot;
    &gt;
      &lt;span
    class=&quot;gatsby-resp-image-background-image&quot;
    style=&quot;padding-bottom: 77.33333333333333%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAPCAYAAADkmO9VAAAACXBIWXMAAAsTAAALEwEAmpwYAAAC10lEQVQ4y3WUyW7bQAyG/f5P0ALtLSiKHooutyJAgSCNEzuJ7cSy5E3raN9l2ZYsOX9JOQZyaAkREjDkRw7nH/Xquka136M9HDG3hrgcXeD3+DNu5G/IihiHukFVVWjbFnh5oef/fjwe0dsTrKGPIwAvNSDpfcjGAEt7hKreMQOHwwG73Q6EREN+fME/gVy0t8lztEWGJvKxTzPstzV2ZYVtuUeeFyiKAryLbVmiSSK05GWaIC9Oa2fPs7wr2iuEgVZ5wnZ4Dev2CpYQsG0Bx3HguR5c10VDlevQRys9YvdwA+f+FoLWhWXBIrdtu3tvNhvqUF3CWy9hayr8p0f4BEjSFFEcwvYEPM+lynschA7f0GDOFbjje3iBD8934NM7CAKEYYiSgVWRA7TlNouRWGa36Pk+ZuoEijVCWgQ0mxpl5KJ0aTepjyaPIAIVg9kVVGtFOWGXcwLSfNjq9kjVuBI5LWqmAsdbUycWza/oOk6yBFVTodjkcEMTK+sZgW9jk2UIqdNuyywZNqYbpqDZ+Hhem7hbLvFHkaGaVicrlk5d1djT4B03gOV4GNOoRrqJsSGwtkR3cD0OZDtQp1NFhSzJ+DKY4d1QxofxChNdkE5aNM1Jj+yzhYHZVMLPhzneDxV8HM1xu9RQbbcnIMmK5tRAszys9ACDuYX+2sANuWY7aAnGQNYZxxkihC5i9GUDv2ZrXCprSKqO3RnIxgl8UsKNEEUxCtJaQacdx1EnbBZup0dKmioa7obP+Nqf4mK0wKfJAverNx2+BWYEymjILJ04SQgedeM4G8ctNQfKQsM1dfhdUvGDupyoBl2KN0DugiWTEMQwDAgSePIKrN8Au7gwgukkWK11mLqGhGJ8z3s95VcgzyeO4+5mKLIMmZy/GcqQs3FcSrtgwXOcJEkwTbMrXPIp8/3jDjiJfxTs/N39hagYj4GvlktXjeG85XPcOY/jmMPz/QuZUmeOuM7EmAAAAABJRU5ErkJggg==&apos;); background-size: cover; display: block;&quot;
  &gt;&lt;/span&gt;
  &lt;img
        class=&quot;gatsby-resp-image-image&quot;
        alt=&quot;20210729 4&quot;
        title=&quot;20210729 4&quot;
        src=&quot;/static/7596eb7d7c36c89e4fbb3b06e7bab616/66caf/20210729-4.png&quot;
        srcset=&quot;/static/7596eb7d7c36c89e4fbb3b06e7bab616/5a46d/20210729-4.png 300w,
/static/7596eb7d7c36c89e4fbb3b06e7bab616/0a47e/20210729-4.png 600w,
/static/7596eb7d7c36c89e4fbb3b06e7bab616/66caf/20210729-4.png 853w&quot;
        sizes=&quot;(max-width: 853px) 100vw, 853px&quot;
        style=&quot;width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;&quot;
        loading=&quot;lazy&quot;
      /&gt;
    &lt;/span&gt;&lt;/p&gt;
&lt;p&gt;간단히 표시하면 &lt;strong&gt;{클라이언트} → {노드IP:노드포트} → {ClusterIP:포트} → {파드IP:포트}&lt;/strong&gt; 의 구조이다.&lt;/p&gt;
&lt;p&gt;이 서비스의 ClusterIP가 &lt;code class=&quot;language-text&quot;&gt;10.11.254.223&lt;/code&gt;으로 할당되었다고 가정하자. (NodePort 서비스는 ClusterIP 서비스 위에서 구현되었으므로 ClusterIP가 할당된다.) 우리는 이 서비스에 다음과 같이 접속할 수 있다.&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;10.11.254.233 : 80 &lt;strong&gt;(클러스터 내부)&lt;/strong&gt;&lt;/li&gt;
&lt;li&gt;130.211.97.55 : 30123 &lt;strong&gt;(클러스터 외부)&lt;/strong&gt;&lt;/li&gt;
&lt;li&gt;130.211.99.206 : 30123 &lt;strong&gt;(클러스터 외부)&lt;/strong&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;첫번째 주소는 내부에 생성된 ClusterIP 서비스의 주소이다. 물론 클러스터 내부에서만 접속할 수 있다. 두번째 주소와 세번째 주소는 각 노드의 IP와 포트이다. 이를 통해 클러스터 외부에서 접속할 수 있다.&lt;/p&gt;
&lt;h2 id=&quot;7-loadbalancer-타입-서비스&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#7-loadbalancer-%ED%83%80%EC%9E%85-%EC%84%9C%EB%B9%84%EC%8A%A4&quot; aria-label=&quot;7 loadbalancer 타입 서비스 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;7. LoadBalancer 타입 서비스&lt;/h2&gt;
&lt;p&gt;LoadBalancer 타입 또한 클러스터 외부에서 접속할 수 있으며 &lt;strong&gt;NodePort 타입 서비스를 확장&lt;/strong&gt;하여 구현되었다. NodePort 서비스가 ClusterIP 서비스를 기초로 하고 있기 때문에 이 LoadBalancer 서비스 또한 ClusterIP와 NodePort가 모두 설정된다.&lt;/p&gt;
&lt;p&gt;구글 클라우드 플랫폼(GCP), 아마존 웹 서비스(AWS), 마이크로소프트 Azure 등 상용 클라우드 서비스를 이용하는 경우, 이 클라우드 프로바이더들이 제공하는 로드 밸런서(Load Balancer)를 사용할 수도 있을 것이다.&lt;/p&gt;
&lt;p&gt;쿠버네티스에서는 이러한 &lt;strong&gt;외부 로드 밸런서를 서비스 리소스와 연결&lt;/strong&gt;할 수 있도록 LoadBalancer 타입 서비스를 지원한다. &lt;/p&gt;
&lt;p&gt;LoadBalancer 서비스를 사용한 구조는 다음과 같다.&lt;/p&gt;
&lt;p&gt;&lt;span
      class=&quot;gatsby-resp-image-wrapper&quot;
      style=&quot;position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 845px; &quot;
    &gt;
      &lt;span
    class=&quot;gatsby-resp-image-background-image&quot;
    style=&quot;padding-bottom: 87.33333333333334%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAARCAYAAADdRIy+AAAACXBIWXMAAAsTAAALEwEAmpwYAAACqklEQVQ4y41UXW/TQBDM//8FiBcqQJRXHhDQKgKqijYQaIlwUuw4Tuwk/rbjfNpO0mHnEkepEBUnre/Otzc7O7t2bbvdYrvdgGMY6fjw/QT1m1N8bJ0inIzUe/rc39//l9X4qMaiSNH3W7DcFoZxB3k5x/E49v3XqK3Xa9DKssSvzhBXjS4uv3Rw9dWEYXpyVsrZWrGsQB9luFwuD4D1zy2cvDrDi9fnMp/juqkTQp3leXG49CjDaZahYhkEIcauD9cLMB578DwfSZKAQefzOYqiUH7T6RRxHKuzyrifTCao8VFdsCwLw6EjYGO4Ls2V/RCLxUIBrVYrtbZt+8gGcBxHme/7u5SDIBA2ngLiXEWL40ScAsVos9kgDMPdZQHinSiKlC+BqnWNaVS6kDod6UDgSZaIdnNhtxRmGdI0lPVKNF1KVlPx81RA+lYBanmeqwqSgS8HZBEIoC8pJ6FoGAXIBJgWybooVmqdpjHiKEQsQJMkRirsDoBkyJnpeKKb1rPQ6PZxrVtoWwPMJeVSNKw6gqwY1HSGaFqOMq3vSIAjhjSKrLc1vL/R8KTZUXbRHWCzWoKiVICuZHInfp9+/MSzWwNPm228bfcU4wMgWZJyJsWwpGUa5gCNno3fzgi5AG7lnHpzpGmKmbC2pa3qHRP1ux6+GRaSOHoISP1YqVQ0yaRAU7mYyJ6twkHfXFqH3WAaOi5uW3h5q+P5zR3OBPhByjuGoao0GaRsG1mH4rTcA1afXiRBRo6NTt/GO32AN5qJS6P/t4YVQ2rJJqcEtIohweiX7oO6wrRnGAilfaJw3zbFvsrHfWjoOtqahtFopAKsRMPjkcnnyl7tdrvQpDimaSow3q/xcyJLVo8z90VZqB8Ci0AmbCfqxmC793u/otj/OHJls9kMfwASCAZFykVWtAAAAABJRU5ErkJggg==&apos;); background-size: cover; display: block;&quot;
  &gt;&lt;/span&gt;
  &lt;img
        class=&quot;gatsby-resp-image-image&quot;
        alt=&quot;20210729 5&quot;
        title=&quot;20210729 5&quot;
        src=&quot;/static/44d42c8d49abe9fd7f020fa81809a62f/8bd7c/20210729-5.png&quot;
        srcset=&quot;/static/44d42c8d49abe9fd7f020fa81809a62f/5a46d/20210729-5.png 300w,
/static/44d42c8d49abe9fd7f020fa81809a62f/0a47e/20210729-5.png 600w,
/static/44d42c8d49abe9fd7f020fa81809a62f/8bd7c/20210729-5.png 845w&quot;
        sizes=&quot;(max-width: 845px) 100vw, 845px&quot;
        style=&quot;width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;&quot;
        loading=&quot;lazy&quot;
      /&gt;
    &lt;/span&gt;&lt;/p&gt;
&lt;p&gt;위에서 소개했던 NodePort의 구조와 거의 유사하나 한 가지 컴포넌트가 추가됐다. 외부 로드 밸런서가 NodePort 서비스의 위에서 동작하는데, 이는 외부에서 접속 가능한 단일 IP와 포트를 클라우드 프로바이더로부터 할당받아 사용한다.&lt;/p&gt;
&lt;p&gt;클라이언트에서 외부 로드밸런서, 즉 130.211.53.173:80로 요청을 보내면 로드 밸런서는 NodePort를 통해 서비스로 요청을 리다이렉트한다. 현재 서비스의 처리량을 상회할만큼의 많은 요청이 들어오면 로드 밸런서는 설정된 정책에 따라 라우팅할 노드를 선택하는 등 부하 분산을 수행한다.&lt;/p&gt;
&lt;h2 id=&quot;마치며&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#%EB%A7%88%EC%B9%98%EB%A9%B0&quot; aria-label=&quot;마치며 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;마치며&lt;/h2&gt;
&lt;p&gt;이번 포스팅에서는 서비스와 연결된 &lt;em&gt;엔드포인트(Endpoint)&lt;/em&gt;와 &lt;em&gt;엔드포인트슬라이스(EndpointSlice)&lt;/em&gt;를 알아보았고, 서비스의 다른 타입인 &lt;em&gt;NodePort&lt;/em&gt;와 &lt;em&gt;LoadBalancer&lt;/em&gt;에 대해 살펴봤다. 두 타입의 서비스를 통해 이전 포스팅에서는 불가능했던 &lt;strong&gt;서비스의 클러스터 외부 노출&lt;/strong&gt;을 가능하게 만들었다. 그러나 이들은 &lt;strong&gt;L4 계층(네트워크 계층)에서 TCP, UDP 패킷&lt;/strong&gt;을 다룬다.&lt;/p&gt;
&lt;p&gt;다음 포스팅에서는 서비스보다 한 단계 더 추상화된 리소스로, &lt;strong&gt;L7 계층(애플리케이션 계층)에서 HTTP 패킷을 로드밸런싱&lt;/strong&gt;을 수행하는 Ingress라는 리소스에 대해 살펴볼 예정이다.&lt;/p&gt;
&lt;hr&gt;
&lt;h3 id=&quot;references&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#references&quot; aria-label=&quot;references permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;References&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;[1] &lt;a href=&quot;https://kubernetes.io/ko/docs/concepts/services-networking/endpoint-slices/&quot;&gt;https://kubernetes.io/ko/docs/concepts/services-networking/endpoint-slices/&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;[이미지 1-5] M. Lukša, Kubernetes in Action, Manning Publications, 2018.&lt;/li&gt;
&lt;/ul&gt;</content:encoded></item><item><title><![CDATA[쿠버네티스 서비스 : 인그레스 | 쿲벖넶팂슶 Ep.4]]></title><description><![CDATA[이 포스팅은 Marko Lukša의 Kubernetes in Action (1st edition)에서 Chapter 5. Services: Enabling Clients to Discover and Talk to Pods…]]></description><link>https://blog.frec.kr/cloud/service_ingress/</link><guid isPermaLink="false">https://blog.frec.kr/cloud/service_ingress/</guid><pubDate>Thu, 29 Jul 2021 02:13:00 GMT</pubDate><content:encoded>&lt;p&gt;이 포스팅은 Marko Lukša의 Kubernetes in Action (1st edition)에서 &lt;em&gt;Chapter 5. Services: Enabling Clients to Discover and Talk to Pods&lt;/em&gt;를 기반으로 재구성하였습니다.&lt;/p&gt;
&lt;p&gt;서비스에 관련된 내용은 총 3편의 시리즈로 포스팅할 예정입니다.&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href=&quot;https://blog.frec.kr/cloud/service_1/&quot;&gt;쿠버네티스 서비스 1&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://blog.frec.kr/cloud/service_2/&quot;&gt;쿠버네티스 서비스 2&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;쿠버네티스 서비스 : 인그레스&lt;/strong&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;hr&gt;
&lt;p&gt;(작성 중)&lt;/p&gt;</content:encoded></item><item><title><![CDATA[쿠버네티스 서비스 1 | 쿲벖넶팂슶 Ep.3]]></title><description><![CDATA[이 포스팅은 Marko Lukša의 Kubernetes in Action (1st edition)에서 Chapter 5. Services: Enabling Clients to Discover and Talk to Pods…]]></description><link>https://blog.frec.kr/cloud/service_1/</link><guid isPermaLink="false">https://blog.frec.kr/cloud/service_1/</guid><pubDate>Mon, 26 Jul 2021 23:50:00 GMT</pubDate><content:encoded>&lt;p&gt;이 포스팅은 Marko Lukša의 Kubernetes in Action (1st edition)에서 &lt;em&gt;Chapter 5. Services: Enabling Clients to Discover and Talk to Pods&lt;/em&gt;를 기반으로 재구성하였습니다.&lt;/p&gt;
&lt;p&gt;서비스에 관련된 내용은 총 3편의 시리즈로 포스팅할 예정입니다.&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;쿠버네티스 서비스 1&lt;/strong&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://blog.frec.kr/cloud/service_2/&quot;&gt;쿠버네티스 서비스 2&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://blog.frec.kr/cloud/service_ingress/&quot;&gt;쿠버네티스 서비스 : 인그레스&lt;/a&gt; (작성 중)&lt;/li&gt;
&lt;/ul&gt;
&lt;hr&gt;
&lt;h2 id=&quot;1-서비스service의-등장-배경&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#1-%EC%84%9C%EB%B9%84%EC%8A%A4service%EC%9D%98-%EB%93%B1%EC%9E%A5-%EB%B0%B0%EA%B2%BD&quot; aria-label=&quot;1 서비스service의 등장 배경 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;1. 서비스(Service)의 등장 배경&lt;/h2&gt;
&lt;p&gt;먼저 서비스(Service)라는 쿠버네티스 리소스가 등장하게 된 배경을 살펴본다.&lt;/p&gt;
&lt;p&gt;쿠버네티스 상에서 파드(Pod)는 기본적으로 격리되어 있다. 그러나 요즘 대부분의 어플리케이션은 외부의 요청에 결과값을 반환하길 원하고, 이를 위해서 파드들은 다음의 마이크로서비스 아키텍처 그림과 같이 다른 파드에 요청을 하기도 한다.&lt;/p&gt;
&lt;p&gt;&lt;span
      class=&quot;gatsby-resp-image-wrapper&quot;
      style=&quot;position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 539px; &quot;
    &gt;
      &lt;span
    class=&quot;gatsby-resp-image-background-image&quot;
    style=&quot;padding-bottom: 68.66666666666667%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAOCAYAAAAvxDzwAAAACXBIWXMAAAsTAAALEwEAmpwYAAACqUlEQVQ4y21Uy27TUBD1z/AJfABiz4IPQKz4AFgiVqhiwaIbQKAioS7YtCoKUhftJpVo+oKWplFDSZs4ie34GT/j5/XjMHZTKxUd6cq69tw5c+acay5IMihOjMXICqA38WEHabUv5u99Snu1/gdPPhyD14I6P2Y5orRASLW4xsEIK5ttnI8tFFkGyxngoHuM1Z0u1loDOF6AOGZwXBGdwW88WznDo7f7aHZkhGEIdepCNHwIigHZ9MGt/RjgU+MXjvtmheYFQ7TO9/B+Yw9ftjqYRQxFDmhmH6rdgaZqkAQeFgE5swCq6WFMBXlJo4IBOH4yxe7ZEHme1xRYBnRFH0P6lqcMaZoiimI4ITDUPIxoaW5S55djKyn7MVHOs5SoUhdFQQvV82ZqLInheh5M06znWM14jp1XZ4pb8+cWN8U8oVxZXoBRZ2UxbzZDCaw4DE8/nuDhUguHfbs+N50l0D0GnbrmFouUnRWLqDmrCpZhWANcjA7wptHD89VTnFxpFdBINqDZAXRdh+2F1x3ebvo6xGmANm+AMUbzS0gECRPrCqqsQBX5qogf0lz9CIIRgJ8YkKak8v6Fhu+HAgw3IjVzZFmEC0nBg6V93HvRxOaJDNs06H2BhGw5Lg9rPtwwrcGTNK+ELP3Ivds4wvLXHex2VaKYQTcviV4LW0c9rDfb1GkI2/WRJPF/LO4U5ZS3sH2qkN/SeVJG1MgakgpRGGOs2kjJ8DHZhiyJz80hXn/7SzlRXSQqbwqb35QkjjDz3BrxJpwoJ/XS6jYEQQTbnqAz7OHx8k/cf7mD7bZM/iTR3IBY+BA1C7JFxs7IVKVxb1ov7qBRhmb1IOp7EEUZfP8SU9uja+pBUM1KIEGUquLcXR5ctM8igE1CDBSXlnPrh1L60PRTGF6Cfw8MHu5ZKRdzAAAAAElFTkSuQmCC&apos;); background-size: cover; display: block;&quot;
  &gt;&lt;/span&gt;
  &lt;img
        class=&quot;gatsby-resp-image-image&quot;
        alt=&quot;20210726 1&quot;
        title=&quot;20210726 1&quot;
        src=&quot;/static/0e46e230bd6efa8252065a557ce593ff/10f9a/20210726-1.png&quot;
        srcset=&quot;/static/0e46e230bd6efa8252065a557ce593ff/5a46d/20210726-1.png 300w,
/static/0e46e230bd6efa8252065a557ce593ff/10f9a/20210726-1.png 539w&quot;
        sizes=&quot;(max-width: 539px) 100vw, 539px&quot;
        style=&quot;width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;&quot;
        loading=&quot;lazy&quot;
      /&gt;
    &lt;/span&gt;  &lt;/p&gt;
&lt;p&gt;파드가 서로 격리된 상황에서, 파드는 다른 파드로 접근하기 위한 방법을 찾아야 한다. 쿠버네티스가 아닌 상황이었다면 시스템 관리자가 직접 각 서버의 IP로 접근하도록 할 수 있었겠지만, 쿠버네티스에서 이 방법은 좋은 방법이 아니다.&lt;/p&gt;
&lt;p&gt;그 이유로 책에서는 다음 세 가지 이유를 들고 있다.&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;파드는 &lt;strong&gt;언제든지 생성되고 소멸&lt;/strong&gt;될 수 있는 존재다. (ephemeral)&lt;/li&gt;
&lt;li&gt;쿠버네티스가 파드에 IP를 할당할 때, 파드가 노드에 스케줄 되고 나서 시작되기 전에 IP가 할당된다. 때문에, 클라이언트가 &lt;strong&gt;타겟 파드의 IP 주소를 알기 어렵다&lt;/strong&gt;.&lt;/li&gt;
&lt;li&gt;쿠버네티스의 스케일링은 파드의 수를 늘리는 걸 뜻하는데, 이때마다 할당되는 IP를 클라이언트가 매번 알게 하기는 힘들다.&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;이렇게 변화가 잦은 파드를 통해서 애플리케이션을 서비스하려면, 사실상 파드의 IP를 이용해 접근하는 것은 불가능에 가깝다는 것을 깨달았다. 클라이언트의 입장에서 생각해보면, 접근할 수 있는 &lt;strong&gt;단 하나의 창구&lt;/strong&gt;를 원할텐데, 이런 배경에서 쿠버네티스는 &lt;em&gt;서비스(Service)&lt;/em&gt;라는 리소스를 소개하고 있다.&lt;/p&gt;
&lt;h2 id=&quot;2-서비스&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#2-%EC%84%9C%EB%B9%84%EC%8A%A4&quot; aria-label=&quot;2 서비스 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;2. 서비스&lt;/h2&gt;
&lt;p&gt;서비스는 같은 애플리케이션을 구동하는 파드들에 대해서, 변하지 않는 하나의 접근 포인트를 제공하는 것을 목표로 한다. 직접 바꾸지 않는 한 &lt;strong&gt;변하지 않는 IP 주소와 포트를 노출&lt;/strong&gt;해서, 연결된 파드가 더 생기든 말든 클라이언트는 신경쓰지 않도록 한다.&lt;/p&gt;
&lt;p&gt;프론트엔드와 백엔드로 나뉘어 쿠버네티스 상에 배포된 웹 서비스를 예시로 들어보겠다.&lt;/p&gt;
&lt;p&gt;&lt;span
      class=&quot;gatsby-resp-image-wrapper&quot;
      style=&quot;position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 889px; &quot;
    &gt;
      &lt;span
    class=&quot;gatsby-resp-image-background-image&quot;
    style=&quot;padding-bottom: 67%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAANCAYAAACpUE5eAAAACXBIWXMAAAsTAAALEwEAmpwYAAAB5klEQVQ4y5VT708TMRje//8PKCb6Cb+ZTDEMNSCYsLGBosNpDsaysXEZ+3G7XW/X3vXae3zbMgdDDTZ50/Zp36fP07ctYa1ppaFUDq31vcjzHFmW3kZmMc45JpMJgiDAeDxGHMco+dNLNLwKjr33+NrZQxhNKVlZAhuKxjJHFM0wHPbh+1dEMKI16QTcHlgUhT2odD1to/ZjC0etbXxpf8Bs7giNSqVcn2USQiRgLMCc1gWP7WHrzRKug0ppS5hRsMUCCdmSUto+jCIEYYh4kUBSMufC7RGCnGhHaKQWxUq2JkXVzgBP94/wjKJ8dm7xes/HxkEdG3tVvPrmgUCcDG7w5GPNYuWzC8RJsiR04RTmGIYRWn0fratr9KYhHaIwimKLfe8N0J3MLDZmC4d1+xYTpPS35SWhsSfTFFqSJapaJritnuBkk8Y8ZrZfYimpyug6NOWZqj8gNJdt7ZsxqZC5K45ZZ3GCYDa368YyY4yq7tunczMa2flfCdfbz/MBytsNvKkcY/+whUUi/l3lPxHevdv65ws839zFi5e7eF05QcSSB3v+i5BmRMLJMsPdnEcRrkhWzWv72Nqp4e27GqoNz77XR1s2lTaFWH6/ghRfdoc4OGziU7WJ02bn3h73oxRSeh2/AO/Y5WYJJML3AAAAAElFTkSuQmCC&apos;); background-size: cover; display: block;&quot;
  &gt;&lt;/span&gt;
  &lt;img
        class=&quot;gatsby-resp-image-image&quot;
        alt=&quot;20210726 2&quot;
        title=&quot;20210726 2&quot;
        src=&quot;/static/e8c56bb1210007f40fc01efe5592ab2e/83e77/20210726-2.png&quot;
        srcset=&quot;/static/e8c56bb1210007f40fc01efe5592ab2e/5a46d/20210726-2.png 300w,
/static/e8c56bb1210007f40fc01efe5592ab2e/0a47e/20210726-2.png 600w,
/static/e8c56bb1210007f40fc01efe5592ab2e/83e77/20210726-2.png 889w&quot;
        sizes=&quot;(max-width: 889px) 100vw, 889px&quot;
        style=&quot;width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;&quot;
        loading=&quot;lazy&quot;
      /&gt;
    &lt;/span&gt;  &lt;/p&gt;
&lt;p&gt;프론트엔드 파드는 사용자 로그인 웹 페이지를 제공하는 웹 서버로, 백엔드 파드를 로그인 로직을 처리하는 API 서버로 생각을 해보자. API 서버에서 문제가 생겨서 파드가 재시작되거나, 요청이 너무 많아져서 추가로 파드가 생성되었을 수 있다.&lt;/p&gt;
&lt;p&gt;쿠버네티스에서 파드의 재시작은 새로운 파드를 생성하고 기존 파드를 삭제하는 방법으로 이루어지므로, &lt;strong&gt;파드의 IP가 바뀔 것은 분명&lt;/strong&gt;하다.&lt;/p&gt;
&lt;p&gt;백엔드 파드에 연결되는 서비스 리소스를 생성하면, 프론트엔드 파드에서는 서비스의 IP를 통해 파드에 일관되게 접근할 수 있다.&lt;/p&gt;
&lt;p&gt;서비스의 생성은 &lt;code class=&quot;language-text&quot;&gt;kubectl expose&lt;/code&gt; 명령이나 서비스 YAML 파일을 통한 방법이 있다.&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;bash&quot;&gt;&lt;pre class=&quot;language-bash&quot;&gt;&lt;code class=&quot;language-bash&quot;&gt;$ kubectl expose deployment api-server --name&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;api-service&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;&lt;code class=&quot;language-text&quot;&gt;api-server&lt;/code&gt;라는 이름의 Deployment와 연결되는 서비스를 생성하고, &lt;code class=&quot;language-text&quot;&gt;api-service&lt;/code&gt;라는 이름을 붙인다.&lt;/p&gt;
&lt;p&gt;다만 YAML 파일에 명세를 작성하는 것이 kubectl 명령을 통해 생성하는 것보다 더 유연한 설정이 가능하기 때문에, 이 포스팅에서는 YAML 파일을 작성해 서비스를 생성한다.&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;yaml&quot;&gt;&lt;pre class=&quot;language-yaml&quot;&gt;&lt;code class=&quot;language-yaml&quot;&gt;&lt;span class=&quot;token comment&quot;&gt;# api-service.yaml&lt;/span&gt;

&lt;span class=&quot;token key atrule&quot;&gt;apiVersion&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; v1
&lt;span class=&quot;token key atrule&quot;&gt;kind&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; Service
&lt;span class=&quot;token key atrule&quot;&gt;metadata&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
	&lt;span class=&quot;token key atrule&quot;&gt;name&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; api&lt;span class=&quot;token punctuation&quot;&gt;-&lt;/span&gt;service
&lt;span class=&quot;token key atrule&quot;&gt;spec&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
	&lt;span class=&quot;token key atrule&quot;&gt;selector&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
		&lt;span class=&quot;token key atrule&quot;&gt;app&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; api&lt;span class=&quot;token punctuation&quot;&gt;-&lt;/span&gt;server
	&lt;span class=&quot;token key atrule&quot;&gt;ports&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
	&lt;span class=&quot;token punctuation&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;token key atrule&quot;&gt;port&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;80&lt;/span&gt;
		&lt;span class=&quot;token key atrule&quot;&gt;targetPort&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;8080&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;&lt;code class=&quot;language-text&quot;&gt;metadata.name&lt;/code&gt; 항목은 생성할 서비스의 이름을 뜻한다.&lt;/p&gt;
&lt;p&gt;&lt;code class=&quot;language-text&quot;&gt;spec.selector&lt;/code&gt;의 &lt;code class=&quot;language-text&quot;&gt;app: api-server&lt;/code&gt;는 &lt;strong&gt;서비스와 연결될 파드들을 식별&lt;/strong&gt;하는 용도의 &lt;em&gt;라벨 셀렉터(Label Selector)&lt;/em&gt;이다. 파드에 app: api-server 라고 라벨이 붙어있으면, 이 서비스와 연결된다.&lt;/p&gt;
&lt;p&gt;&lt;code class=&quot;language-text&quot;&gt;spec.ports.port&lt;/code&gt;는 서비스가 노출할 포트, &lt;code class=&quot;language-text&quot;&gt;spec.ports.targetPort&lt;/code&gt;는 연결할 파드의 포트를 뜻한다. 즉, {서비스의 IP}:80 → {파드의 IP}:8080 로 연결된다.&lt;/p&gt;
&lt;p&gt;어떤 서비스들은 포트를 여러 개 오픈해야 할 수도 있다. 예시로, 80포트를 통해 HTTP 연결을 열고, 443 포트를 통해 동시에 HTTPS 연결을 열어야할 수 있다. 이 경우에는 &lt;code class=&quot;language-text&quot;&gt;spec.ports&lt;/code&gt; 하위에 다음과 같이 추가로 작성하면 된다. 물론 이 포트 항목에 대해 이름도 지정할 수 있다.&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;yaml&quot;&gt;&lt;pre class=&quot;language-yaml&quot;&gt;&lt;code class=&quot;language-yaml&quot;&gt;&lt;span class=&quot;token comment&quot;&gt;# ...&lt;/span&gt;
&lt;span class=&quot;token key atrule&quot;&gt;ports&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
	&lt;span class=&quot;token punctuation&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;token key atrule&quot;&gt;name&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; http
		&lt;span class=&quot;token key atrule&quot;&gt;port&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;80&lt;/span&gt;
		&lt;span class=&quot;token key atrule&quot;&gt;targetPort&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;8080&lt;/span&gt;
	&lt;span class=&quot;token punctuation&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;token key atrule&quot;&gt;name&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; https
		&lt;span class=&quot;token key atrule&quot;&gt;port&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;443&lt;/span&gt;
		&lt;span class=&quot;token key atrule&quot;&gt;targetPort&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;8443&lt;/span&gt;
&lt;span class=&quot;token comment&quot;&gt;# ...&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;이렇게 생성된 서비스는 &lt;code class=&quot;language-text&quot;&gt;kubectl get svc&lt;/code&gt; 명령으로 확인해볼 수 있으며, 가장 기본적인 서비스 타입인 &lt;em&gt;ClusterIP&lt;/em&gt; 타입으로 생성되었다. 서비스의 타입은 다음이 있다.&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;ClusterIP 서비스&lt;/li&gt;
&lt;li&gt;NodePort 서비스&lt;/li&gt;
&lt;li&gt;LoadBalancer 서비스&lt;/li&gt;
&lt;li&gt;Ingress (서비스의 타입은 아니고 서비스를 관리하는 리소스이다. 시리즈의 마지막에서 자세히 다룬다.)&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;ClusterIP, NodePort, LoadBalancer 타입에 대해서는 다음 포스팅에서 살펴본다.&lt;/p&gt;
&lt;h2 id=&quot;3-서비스에-접속하기&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#3-%EC%84%9C%EB%B9%84%EC%8A%A4%EC%97%90-%EC%A0%91%EC%86%8D%ED%95%98%EA%B8%B0&quot; aria-label=&quot;3 서비스에 접속하기 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;3. 서비스에 접속하기&lt;/h2&gt;
&lt;p&gt;다음 그림은 책에서 제시하는 예시인데, 서비스에 연결된 백엔드 파드 중 하나에서 서비스에 curl로 요청을 보낸 상황이다.&lt;/p&gt;
&lt;p&gt;&lt;code class=&quot;language-text&quot;&gt;$ kubectl exec kubia-7nog1 —curl -s http://10.11.249.153&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;&lt;span
      class=&quot;gatsby-resp-image-wrapper&quot;
      style=&quot;position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 967px; &quot;
    &gt;
      &lt;span
    class=&quot;gatsby-resp-image-background-image&quot;
    style=&quot;padding-bottom: 54.666666666666664%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAALCAYAAAB/Ca1DAAAACXBIWXMAAAsTAAALEwEAmpwYAAACHElEQVQoz22T627TQBCF8/iIF4BfSBUqF4kXoBekAio/UFtRpU0bJ3Zsx+tLHF/ie9LkY7wBBaGuNdLu2dkz3jlnB7vdjmdDvqqqiKKIOI6p65ogCJhOJ5jmlLIs8X2fu+GQyWSCZZm0bcvgOTLh0qNP6EmSZUKe5yhPYYzHEgZpkpJlGWEY0jStPrfd7vaE/4/tbsvmaUPbNaw3nZ43Ta3nVV3SrVvZa3XBp+2GuqkkZy2ETwx6gj37VgP9iDKHL7+OOb95x+n1EffOJcHS5mL4gbPrY06ujhja3wgTV7CPnF0dc3r1luvpyeEPlVKMRiPMqYUXmESJiWXfES5MgtjE8Q1iKWS5I1lb+BqbsMxdjYXxDCccHQj7pvfNL1YlwcJlkebMvFiIRZiljyuH4ziSgia+8nWO7RkiWoAlWKACXDWVKwthXRZa0aZpNHkYzzEv32Odv8a5eMPcumEe2qJsSlmsaKSPcaJQ0YyiyESwVLAKP7IYqDTj1nbouk4Tih6yYfPw9RXjzy94PHmJNfmBv5yTFnPKZkHZLqR/M7m2LZgiyRVFHeEEcuWfjw6fvt+Kap0m7WNVZnipxzzzcZYucR5RlDm2/yDxiOXdEwpeVivc0BCisRQ0JU8xqKuWPC20ypF4qjepYRgU+ergoz/OSpOMmWUzdzzW3YbnxuDfRW/Snqw3c+87/V6kB3+F++vPvb12Og4PYp/3Gx39PFHOpVGDAAAAAElFTkSuQmCC&apos;); background-size: cover; display: block;&quot;
  &gt;&lt;/span&gt;
  &lt;img
        class=&quot;gatsby-resp-image-image&quot;
        alt=&quot;20210726 3&quot;
        title=&quot;20210726 3&quot;
        src=&quot;/static/bf3d28255905a0150fcd622b2a84238e/aa08e/20210726-3.png&quot;
        srcset=&quot;/static/bf3d28255905a0150fcd622b2a84238e/5a46d/20210726-3.png 300w,
/static/bf3d28255905a0150fcd622b2a84238e/0a47e/20210726-3.png 600w,
/static/bf3d28255905a0150fcd622b2a84238e/aa08e/20210726-3.png 967w&quot;
        sizes=&quot;(max-width: 967px) 100vw, 967px&quot;
        style=&quot;width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;&quot;
        loading=&quot;lazy&quot;
      /&gt;
    &lt;/span&gt;  &lt;/p&gt;
&lt;p&gt;이 그림에서 중요하게 볼 것은, 서비스 리소스에 요청이 들어갔을 때, 쿠버네티스의 프록시가 이 연결을 가로채서, &lt;strong&gt;랜덤하게 선택된 백엔드 파드로 포워딩&lt;/strong&gt;해준다는 것이다.&lt;/p&gt;
&lt;p&gt;이렇게 해서 지금까지 서비스에 대해 대략적으로 알아봤고, 백엔드 파드에 대해 접속할 수 있는 IP 주소와 포트를 얻었다. 다만 여기서 한 가지 의문이 생길 수 있다.&lt;/p&gt;
&lt;p&gt;&lt;span
      class=&quot;gatsby-resp-image-wrapper&quot;
      style=&quot;position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 889px; &quot;
    &gt;
      &lt;span
    class=&quot;gatsby-resp-image-background-image&quot;
    style=&quot;padding-bottom: 67%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAANCAYAAACpUE5eAAAACXBIWXMAAAsTAAALEwEAmpwYAAAB5klEQVQ4y5VT708TMRje//8PKCb6Cb+ZTDEMNSCYsLGBosNpDsaysXEZ+3G7XW/X3vXae3zbMgdDDTZ50/Zp36fP07ctYa1ppaFUDq31vcjzHFmW3kZmMc45JpMJgiDAeDxGHMco+dNLNLwKjr33+NrZQxhNKVlZAhuKxjJHFM0wHPbh+1dEMKI16QTcHlgUhT2odD1to/ZjC0etbXxpf8Bs7giNSqVcn2USQiRgLMCc1gWP7WHrzRKug0ppS5hRsMUCCdmSUto+jCIEYYh4kUBSMufC7RGCnGhHaKQWxUq2JkXVzgBP94/wjKJ8dm7xes/HxkEdG3tVvPrmgUCcDG7w5GPNYuWzC8RJsiR04RTmGIYRWn0fratr9KYhHaIwimKLfe8N0J3MLDZmC4d1+xYTpPS35SWhsSfTFFqSJapaJritnuBkk8Y8ZrZfYimpyug6NOWZqj8gNJdt7ZsxqZC5K45ZZ3GCYDa368YyY4yq7tunczMa2flfCdfbz/MBytsNvKkcY/+whUUi/l3lPxHevdv65ws839zFi5e7eF05QcSSB3v+i5BmRMLJMsPdnEcRrkhWzWv72Nqp4e27GqoNz77XR1s2lTaFWH6/ghRfdoc4OGziU7WJ02bn3h73oxRSeh2/AO/Y5WYJJML3AAAAAElFTkSuQmCC&apos;); background-size: cover; display: block;&quot;
  &gt;&lt;/span&gt;
  &lt;img
        class=&quot;gatsby-resp-image-image&quot;
        alt=&quot;20210726 2&quot;
        title=&quot;20210726 2&quot;
        src=&quot;/static/e8c56bb1210007f40fc01efe5592ab2e/83e77/20210726-2.png&quot;
        srcset=&quot;/static/e8c56bb1210007f40fc01efe5592ab2e/5a46d/20210726-2.png 300w,
/static/e8c56bb1210007f40fc01efe5592ab2e/0a47e/20210726-2.png 600w,
/static/e8c56bb1210007f40fc01efe5592ab2e/83e77/20210726-2.png 889w&quot;
        sizes=&quot;(max-width: 889px) 100vw, 889px&quot;
        style=&quot;width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;&quot;
        loading=&quot;lazy&quot;
      /&gt;
    &lt;/span&gt;  &lt;/p&gt;
&lt;p&gt;이전의 웹 서비스 예시에서, 백엔드 파드와 프론트엔드 파드는 서로 독립적으로 생성되었다. 그렇다면 프론트엔드 파드에서는 백엔드 서비스의 주소를 모르지 않을까? 프론트엔드 어플리케이션을 만들 때 백엔드 서비스의 IP와 포트를 지정을 해둬야 할까?&lt;/p&gt;
&lt;p&gt;아무리 서비스의 IP가 바뀌지 않는다고 해도, 이렇게 IP를 하드코딩해두는 등의 방법은 우아하지 않은 선택인 것 같다.&lt;/p&gt;
&lt;p&gt;역시 쿠버네티스는 다음 두 가지 방법을 제공함으로써 이런 고민을 하게 놔두지 않는다.&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;각 파드에 서비스의 IP와 포트가 &lt;strong&gt;환경변수&lt;/strong&gt;로 등록되어 있다.&lt;/li&gt;
&lt;li&gt;서비스에 접근할 수 있도록 &lt;strong&gt;도메인 네임&lt;/strong&gt;을 제공한다.  &lt;/li&gt;
&lt;/ol&gt;
&lt;h3 id=&quot;각-파드에-서비스의-ip와-포트가-환경변수로-등록되어-있다&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#%EA%B0%81-%ED%8C%8C%EB%93%9C%EC%97%90-%EC%84%9C%EB%B9%84%EC%8A%A4%EC%9D%98-ip%EC%99%80-%ED%8F%AC%ED%8A%B8%EA%B0%80-%ED%99%98%EA%B2%BD%EB%B3%80%EC%88%98%EB%A1%9C-%EB%93%B1%EB%A1%9D%EB%90%98%EC%96%B4-%EC%9E%88%EB%8B%A4&quot; aria-label=&quot;각 파드에 서비스의 ip와 포트가 환경변수로 등록되어 있다 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;각 파드에 서비스의 IP와 포트가 &lt;strong&gt;환경변수&lt;/strong&gt;로 등록되어 있다.&lt;/h3&gt;
&lt;p&gt;첫번째 환경변수부터 설명을 해보자면, 쿠버네티스가 파드를 시작할 때 그 시점에 존재하는 환경변수를 그 파드에도 설정한다.&lt;/p&gt;
&lt;p&gt;&lt;span
      class=&quot;gatsby-resp-image-wrapper&quot;
      style=&quot;position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 1133px; &quot;
    &gt;
      &lt;span
    class=&quot;gatsby-resp-image-background-image&quot;
    style=&quot;padding-bottom: 30.66666666666667%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAGCAYAAADDl76dAAAACXBIWXMAAAsTAAALEwEAmpwYAAABEElEQVQY01WOyU7EMBBE8/8/AH/AJpY7B7jCiLkRiYxEHNuJE2eDbB6SKIXbaIZJS0/VLbery3t8V7jecNxvBS5fI9y+CQfNpHeWG/v+sJWuv3hhthe42kQ4f945zp4OBPCSLMcnlyAVSiOSCeJUg8cKUmVoeoPW/PzpsF9p1Q6OxoxHPJUk2AUf4BGDFByCR8i1RvP9hbqunPZdh65trf5D89B32JsBp+WlaYogCCClhBACSikk9kie5zDGOKZpcstZliEMQzAWQdv3Qy3LcsTjnLslgnrGmPtYVRXKskRrk1CN4+jMtU1Ph0nrukZn05+aenEcr9JRT2bzPDsTghYpJSklp6MUwPd9FEWxMvwFdxy+W4O/b1YAAAAASUVORK5CYII=&apos;); background-size: cover; display: block;&quot;
  &gt;&lt;/span&gt;
  &lt;img
        class=&quot;gatsby-resp-image-image&quot;
        alt=&quot;20210726 4&quot;
        title=&quot;20210726 4&quot;
        src=&quot;/static/66c7219e1db56d8aa7178763cd9436bc/33c9c/20210726-4.png&quot;
        srcset=&quot;/static/66c7219e1db56d8aa7178763cd9436bc/5a46d/20210726-4.png 300w,
/static/66c7219e1db56d8aa7178763cd9436bc/0a47e/20210726-4.png 600w,
/static/66c7219e1db56d8aa7178763cd9436bc/33c9c/20210726-4.png 1133w&quot;
        sizes=&quot;(max-width: 1133px) 100vw, 1133px&quot;
        style=&quot;width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;&quot;
        loading=&quot;lazy&quot;
      /&gt;
    &lt;/span&gt;  &lt;/p&gt;
&lt;p&gt;책에서는 &lt;code class=&quot;language-text&quot;&gt;kubectl exec&lt;/code&gt; 명령으로 파드에 환경변수를 확인하는 명령을 전달하고 있다.&lt;/p&gt;
&lt;p&gt;책에서 생성한 서비스의 이름이 &lt;code class=&quot;language-text&quot;&gt;kubia&lt;/code&gt;인데, kubia의 IP 주소와 포트가 KUBIA&lt;em&gt;SERVICE&lt;/em&gt;HOST, KUBIA&lt;em&gt;SERVICE&lt;/em&gt;PORT 환경변수로 등록되어 있는 것을 볼 수 있다.  &lt;/p&gt;
&lt;h3 id=&quot;서비스에-접근할-수-있도록-도메인-네임을-제공한다&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#%EC%84%9C%EB%B9%84%EC%8A%A4%EC%97%90-%EC%A0%91%EA%B7%BC%ED%95%A0-%EC%88%98-%EC%9E%88%EB%8F%84%EB%A1%9D-%EB%8F%84%EB%A9%94%EC%9D%B8-%EB%84%A4%EC%9E%84%EC%9D%84-%EC%A0%9C%EA%B3%B5%ED%95%9C%EB%8B%A4&quot; aria-label=&quot;서비스에 접근할 수 있도록 도메인 네임을 제공한다 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;서비스에 접근할 수 있도록 도메인 네임을 제공한다.&lt;/h3&gt;
&lt;p&gt;쿠버네티스 클러스터를 구성하면 &lt;code class=&quot;language-text&quot;&gt;kube-system&lt;/code&gt; 네임스페이스에 &lt;strong&gt;&lt;em&gt;CoreDNS&lt;/em&gt;&lt;/strong&gt;가 구동된다. 클러스터 내에서 발생한 DNS 쿼리는 CoreDNS를 통해서 쿠버네티스가 제어하게 된다.&lt;/p&gt;
&lt;p&gt;각 파드들은 서비스의 이름만 알고 있다면 FQDN(Fully Qualified Domain Name)을 통해 서비스에 접근할 수 있고, 이 FQDN의 해석을 CoreDNS가 맡는다.&lt;/p&gt;
&lt;p&gt;예시로, &lt;code class=&quot;language-text&quot;&gt;default&lt;/code&gt; 네임스페이스에 &lt;code class=&quot;language-text&quot;&gt;api-service&lt;/code&gt;라는 서비스가 생성되었다면, 다른 파드에서 이 서비스를 다음 도메인을 통해 접근할 수 있다.&lt;/p&gt;
&lt;p&gt;&lt;code class=&quot;language-text&quot;&gt;api-service.default.svc.cluster.local&lt;/code&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;code class=&quot;language-text&quot;&gt;api-service&lt;/code&gt;는 서비스의 이름을 뜻한다.&lt;/li&gt;
&lt;li&gt;&lt;code class=&quot;language-text&quot;&gt;default&lt;/code&gt;는 해당 서비스가 속한 네임스페이스이다.&lt;/li&gt;
&lt;li&gt;&lt;code class=&quot;language-text&quot;&gt;svc&lt;/code&gt;는 서비스를 뜻하며, 접근하고자 하는 리소스를 나타낸다.&lt;/li&gt;
&lt;li&gt;&lt;code class=&quot;language-text&quot;&gt;cluster.local&lt;/code&gt;은 클러스터 내에서 사용 가능한 최상위 도메인이다.&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;간단히 말하면, 접근하고자 하는 서비스의 이름과 네임스페이스만 안다면 이렇게 조합된 도메인을 통해 해당 서비스에 접근할 수 있게 된다.&lt;/p&gt;
&lt;p&gt;이번 포스팅에서는 이렇게 서비스 리소스의 등장 배경과, 서비스의 생성, 서비스에 대한 접근 방법에 대해 살펴보았다. 다음 포스팅에서는 ClusterIP, NodePort, LoadBalancer 타입의 서비스에 대해 상세히 알아볼 예정이다.&lt;/p&gt;
&lt;hr&gt;
&lt;h3 id=&quot;references&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#references&quot; aria-label=&quot;references permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;References&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;[이미지 1] : &lt;a href=&quot;https://microservices.io&quot;&gt;https://microservices.io&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;[이미지 2-5] : M. Lukša, Kubernetes in Action, Manning Publications, 2018.&lt;/li&gt;
&lt;/ul&gt;</content:encoded></item><item><title><![CDATA[쿠버네티스 NodePort 할당 범위 변경하기]]></title><description><![CDATA[수정사항 2021.07.24 21:16 :: 제목 수정, 일부 잘못된 내용 삭제, 주석 수정 NodePort 쿠버네티스 기본 세팅에서 NodePort는 - 범위 내에서 할당된다. 1 이렇게 세팅된 이유는 다음 충돌이 예상되기 때문이다.…]]></description><link>https://blog.frec.kr/cloud/modify_nodeport_range/</link><guid isPermaLink="false">https://blog.frec.kr/cloud/modify_nodeport_range/</guid><pubDate>Fri, 23 Jul 2021 17:17:00 GMT</pubDate><content:encoded>&lt;p&gt;&lt;strong&gt;수정사항&lt;/strong&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;2021.07.24 21:16 :: 제목 수정, 일부 잘못된 내용 삭제, 주석 수정&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id=&quot;nodeport&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#nodeport&quot; aria-label=&quot;nodeport permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;NodePort&lt;/h2&gt;
&lt;p&gt;쿠버네티스 기본 세팅에서 NodePort는 &lt;code class=&quot;language-text&quot;&gt;30000&lt;/code&gt;-&lt;code class=&quot;language-text&quot;&gt;32767&lt;/code&gt; 범위 내에서 할당된다. [1]&lt;/p&gt;
&lt;p&gt;이렇게 세팅된 이유는 다음 충돌이 예상되기 때문이다. [2]&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;노드가 실제로 사용하는 포트와 충돌할 수 있음. (예로 &lt;code class=&quot;language-text&quot;&gt;22&lt;/code&gt;번 포트 등)&lt;/li&gt;
&lt;li&gt;pod host 포트와 충돌할 수 있음.&lt;/li&gt;
&lt;li&gt;&lt;code class=&quot;language-text&quot;&gt;80&lt;/code&gt;, &lt;code class=&quot;language-text&quot;&gt;443&lt;/code&gt;, &lt;code class=&quot;language-text&quot;&gt;22&lt;/code&gt; 등에 랜덤으로 할당될 수 있음.&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;NodePort range는 클러스터에서 pod로 운영되는 &lt;code class=&quot;language-text&quot;&gt;kube-apiserver&lt;/code&gt;가 제어한다.&lt;/p&gt;
&lt;p&gt;이 pod는 &lt;code class=&quot;language-text&quot;&gt;/etc/kubernetes/manifests/kube-apiserver.yaml&lt;/code&gt; 파일에서 설정값을 가져오고, 이 파일을 수정하면 현재 운영 중인 클러스터도 이를 감지하고 &lt;code class=&quot;language-text&quot;&gt;kube-apiserver&lt;/code&gt; pod를 재시작한다. &lt;/p&gt;
&lt;p&gt;해당 파일에 &lt;code class=&quot;language-text&quot;&gt;--service-node-port-range&lt;/code&gt; 설정을 넣어주면 된다. [3]&lt;/p&gt;
&lt;p&gt;수정이 완료되면 자동으로 pod가 재시작되며 변경한 설정 또한 반영된다.&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;yaml&quot;&gt;&lt;pre class=&quot;language-yaml&quot;&gt;&lt;code class=&quot;language-yaml&quot;&gt;&lt;span class=&quot;token comment&quot;&gt;# /etc/kubernetes/manifests/kube-apiserver.yaml&lt;/span&gt;

&lt;span class=&quot;token punctuation&quot;&gt;...&lt;/span&gt;
&lt;span class=&quot;token key atrule&quot;&gt;spec&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
  &lt;span class=&quot;token key atrule&quot;&gt;containers&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
  &lt;span class=&quot;token punctuation&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;token key atrule&quot;&gt;command&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
    &lt;span class=&quot;token punctuation&quot;&gt;-&lt;/span&gt; kube&lt;span class=&quot;token punctuation&quot;&gt;-&lt;/span&gt;apiserver
    &lt;span class=&quot;token punctuation&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;-&lt;/span&gt;authorization&lt;span class=&quot;token punctuation&quot;&gt;-&lt;/span&gt;mode=Node&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;RBAC
    &lt;span class=&quot;token punctuation&quot;&gt;...&lt;/span&gt;
    &lt;span class=&quot;token punctuation&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;-&lt;/span&gt;service&lt;span class=&quot;token punctuation&quot;&gt;-&lt;/span&gt;node&lt;span class=&quot;token punctuation&quot;&gt;-&lt;/span&gt;port&lt;span class=&quot;token punctuation&quot;&gt;-&lt;/span&gt;range=30000&lt;span class=&quot;token punctuation&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;50000&lt;/span&gt;
&lt;span class=&quot;token punctuation&quot;&gt;...&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;h2 id=&quot;references&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#references&quot; aria-label=&quot;references permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;References&lt;/h2&gt;
&lt;p&gt;[1] &lt;a href=&quot;https://kubernetes.io/ko/docs/concepts/services-networking/service/#nodeport&quot;&gt;https://kubernetes.io/ko/docs/concepts/services-networking/service/#nodeport&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;[2] &lt;a href=&quot;https://github.com/kubernetes/kubernetes/issues/9995&quot;&gt;https://github.com/kubernetes/kubernetes/issues/9995&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;[3] &lt;a href=&quot;http://www.thinkcode.se/blog/2019/02/20/kubernetes-service-node-port-range&quot;&gt;http://www.thinkcode.se/blog/2019/02/20/kubernetes-service-node-port-range&lt;/a&gt;&lt;/p&gt;</content:encoded></item><item><title><![CDATA[about]]></title><description><![CDATA[Myung-Hyun Kim Thank you for reading my resume. If you want to contact me, Please send me an email.]]></description><link>https://blog.frec.kr/resume-en/</link><guid isPermaLink="false">https://blog.frec.kr/resume-en/</guid><pubDate>Fri, 02 Jul 2021 11:36:00 GMT</pubDate><content:encoded>&lt;h1 id=&quot;myung-hyun-kim&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#myung-hyun-kim&quot; aria-label=&quot;myung hyun kim permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;Myung-Hyun Kim&lt;/h1&gt;
&lt;div align=&quot;center&quot;&gt;
&lt;p&gt;&lt;em&gt;Thank you for reading my resume. If you want to contact me, Please send me an email.&lt;/em&gt;&lt;/p&gt;
&lt;/div&gt;</content:encoded></item><item><title><![CDATA[etcd에 대해 알아보자 | 쿲벖넶팂슶 Ep.2]]></title><description><![CDATA[1. What is etcd? distributed reliable key-value store :   + istributed system…]]></description><link>https://blog.frec.kr/cloud/etcd/</link><guid isPermaLink="false">https://blog.frec.kr/cloud/etcd/</guid><pubDate>Wed, 30 Jun 2021 20:17:00 GMT</pubDate><content:encoded>&lt;h2 id=&quot;1-what-is-etcd&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#1-what-is-etcd&quot; aria-label=&quot;1 what is etcd permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;1. What is etcd?&lt;/h2&gt;
&lt;blockquote&gt;
&lt;p&gt;distributed reliable key-value store&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;:  &lt;code class=&quot;language-text&quot;&gt;/etc&lt;/code&gt; + &lt;code class=&quot;language-text&quot;&gt;d&lt;/code&gt;istributed system (&lt;em&gt;“엣-시디”로 읽음&lt;/em&gt;)&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;분산 시스템의 운영에 필요한 데이터를 관리하는 용도로 사용된다.&lt;/li&gt;
&lt;li&gt;클러스터 구성을 위해 election, consensus(Raft) 등을 처리하고 관련 설정값을 관리한다.&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;CNCF(Cloud Native Computing Foundation) &lt;em&gt;Graduated&lt;/em&gt; 프로젝트.&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;CNCF에서는 Coordination &amp;#x26; Service Discovery 역할을 하는 프로젝트라고 소개됨.&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&quot;11-history&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#11-history&quot; aria-label=&quot;11 history permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;1.1 History&lt;/h3&gt;
&lt;p&gt;&lt;strong&gt;CoreOS Container Linux&lt;/strong&gt;를 관리하기 위해 개발되었다.&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;클라우드와 컨테이너에 최적화된 경량 리눅스 배포판 (약 100MB)&lt;/li&gt;
&lt;li&gt;보안을 위해 자동으로 OS를 업데이트한다.&lt;/li&gt;
&lt;li&gt;read-only 루트 파일 시스템을 2개 생성하여 업데이트 후 교체하는 방법으로 OS를 라이브 업데이트한다.&lt;/li&gt;
&lt;li&gt;그러나, RedHat에 인수된 후 2020.05 서비스 지원 종료되었다. (End of Service)&lt;/li&gt;
&lt;li&gt;후속 버전들 : &lt;strong&gt;*Fedora CoreOS&lt;/strong&gt; / &lt;strong&gt;RHCOS*&lt;/strong&gt;(RedHat CoreOS)&lt;/li&gt;
&lt;li&gt;RHCOS : OpenShift에 포함하기 위해 OCI를 지원하고 보안을 강화(SELinux 지원)&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&quot;12-features&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#12-features&quot; aria-label=&quot;12 features permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;1.2 Features&lt;/h3&gt;
&lt;p&gt;&lt;strong&gt;Simple Interface&lt;/strong&gt; : Read, Write는 JSON 포맷으로 HTTP를 통해 이루어졌다.&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Key-value storage&lt;/strong&gt; : 파일시스템처럼 계층화된 디렉토리에 데이터를 저장할 수 있다.&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Watch for Changes&lt;/strong&gt; : 특정 키나 디렉토리의 변경을 감시하다 변경에 react 할 수 있다.&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;인스턴스 당 1초에 1000건의 write 성능&lt;/li&gt;
&lt;li&gt;SSL을 통한 인증 기능&lt;/li&gt;
&lt;li&gt;Fully Replicated&lt;/li&gt;
&lt;li&gt;key에 TTL (Time-to-live) 적용 가능&lt;/li&gt;
&lt;li&gt;Raft 알고리즘을 통해 분산됨&lt;/li&gt;
&lt;li&gt;Highly Available&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&quot;13-used-by&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#13-used-by&quot; aria-label=&quot;13 used by permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;1.3 Used by&lt;/h3&gt;
&lt;p&gt;&lt;span
      class=&quot;gatsby-resp-image-wrapper&quot;
      style=&quot;position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 1071px; &quot;
    &gt;
      &lt;span
    class=&quot;gatsby-resp-image-background-image&quot;
    style=&quot;padding-bottom: 10.666666666666668%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAACCAYAAABYBvyLAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAjElEQVQI1x2MQQqCQAAA/f8/ekC36NQpKIgodFNJM0EWK1d3TSzbdjLnMnMaL5QDZd2hmxptDG1reNsvseqQSlPVDUqbyX+uaUl6llNba3HOcbtXqFpj2ifebNOxFQX+cU8gTkRhSD98WFweiFySZDlpXhAl2bhwLOc71qtgLEvfv6ahiBMOfkgUp/wAi1aUp/2CZz0AAAAASUVORK5CYII=&apos;); background-size: cover; display: block;&quot;
  &gt;&lt;/span&gt;
  &lt;img
        class=&quot;gatsby-resp-image-image&quot;
        alt=&quot;20210630 1&quot;
        title=&quot;20210630 1&quot;
        src=&quot;/static/e550add1da9ab7c7936472e28ab2e464/705cc/20210630-1.png&quot;
        srcset=&quot;/static/e550add1da9ab7c7936472e28ab2e464/5a46d/20210630-1.png 300w,
/static/e550add1da9ab7c7936472e28ab2e464/0a47e/20210630-1.png 600w,
/static/e550add1da9ab7c7936472e28ab2e464/705cc/20210630-1.png 1071w&quot;
        sizes=&quot;(max-width: 1071px) 100vw, 1071px&quot;
        style=&quot;width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;&quot;
        loading=&quot;lazy&quot;
      /&gt;
    &lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;em&gt;외 AWS, Google, IBM, Alibaba 등 회사들의 다수 상용 프로덕션들.&lt;/em&gt;&lt;/p&gt;
&lt;p&gt;(kubernetes, ROOK, CoreDNS는 CNCF 프로젝트이므로 M3만 간단히 소개함)&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;M3 (by Uber)&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;: a &lt;em&gt;Large-scale Time Series Metrics Platform for Prometheus&lt;/em&gt;&lt;/p&gt;
&lt;p&gt;&lt;span
      class=&quot;gatsby-resp-image-wrapper&quot;
      style=&quot;position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 669px; &quot;
    &gt;
      &lt;span
    class=&quot;gatsby-resp-image-background-image&quot;
    style=&quot;padding-bottom: 62%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAMCAYAAABiDJ37AAAACXBIWXMAAAsTAAALEwEAmpwYAAACGUlEQVQoz5WS7UtTYRjGzz/Vt6i+RPQCMpCijL6k9IKRUoK9YLRIsCCTkAgxg+zFzCZJQ5QixXSzzS0aTbO0bZ41N910y+bZec7z65y9iKELug8X14H73Nf1PPd1lLsDCU62zlDbHqTm3nfanQk0A7RomJi9jvi1c6hNtSzbzyMWfmCVNAyklAUuQVgsUa4/j7Gjzseexk/suhRkvz1EaFmH+ALRmw0s3qgnYq8n0XwRoYY2BMuVEktp9LnSONwZ+ibSvHavsqZJEDnk/Aza9GdyXwMwF0SsZzcG19Q48Xde4iN+EqN+Ft96yMwuoJRz0sJzpE5V4KvcydTh3WRqDiG+BZHFfqR/xOw1MWhr4I3tAl7bFdROJ4q1C2FsgrULc8BIr7A00EPoRTfqy6esmO9GMpEXM4ROajZEbNDNz6FJ1GGTnROkp0PmCeXW01kmVq2b+JKOEEiH+b2pLyhfynZihiwsvcf3imO9Zzjae5pHnh6k10Wy/zFJRzfa2LCZrCikW2IzrH8KdnqfcbDzOAc6qmj72EX2YRtzZyuZrz1CprUJwxQwt2SyNSPzs2UEC1f2RwPcGX/A7Q/3mVR9pQ8Qeq78lWVReTtsMStC13Wy62YwawYrRSR/CbKaKP/bFAT+fvIJF30c40vsa3RRcfk9tquj7G0Yo2N4GcVy+x9omp7PeWhqlRMtfqpvuahuGaeq2cOT0RR/ADqzZ4AnEjPcAAAAAElFTkSuQmCC&apos;); background-size: cover; display: block;&quot;
  &gt;&lt;/span&gt;
  &lt;img
        class=&quot;gatsby-resp-image-image&quot;
        alt=&quot;20210630 2&quot;
        title=&quot;20210630 2&quot;
        src=&quot;/static/df283bba7e5760e65b5b9792924c7e4e/99272/20210630-2.png&quot;
        srcset=&quot;/static/df283bba7e5760e65b5b9792924c7e4e/5a46d/20210630-2.png 300w,
/static/df283bba7e5760e65b5b9792924c7e4e/0a47e/20210630-2.png 600w,
/static/df283bba7e5760e65b5b9792924c7e4e/99272/20210630-2.png 669w&quot;
        sizes=&quot;(max-width: 669px) 100vw, 669px&quot;
        style=&quot;width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;&quot;
        loading=&quot;lazy&quot;
      /&gt;
    &lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;span
      class=&quot;gatsby-resp-image-wrapper&quot;
      style=&quot;position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 678px; &quot;
    &gt;
      &lt;span
    class=&quot;gatsby-resp-image-background-image&quot;
    style=&quot;padding-bottom: 81.33333333333333%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAQCAYAAAAWGF8bAAAACXBIWXMAAAsTAAALEwEAmpwYAAAC40lEQVQ4y42TjUtTYRTG99cVWRZhEFJRoRham2amtqUuFV2mppW2EpPC8CM/5zTNrIXW/ExLQ5QasabT2hzpyrnt3l/vvTc/KfDAuQ+Xe8/zPuec59WBxIM+L/G3XSRUuTh35zOJAk+WfaHupRclwpEokiTtK3UgU9LhJbbEw/GiGQ6Z3nLi5hwxxW4q7EsqYVSS2W/olEfHsA/TUw8FzxYwN2porPfQPe7fIpTl/aVOkvecLkV2v6rqtH9kWd6fQi20QikS2iLYGTvJ/qdOJVQWUtS6KOa4TEnnDyztCn7nVueiaN1Dy7vvStOi7ehW0V6luwjPVLqIr1wgrvgTR82jHDOPcDjnPcctHo5YfohZ+ncUsos0FA4JB4S3xyOLLZ+qcBFXJjZsmSc2/wOHzdOcKW/H8KSJi/XdFNh6GHI5mHCPEolq8536NkGFo5jSNwWUOgqoG7YSCAY0hX3vV2gY9NH8doVmZ4CmwTXKHVXk9iaRa7+IyZZCetsF8vuzWVnT1LZONpDRlYzRdhmT/TJZ3XoqBiysBP07l7Idj8eq0bcmcKUlBUNjEmktSSqh76dP/W6bbsXUl0bWMwPGzjQKXxvJsumpe2cVthG2WP0dwb8aFgrC+AIhPrrnccw7Gfk6zvTSJFMLE8wuzYjFaC13TbeRbddT+MrIjf4szL2ZqtJHw9XowhGJ3AYPKTXfSK11c6nmK1cfL5Ne56eyK7Dbk2LoSthn2jD2ppLZrFfbzh/I5potlUfO++hCG1HO3nMTW/yFg9cGOZA9yEHjEDFFn8Uhbn6tbyhUqm0kkdsKDeQ9zySn+4qKxq40ap1CYSQqccfuJa9pkcIWr/CeV8XcxkVqXiwTjUpbNtlU2DPbgaE5kYTy0yRbz5O32bLTurkUxZjidKXgL6rve67cJgbX13g4dJeM9mSu29MF4VV1ptahSnSay/99L/caWUNNZTAUpH6slluv8tUsfV3IwFwvfwDcylIEtKMyTQAAAABJRU5ErkJggg==&apos;); background-size: cover; display: block;&quot;
  &gt;&lt;/span&gt;
  &lt;img
        class=&quot;gatsby-resp-image-image&quot;
        alt=&quot;20210630 3&quot;
        title=&quot;20210630 3&quot;
        src=&quot;/static/c6c2b54854eb943ebeefa9a280ab3ef4/38cea/20210630-3.png&quot;
        srcset=&quot;/static/c6c2b54854eb943ebeefa9a280ab3ef4/5a46d/20210630-3.png 300w,
/static/c6c2b54854eb943ebeefa9a280ab3ef4/0a47e/20210630-3.png 600w,
/static/c6c2b54854eb943ebeefa9a280ab3ef4/38cea/20210630-3.png 678w&quot;
        sizes=&quot;(max-width: 678px) 100vw, 678px&quot;
        style=&quot;width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;&quot;
        loading=&quot;lazy&quot;
      /&gt;
    &lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Components&lt;/strong&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;&lt;em&gt;M3DB&lt;/em&gt;&lt;/strong&gt; : 분산 시계열 DB.&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;&lt;em&gt;M3 Collector&lt;/em&gt;&lt;/strong&gt; : 애플리케이션으로부터 메트릭을 수집한다.&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;M3 Aggregator&lt;/strong&gt; : M3DB 노드에 메트릭을 저장하기 전에 stateful stream-based downsampling을 수행해 집계한다. 메트릭이 올바른 Aggregator 인스턴스로 라우팅되고, Aggregator 레플리카에 SPOF(Single Points of Failure)가 없도록 클러스터링과 레플리케이션을 지원한다.&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;&lt;em&gt;M3 Coordinator&lt;/em&gt;&lt;/strong&gt; : M3DB 위에서 query, storage interface를 제공하는 Prometheus sidecar. M3DB와 Prometheus 사이에 존재하는 브릿지 역할.&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;&lt;em&gt;M3 Query&lt;/em&gt;&lt;/strong&gt; : M3DB의 데이터를 쿼리하기 위한 분산 쿼리 엔진이다. 프로메테우스 호환 API를 제공하므로 Grafana와 같은 써드파티 솔루션도 사용 가능하다.&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;strong&gt;etcd의 사용&lt;/strong&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;M3 Aggregator는 클러스터링과 레플리케이션을 지원하는데, etcd의 election과 window tracking을 활용해서 이러한 상태를 관리한다.&lt;/li&gt;
&lt;li&gt;또한, M3 Aggregator의 집계 기능은 etcd에 저장된 동적 규칙을 사용한다.&lt;/li&gt;
&lt;li&gt;M3 Coordinator에서도 etcd에 저장된 동적 규칙을 이용해 메트릭의 집계를 수행한다.&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;다른 분산 시스템에서 시스템을 관리하는 용도로 주로 사용하는 듯.&lt;/p&gt;
&lt;h2 id=&quot;2-architecture&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#2-architecture&quot; aria-label=&quot;2 architecture permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;2. Architecture&lt;/h2&gt;
&lt;p&gt;&lt;span
      class=&quot;gatsby-resp-image-wrapper&quot;
      style=&quot;position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 700px; &quot;
    &gt;
      &lt;span
    class=&quot;gatsby-resp-image-background-image&quot;
    style=&quot;padding-bottom: 46%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAJCAYAAAAywQxIAAAACXBIWXMAAAsTAAALEwEAmpwYAAACDUlEQVQoz22S3U4TURSF58lMfAV9BW99AC/ESxGUNBASNQRjAleGYFRSCDcIIkpLi9Cm0MJQpu382vntz0zp9PPMEbxyJztr5px11t5ZeyuTyYQoivA8nyAIcV0Py7LRDRPbtkU6BGGIHwTybjgckr3JUNcNtOsmrZZGv99nPB6jcBtxHEvMDnu9HsNBHzfo3Z5PGKepvB+NEomBKOC5XS40nY5p4fue5CpZtUv1ilL5mGZTk4KiBX41u3w4aLJ9ohMNhOgklZ0flY6pnZ2TjG5koYb+m3CQyPsslDhOWHyzxGxugbfL72VnUZzyeDHPwyeveTC1QvmqKx9vbG0zMzfP9Ksc5/UGhmHQ1jRsy6LT6QjbPJTRaETpqMjPg32KxYLwzEJrGyznCyys7TG/tkupphJ4LpVKRfC+80NkJpaJNBoNVFWV2Gq1UIZJQu7jV56ubLH4aVcY38W0HB4t7XPv+Sb3p7f5VmlyMwhZ3yvzbHWLKcEt1xqyu/N6XYrVBWriX0kzD3WHalNHNRxhxV8vanZMvuqwU+/ezQ3b73Gqtql3HAbCqlhMOhtOKLYgw39TNgXxynLxhbm2H1G9NjG8SBptdn3O2o7g9OknN5LXdkNG45T/hZKtw9LOKbMbBdaLFxRUk5fiO7dZ4qTl8G63yovPh2wcqxxemsx8KTCXP0L3elIgTSdyL+/yD0unjKiFXGI/AAAAAElFTkSuQmCC&apos;); background-size: cover; display: block;&quot;
  &gt;&lt;/span&gt;
  &lt;img
        class=&quot;gatsby-resp-image-image&quot;
        alt=&quot;20210630 4&quot;
        title=&quot;20210630 4&quot;
        src=&quot;/static/308eee5d40669087eff29e14325be80e/8c557/20210630-4.png&quot;
        srcset=&quot;/static/308eee5d40669087eff29e14325be80e/5a46d/20210630-4.png 300w,
/static/308eee5d40669087eff29e14325be80e/0a47e/20210630-4.png 600w,
/static/308eee5d40669087eff29e14325be80e/8c557/20210630-4.png 700w&quot;
        sizes=&quot;(max-width: 700px) 100vw, 700px&quot;
        style=&quot;width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;&quot;
        loading=&quot;lazy&quot;
      /&gt;
    &lt;/span&gt;&lt;/p&gt;
&lt;p&gt;(&lt;a href=&quot;https://alibaba-cloud.medium.com/getting-started-with-kubernetes-etcd-a26cba0b4258&quot;&gt;https://alibaba-cloud.medium.com/getting-started-with-kubernetes-etcd-a26cba0b4258&lt;/a&gt;)&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;etcd의 백엔드 DB는 BoltDB로 구성되어 있다. Go로 작성되었으며, 빠르고 가벼운 Key-Value Store이다.&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;공식 깃허브 &lt;a href=&quot;https://github.com/boltdb/bolt&quot;&gt;링크&lt;/a&gt;로 들어가보니 리포지토리가 아카이브 되었고, 17년을 마지막으로 더 릴리즈가 올라오지 않고 있다.&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;etcd는 주로 3개의 노드나 5개의 홀수 개 노드로 구성되며, 노드들은 &lt;em&gt;Raft&lt;/em&gt; 합의 알고리즘을 이용해 협력한다.&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Quorum(정족수)은 &lt;span class=&quot;katex&quot;&gt;&lt;span class=&quot;katex-mathml&quot;&gt;&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;semantics&gt;&lt;mrow&gt;&lt;mfrac&gt;&lt;mrow&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/mfrac&gt;&lt;/mrow&gt;&lt;annotation encoding=&quot;application/x-tex&quot;&gt;{n+1 \over 2}&lt;/annotation&gt;&lt;/semantics&gt;&lt;/math&gt;&lt;/span&gt;&lt;span class=&quot;katex-html&quot; aria-hidden=&quot;true&quot;&gt;&lt;span class=&quot;base&quot;&gt;&lt;span class=&quot;strut&quot; style=&quot;height:1.190108em;vertical-align:-0.345em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;mord&quot;&gt;&lt;span class=&quot;mord&quot;&gt;&lt;span class=&quot;mopen nulldelimiter&quot;&gt;&lt;/span&gt;&lt;span class=&quot;mfrac&quot;&gt;&lt;span class=&quot;vlist-t vlist-t2&quot;&gt;&lt;span class=&quot;vlist-r&quot;&gt;&lt;span class=&quot;vlist&quot; style=&quot;height:0.845108em;&quot;&gt;&lt;span style=&quot;top:-2.6550000000000002em;&quot;&gt;&lt;span class=&quot;pstrut&quot; style=&quot;height:3em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;sizing reset-size6 size3 mtight&quot;&gt;&lt;span class=&quot;mord mtight&quot;&gt;&lt;span class=&quot;mord mtight&quot;&gt;2&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&quot;top:-3.23em;&quot;&gt;&lt;span class=&quot;pstrut&quot; style=&quot;height:3em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;frac-line&quot; style=&quot;border-bottom-width:0.04em;&quot;&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&quot;top:-3.394em;&quot;&gt;&lt;span class=&quot;pstrut&quot; style=&quot;height:3em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;sizing reset-size6 size3 mtight&quot;&gt;&lt;span class=&quot;mord mtight&quot;&gt;&lt;span class=&quot;mord mathdefault mtight&quot;&gt;n&lt;/span&gt;&lt;span class=&quot;mbin mtight&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;mord mtight&quot;&gt;1&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;vlist-s&quot;&gt;​&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;vlist-r&quot;&gt;&lt;span class=&quot;vlist&quot; style=&quot;height:0.345em;&quot;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;mclose nulldelimiter&quot;&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;로 설정되어, 5노드 클러스터에서 2개 노드에서 fail이 발생해도 fault-tolerant하도록 구성되었다.&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;클러스터에서 노드들은 &lt;em&gt;leader&lt;/em&gt;와 &lt;em&gt;follower&lt;/em&gt;로 구분되고, leader는 알고리즘에 따라 선출된다.&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;leader는 follower들을 관리하고, 클라이언트에서 들어온 요청을 수락하고 follower에게 포워딩한다.&lt;/li&gt;
&lt;li&gt;만약 leader에서 fail이 발생한다면, 자동으로 다른 노드를 leader로 선출한다.&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&quot;21-raft-consensus-algorithm&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#21-raft-consensus-algorithm&quot; aria-label=&quot;21 raft consensus algorithm permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;2.1 Raft consensus algorithm&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;복잡한 Lamport의 Paxos 알고리즘보다 더 이해하기 쉽게 설계된 consensus 알고리즘이다.&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;consensus&lt;/strong&gt; : 분산 시스템에서 노드들이 fault-tolerant하게 합의를 이루는 과정.&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;Raft의 각 노드는 &lt;em&gt;Follower&lt;/em&gt;, &lt;em&gt;Candidate&lt;/em&gt;, &lt;em&gt;Leader&lt;/em&gt;의 세 가지 state를 가지는 state machine이다.&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;strong&gt;Raft consensus 과정 간단히 알아보기&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;&lt;span
      class=&quot;gatsby-resp-image-wrapper&quot;
      style=&quot;position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 417px; &quot;
    &gt;
      &lt;span
    class=&quot;gatsby-resp-image-background-image&quot;
    style=&quot;padding-bottom: 94.66666666666667%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAATCAYAAACQjC21AAAACXBIWXMAAAsTAAALEwEAmpwYAAAC00lEQVQ4y41UXU/TYBTurzMKYuJHvPI3CCLBGy+88EJv9G5CQNQIkwTDRVXAqIEoMUEgGwpssvGVwOjHuq7t1q0r2+M5b9vZASG8yUnP+/Wcnud9zpFwxmi1Wh3f9dw2lFJZ+M1ms2Pv5JDOAhJ+eNE0TSgzk1ifHIXlOKcCngSWzvor4ZP5NM8mh+D2d8O+142/8rsoWgdYHFRqT8ID0fy44aHk1pF+m0Cl/yqs+z1IT4/D9nzaa3QEjwNL7QVOkY38arUKTdNQLBaxs7ePleQIVqfeYP/gEEVdF3uu6yIkVRhzKwCjX22GVqvVoCoK9PCiYRjQ7QqKliMC8Jqm6VBVFW6t3r7XTrlQKMCpUrSNJWxNJJDNbMIolcTFCFSjy8LCNZ3X9CIM9Qjut/fIyJM4VIJ9aXntDwqLn9F6eBvV3stIDz+BUrYJQBGp87AsC7ZtC9+hl9YoA5X+2JXHUO+7AmfwOmZeDSGT3wlTPsjBfnAT5b4upMaeQ2VAusTp82CwSqUifMGvchQAziVRH7iGQl8P9lZ+BikzmczB3sIsVieGsb27K3gTHIXEM6ATapCBeU+j1PmBduQJbH79CK8ZSK0tGxaCRlEZLCBeOxdQcEmmmBZaMS23AX3Pgx4j/iKAQlq6Bj+mSykuyhK/Lh8mU8/lUAnOkHFpxkUuxUvHpcMqa4xTt2yYFIBfmGlgi3yVGoXQJvlR0AhDitcuLzkGAX5KYlmewhFpLdIfm0pS0s0y7N9L2BhPIJ/bOlWCHaXHgC15BF5/F7TBW0j9mEfJsgMaNFWAFdZ+ofHoDlzSX+bFY3gn+sD/btM8DpzZ16jcvQRl4AbWFhdglC3Bp0raM4iK1JwMpbdbAG6PPhXqiLpPu31FE5P+ZiO1inwygc0vH4S2+AWZJzbf9+E2fGTnppF++QzfF+ZR97xODuOTEpG8lcvjIoN7ZSabhROWZITxD01QkDJwQPxQAAAAAElFTkSuQmCC&apos;); background-size: cover; display: block;&quot;
  &gt;&lt;/span&gt;
  &lt;img
        class=&quot;gatsby-resp-image-image&quot;
        alt=&quot;20210630 5&quot;
        title=&quot;20210630 5&quot;
        src=&quot;/static/b388d4253ceb5cb16497b8f6538cbcd3/f27fb/20210630-5.png&quot;
        srcset=&quot;/static/b388d4253ceb5cb16497b8f6538cbcd3/5a46d/20210630-5.png 300w,
/static/b388d4253ceb5cb16497b8f6538cbcd3/f27fb/20210630-5.png 417w&quot;
        sizes=&quot;(max-width: 417px) 100vw, 417px&quot;
        style=&quot;width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;&quot;
        loading=&quot;lazy&quot;
      /&gt;
    &lt;/span&gt;&lt;/p&gt;
&lt;p&gt;그림 &lt;span class=&quot;katex&quot;&gt;&lt;span class=&quot;katex-mathml&quot;&gt;&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;semantics&gt;&lt;mrow&gt;&lt;msub&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;annotation encoding=&quot;application/x-tex&quot;&gt;t_1&lt;/annotation&gt;&lt;/semantics&gt;&lt;/math&gt;&lt;/span&gt;&lt;span class=&quot;katex-html&quot; aria-hidden=&quot;true&quot;&gt;&lt;span class=&quot;base&quot;&gt;&lt;span class=&quot;strut&quot; style=&quot;height:0.76508em;vertical-align:-0.15em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;mord&quot;&gt;&lt;span class=&quot;mord mathdefault&quot;&gt;t&lt;/span&gt;&lt;span class=&quot;msupsub&quot;&gt;&lt;span class=&quot;vlist-t vlist-t2&quot;&gt;&lt;span class=&quot;vlist-r&quot;&gt;&lt;span class=&quot;vlist&quot; style=&quot;height:0.30110799999999993em;&quot;&gt;&lt;span style=&quot;top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;&quot;&gt;&lt;span class=&quot;pstrut&quot; style=&quot;height:2.7em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;sizing reset-size6 size3 mtight&quot;&gt;&lt;span class=&quot;mord mtight&quot;&gt;1&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;vlist-s&quot;&gt;​&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;vlist-r&quot;&gt;&lt;span class=&quot;vlist&quot; style=&quot;height:0.15em;&quot;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;span
      class=&quot;gatsby-resp-image-wrapper&quot;
      style=&quot;position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 425px; &quot;
    &gt;
      &lt;span
    class=&quot;gatsby-resp-image-background-image&quot;
    style=&quot;padding-bottom: 93.66666666666667%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAATCAYAAACQjC21AAAACXBIWXMAAAsTAAALEwEAmpwYAAADHklEQVQ4y3VUW08TQRjdv0Z8MMaY+OIbDz7oA2pU0BgF4yUobwYDJt6IBE0kiiQqERMe0KgFRFGwWORSCrSlnb1vu73spXv8ZtqupdRNZzub+b4zZ853vpHQ6gkC+gViqmg6YhubYl6pVGrLAf73SHtxqoH8HdSSS4aGHxNj0DStutYA2gpYal7cE+g5wHAvnItHEBu8Dtv10Sp+D2DrxQAuMbGzaXi9x1E4exDbtzqwk2G11SAEbc4XgEKzii9CuU6WZUFmDIz0s+an4bwYwG50ARlFhaoocIqlmqYBfIrnOXVgKdSMB9DQdR2MwBRK5EM2LDDLhmIY9C0jKzPEklvI5/Oti1Isk06ei+LSDPTdFGRVgyLLkOuDwGWWhUnsLGJsqCqeLEcwtfoTiXgaE1MRMIrzCIMzlSJzXxG8GoR9/hBKQzerrCiAV9VxHBQKBZi6gVU1g8XsNgwCNnMmno+/RUfPMNrP3UPn5duYiXxBuVyG5HEJH3Qjf6oN3p0zULMZ2lGBYejiCC7tnDNMRFgC06k1WKqOcrGAoZGXaO96iI5ro+i62o+K7/JS1HzIduC+fgQj+g0yseHHNEgzAei60HQt1ChDa2mFYSsex92Bp+jpe4xf0VhYJKpy1ahayaWqGqF+jYC8UD6Po4SR37OYXFvErirjzco88qa2p4skYSF6WXRELn5dw2bA6vE9rO8mqTAaFrbXMb7yHRXHo33++VGqm5KLL+zCGWazIaBHIHVAzoKDKbzyZB8+5xs2dk8I6Pu+8BkjDRl5TyV72LYtTM7n3He5HBmeqsysPOlqhIVr7BipseUKjgt1dRn60pzwIxMeZEICPufV14nZzsdJLM3PifZs7udaL1eq3SKn4PadQPnSUeQ/v4Ns5kiCWtdwKYhVabQfzoXDiN84SezNfZeFVL+SxGd6A173MeROH0B58hmyZp70zFTZcabUKf79K7A62oCBTp5YzWtmWBc8mU7D/jQBfBhDpWjDoYIUCrbQskhFc3kTsCTwfgSp2WnBeB/DxqsnGo1CydnhJdvyMq/9/4lvIpFI7AP8CxpYkqz8O569AAAAAElFTkSuQmCC&apos;); background-size: cover; display: block;&quot;
  &gt;&lt;/span&gt;
  &lt;img
        class=&quot;gatsby-resp-image-image&quot;
        alt=&quot;20210630 6&quot;
        title=&quot;20210630 6&quot;
        src=&quot;/static/16d02389f3250d277e3828778d780644/2fbbf/20210630-6.png&quot;
        srcset=&quot;/static/16d02389f3250d277e3828778d780644/5a46d/20210630-6.png 300w,
/static/16d02389f3250d277e3828778d780644/2fbbf/20210630-6.png 425w&quot;
        sizes=&quot;(max-width: 425px) 100vw, 425px&quot;
        style=&quot;width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;&quot;
        loading=&quot;lazy&quot;
      /&gt;
    &lt;/span&gt;&lt;/p&gt;
&lt;p&gt;그림 &lt;span class=&quot;katex&quot;&gt;&lt;span class=&quot;katex-mathml&quot;&gt;&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;semantics&gt;&lt;mrow&gt;&lt;msub&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;annotation encoding=&quot;application/x-tex&quot;&gt;t_2&lt;/annotation&gt;&lt;/semantics&gt;&lt;/math&gt;&lt;/span&gt;&lt;span class=&quot;katex-html&quot; aria-hidden=&quot;true&quot;&gt;&lt;span class=&quot;base&quot;&gt;&lt;span class=&quot;strut&quot; style=&quot;height:0.76508em;vertical-align:-0.15em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;mord&quot;&gt;&lt;span class=&quot;mord mathdefault&quot;&gt;t&lt;/span&gt;&lt;span class=&quot;msupsub&quot;&gt;&lt;span class=&quot;vlist-t vlist-t2&quot;&gt;&lt;span class=&quot;vlist-r&quot;&gt;&lt;span class=&quot;vlist&quot; style=&quot;height:0.30110799999999993em;&quot;&gt;&lt;span style=&quot;top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;&quot;&gt;&lt;span class=&quot;pstrut&quot; style=&quot;height:2.7em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;sizing reset-size6 size3 mtight&quot;&gt;&lt;span class=&quot;mord mtight&quot;&gt;2&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;vlist-s&quot;&gt;​&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;vlist-r&quot;&gt;&lt;span class=&quot;vlist&quot; style=&quot;height:0.15em;&quot;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;그림 &lt;span class=&quot;katex&quot;&gt;&lt;span class=&quot;katex-mathml&quot;&gt;&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;semantics&gt;&lt;mrow&gt;&lt;msub&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;annotation encoding=&quot;application/x-tex&quot;&gt;t_1&lt;/annotation&gt;&lt;/semantics&gt;&lt;/math&gt;&lt;/span&gt;&lt;span class=&quot;katex-html&quot; aria-hidden=&quot;true&quot;&gt;&lt;span class=&quot;base&quot;&gt;&lt;span class=&quot;strut&quot; style=&quot;height:0.76508em;vertical-align:-0.15em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;mord&quot;&gt;&lt;span class=&quot;mord mathdefault&quot;&gt;t&lt;/span&gt;&lt;span class=&quot;msupsub&quot;&gt;&lt;span class=&quot;vlist-t vlist-t2&quot;&gt;&lt;span class=&quot;vlist-r&quot;&gt;&lt;span class=&quot;vlist&quot; style=&quot;height:0.30110799999999993em;&quot;&gt;&lt;span style=&quot;top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;&quot;&gt;&lt;span class=&quot;pstrut&quot; style=&quot;height:2.7em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;sizing reset-size6 size3 mtight&quot;&gt;&lt;span class=&quot;mord mtight&quot;&gt;1&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;vlist-s&quot;&gt;​&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;vlist-r&quot;&gt;&lt;span class=&quot;vlist&quot; style=&quot;height:0.15em;&quot;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/strong&gt;은 클러스터의 초기 상태를 나타냄. 모든 노드는 Follower이고, 타이머를 가지고 있다.&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;타이머는 Leader의 응답을 받지 못한 시간만큼 흘러가게 된다.&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;현재 Leader 노드가 없으므로, 먼저 timeout이 발생한 S2 노드가 Candidate로 전환되고 투표를 시작한다.&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;초록색 메세지는 자신을 Leader로 투표해 달라는 메세지이고, 자신은 자동으로 찬성한다.&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;span
      class=&quot;gatsby-resp-image-wrapper&quot;
      style=&quot;position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 420px; &quot;
    &gt;
      &lt;span
    class=&quot;gatsby-resp-image-background-image&quot;
    style=&quot;padding-bottom: 93.66666666666667%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAATCAYAAACQjC21AAAACXBIWXMAAAsTAAALEwEAmpwYAAADPUlEQVQ4y3VUS08TURTuj9OFRlm5wrhwo5tKFHHjQk0MC+MrIBqNsQGNxkejqDESQF4iKlVQUEsRebSdznRenZnOo6/p57m3w7RVuOlJ7vTMfOfxfedEsMOp1+uhsfMjtQrFMPnd9/3wnZ1OZCeg5r3xsfrtE5bH36Ds19vAWt//D7DVwe9BJkh9RfV8J6RTHUiNv274ybcbaGS3iPVqFQ5dS1PDsE/sRbnnAJLPYnBrCIP9lwQDDPvFogYvlkolaKqKvKxAzgnw3txHceQR8qKILSkHVVNRqVTCntZqfphMUDI9BJE8z4Usy01jwIYFiczSDcxtrGBgcRKa0gRt66HrOOBViJsorf+Cohc4kKoosDQdGgPNS4HlKWsZyewWFPLn6b+l5CZGxmaoKg+u6yEyPfcRwucp1HuPonT2EKz5ScgkkZwkYj77B7JtwqJnwzB4RpZpQqfsFFnCpb4hdF2M43D0Ki5f7cfy0nfqIRfaR9gn98E9tR/u2FPIpg1BzOFhKoEtx0DJdlAsFnlJDlXEeivmMug5fwvHzj5AZ9cA7t2Pt8iG9Faffg73VQyKKPC+KVQaKlXuNimrVkBJkmBZJsbGJ9F97iZ6rw/yNoUsc2bJpIIJJQDLU78c1w0BHdtuZkg+BsDKF4UMatVyg3HG8jZghaTCGq8E7KpUlud53Fe0LKhmAcuGBJuAGTmMlBxlyhKokmZD2WwDMj2p5GTsFhQN6xS56DrcV3ZcLAgbiKeXiUkXOgVLZTfRtzBBmtTaBqMpbPah7WJ0dQlfhD+IrXxCWm2Urek6N1RqMAoFCqwhXdDxNb0Gz3F2mRQGSb+57Br6R0cwPDaK4d+LiP9KwCAApj+RpJSnu5ZNY+X9OwiCuD137SUz84NNMpvYwOneF4ieuYk7b19iVc7RVCi8rwoTenodlRtnoHcfxFo81rYsWkavuef6hyZwpPs2ouce49jANcxkUlAkYp0IkLQCzJ9f4PZ0oBjdA7y+y1tV92vN0WvfgT4GHzxB5/ELuHjlHnTGYKnMZWMR0zb1i8/vzEv4j65AX0ui8s+OjDTKbWSXyWSQSMyDzbdfqwZrY+dTJsfU7IfGALQA/gV6PoaWzBYE/gAAAABJRU5ErkJggg==&apos;); background-size: cover; display: block;&quot;
  &gt;&lt;/span&gt;
  &lt;img
        class=&quot;gatsby-resp-image-image&quot;
        alt=&quot;20210630 7&quot;
        title=&quot;20210630 7&quot;
        src=&quot;/static/93ac93fbf9ccf8a58302d05e351df58e/d10fb/20210630-7.png&quot;
        srcset=&quot;/static/93ac93fbf9ccf8a58302d05e351df58e/5a46d/20210630-7.png 300w,
/static/93ac93fbf9ccf8a58302d05e351df58e/d10fb/20210630-7.png 420w&quot;
        sizes=&quot;(max-width: 420px) 100vw, 420px&quot;
        style=&quot;width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;&quot;
        loading=&quot;lazy&quot;
      /&gt;
    &lt;/span&gt;&lt;/p&gt;
&lt;p&gt;그림 &lt;span class=&quot;katex&quot;&gt;&lt;span class=&quot;katex-mathml&quot;&gt;&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;semantics&gt;&lt;mrow&gt;&lt;msub&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mn&gt;3&lt;/mn&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;annotation encoding=&quot;application/x-tex&quot;&gt;t_3&lt;/annotation&gt;&lt;/semantics&gt;&lt;/math&gt;&lt;/span&gt;&lt;span class=&quot;katex-html&quot; aria-hidden=&quot;true&quot;&gt;&lt;span class=&quot;base&quot;&gt;&lt;span class=&quot;strut&quot; style=&quot;height:0.76508em;vertical-align:-0.15em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;mord&quot;&gt;&lt;span class=&quot;mord mathdefault&quot;&gt;t&lt;/span&gt;&lt;span class=&quot;msupsub&quot;&gt;&lt;span class=&quot;vlist-t vlist-t2&quot;&gt;&lt;span class=&quot;vlist-r&quot;&gt;&lt;span class=&quot;vlist&quot; style=&quot;height:0.30110799999999993em;&quot;&gt;&lt;span style=&quot;top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;&quot;&gt;&lt;span class=&quot;pstrut&quot; style=&quot;height:2.7em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;sizing reset-size6 size3 mtight&quot;&gt;&lt;span class=&quot;mord mtight&quot;&gt;3&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;vlist-s&quot;&gt;​&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;vlist-r&quot;&gt;&lt;span class=&quot;vlist&quot; style=&quot;height:0.15em;&quot;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;span
      class=&quot;gatsby-resp-image-wrapper&quot;
      style=&quot;position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 429px; &quot;
    &gt;
      &lt;span
    class=&quot;gatsby-resp-image-background-image&quot;
    style=&quot;padding-bottom: 91.66666666666667%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAASCAYAAABb0P4QAAAACXBIWXMAAAsTAAALEwEAmpwYAAADG0lEQVQ4y3VU+0/TUBTeH2qiv5hoUPFBJEYTfCBIVAL+oImAEoJReQgKChEY75cDJwwCMmDAnm1v261dt5bRfZ6269xDb3LT0/bc7zy+71wPKlY+n7e3a1vr+OgQx6ED2zZNs8qvdHkqwcrswqGVzQg63k8hHIkWQUuDlp7zVIK5Dmbh3bvgR+3jz7jU0I/uPm/B59+V2IDOS77KSTcMZLMapmaWUdc8iBtNwxj44oWWVul7tph9JbANaJXg9sZamqaB53lwtEUmYGHJh8mZJSTiMQiCAI7joGR1lHbQPDuzg5T1MHdKWWUIjA5ZgO5OJmWkUjLZzneBAIWAD1lZgCiJMKgSO0OrZCva9lYA/p0Ynnd58XFoAozx9mHGGGRZhkBPK4hli5IETkoiPTeM3mdPUPOgBw9beyCu+IBwDJ4MZbS4uIybTQOobR7FnaefsB/cAxNFaGq62AIllbJt43AH2a89ODjcR11jN+69mEZN4xBGu96BynBKzuVO0dY5giv3P+Bl9yji8ShEgeGYcWCGBj2TIV8HMKOkwB8d0H8O7Z39OF//BlfvvsL+yYnDskuGqipY9wcQDp9QdgxJQcTc0S6CCkOOCJCTSSfbnImkdxjqLyJpdxOzQwMIhSNODwnLU6ojTUtDYiJYgRSRyHBL1lWn8Rmyxe11mxh1dgS54EYRzKLFU6qjFGWxFznGUSIGng6kVdUBoZJ/RkPQ8yYxqiPBJPAUmLdkRCSVjmNZhqZxipn9bcyHdqClFEjEav7MRCIpYewggLSRJWGnwSUSkC22qQq1ENTF8FQqXaGmhyJhBAIBSNRLV3uKKNmtYMzZe3tBW/SmWT6yVbPMpDTau2dx4Xorvo1PQqUAMcoonIjbgPEEh94RP263DGJ8arlwWeSrAc8KfVjbiuLczde43NCH5ra3UGURE8EAxn9vkGQUfJ9eITEP4lrTCNq6xsrugeJt87fsPGUjoP5RBy7eaoVvzY9TGkdrOhiNmMV2NBojzdIAtPRhfHK+6gorI0XXDfxYXUEsFqXyePxvGXrWvih8vtWi4F2MP+efOI9DjbNWAAAAAElFTkSuQmCC&apos;); background-size: cover; display: block;&quot;
  &gt;&lt;/span&gt;
  &lt;img
        class=&quot;gatsby-resp-image-image&quot;
        alt=&quot;20210630 8&quot;
        title=&quot;20210630 8&quot;
        src=&quot;/static/c6d85673ac3c692432d84537a67844f9/3d026/20210630-8.png&quot;
        srcset=&quot;/static/c6d85673ac3c692432d84537a67844f9/5a46d/20210630-8.png 300w,
/static/c6d85673ac3c692432d84537a67844f9/3d026/20210630-8.png 429w&quot;
        sizes=&quot;(max-width: 429px) 100vw, 429px&quot;
        style=&quot;width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;&quot;
        loading=&quot;lazy&quot;
      /&gt;
    &lt;/span&gt;&lt;/p&gt;
&lt;p&gt;그림 &lt;span class=&quot;katex&quot;&gt;&lt;span class=&quot;katex-mathml&quot;&gt;&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;semantics&gt;&lt;mrow&gt;&lt;msub&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mn&gt;4&lt;/mn&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;annotation encoding=&quot;application/x-tex&quot;&gt;t_4&lt;/annotation&gt;&lt;/semantics&gt;&lt;/math&gt;&lt;/span&gt;&lt;span class=&quot;katex-html&quot; aria-hidden=&quot;true&quot;&gt;&lt;span class=&quot;base&quot;&gt;&lt;span class=&quot;strut&quot; style=&quot;height:0.76508em;vertical-align:-0.15em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;mord&quot;&gt;&lt;span class=&quot;mord mathdefault&quot;&gt;t&lt;/span&gt;&lt;span class=&quot;msupsub&quot;&gt;&lt;span class=&quot;vlist-t vlist-t2&quot;&gt;&lt;span class=&quot;vlist-r&quot;&gt;&lt;span class=&quot;vlist&quot; style=&quot;height:0.30110799999999993em;&quot;&gt;&lt;span style=&quot;top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;&quot;&gt;&lt;span class=&quot;pstrut&quot; style=&quot;height:2.7em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;sizing reset-size6 size3 mtight&quot;&gt;&lt;span class=&quot;mord mtight&quot;&gt;4&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;vlist-s&quot;&gt;​&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;vlist-r&quot;&gt;&lt;span class=&quot;vlist&quot; style=&quot;height:0.15em;&quot;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;물론 &lt;span class=&quot;katex&quot;&gt;&lt;span class=&quot;katex-mathml&quot;&gt;&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;semantics&gt;&lt;mrow&gt;&lt;msub&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mn&gt;3&lt;/mn&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;annotation encoding=&quot;application/x-tex&quot;&gt;t_3&lt;/annotation&gt;&lt;/semantics&gt;&lt;/math&gt;&lt;/span&gt;&lt;span class=&quot;katex-html&quot; aria-hidden=&quot;true&quot;&gt;&lt;span class=&quot;base&quot;&gt;&lt;span class=&quot;strut&quot; style=&quot;height:0.76508em;vertical-align:-0.15em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;mord&quot;&gt;&lt;span class=&quot;mord mathdefault&quot;&gt;t&lt;/span&gt;&lt;span class=&quot;msupsub&quot;&gt;&lt;span class=&quot;vlist-t vlist-t2&quot;&gt;&lt;span class=&quot;vlist-r&quot;&gt;&lt;span class=&quot;vlist&quot; style=&quot;height:0.30110799999999993em;&quot;&gt;&lt;span style=&quot;top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;&quot;&gt;&lt;span class=&quot;pstrut&quot; style=&quot;height:2.7em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;sizing reset-size6 size3 mtight&quot;&gt;&lt;span class=&quot;mord mtight&quot;&gt;3&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;vlist-s&quot;&gt;​&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;vlist-r&quot;&gt;&lt;span class=&quot;vlist&quot; style=&quot;height:0.15em;&quot;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;에서 보이듯이 S2가 시작한 투표가 끝나지 않은 상황에서 다른 노드도 투표를 시작할 수 있다.&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;S2에 대한 투표를 다른 노드들이 찬성하고, 나중에 온 S4의 투표 메세지는 반대(&lt;em&gt;마이너스 표시&lt;/em&gt;)한다.&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;S2가 Leader로 선출되고 나머지 Follower들에게 주기적으로 하트비트 메세지를 보낸다.&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;이 과정이 &lt;strong&gt;Leader Election&lt;/strong&gt; 과정이었고, 이후에 분산 시스템은 Leader를 통해서 데이터를 처리하게 된다.&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&quot;22-etcd-api&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#22-etcd-api&quot; aria-label=&quot;22 etcd api permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;2.2 etcd API&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;21년 6월 현재 기준으로 etcd API의 최신 버전은 v3.5이고, 모두 gRPC 서비스로 제공된다.&lt;/li&gt;
&lt;li&gt;각 노드에는 gRPC 서버가 있어서 클라이언트로부터 온 API 요청을 처리한다.&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;strong&gt;etcd RPC의 서비스 기능에 따른 분류&lt;/strong&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;KV&lt;/strong&gt; : 키 밸류 쌍에 대한 Create, Update, Fetch, Delete 연산&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Watch&lt;/strong&gt; : 키 변경에 대한 모니터링&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Lease&lt;/strong&gt; : Primitives for consuming client keep-alive messages.&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;strong&gt;etcd 클러스터를 관리하기 위한 서비스&lt;/strong&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;Auth&lt;/strong&gt; : role 기반 유저 인증&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Cluster&lt;/strong&gt; : Provides membership information and configuration facilities.&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Maintenance&lt;/strong&gt; : 리커버리를 위한 스냅샷, 저장소 조각모음, 멤버별 상태 정보 유지&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;span
      class=&quot;gatsby-resp-image-wrapper&quot;
      style=&quot;position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 712px; &quot;
    &gt;
      &lt;span
    class=&quot;gatsby-resp-image-background-image&quot;
    style=&quot;padding-bottom: 72.33333333333334%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAOCAYAAAAvxDzwAAAACXBIWXMAAAsTAAALEwEAmpwYAAAB1klEQVQ4y61T2Y7iQAzM//8TtzgFmSSbixwQINygHQkSbmpSHvWIWe3DjrSWHNux2+2u6taSyRRvhoVhECGMYjiuB9fz0evrGI0T/LLdIh7CH4YY6AZsx8ObaRVxgCCMoRum5M/nCyja+XzG8XgsNPvULMPpdMLhcECW52A+L2LaLMsln+cn/H5/l7r7/S4xrTSUL574H/J8PqGxc5IkaLfbqFQq0HUd8/kc9Xod/X5ftNFooFaroVqtotlswjCMYtrsq4lSmVA5j8cDt9sNl8tF/Ov1Ksd4VR6bedb9OZkSabjf7xFFkehisUBaTDgejxGGIdJZKj51u91is9lgNBp91XOD16Yad9vtdrBtW9T3fSn0PA+WZUk8imPEhaZpKvAQFsau6wox3xr+C9A/qRFSJpOJENJqtYQM2sFgIH6n00G320WpVBJoKDyVwpV4s6Gy2t8mYPLV/kSkIcEmVsSFlvgRR5JimqZgNZvN4DiO1JAg5ukHwVAs61ar1ScpefEiuICAs8l0OhWfC5fLpViyHwSB1JFl/luv1wIX/3EdYyFFPRsljBUUrxdY4adEMfztyLzAfBkEvlwuCxk8DonhPyqJYdzr9eTKsI4xXxCvlsKbm34AF+4c/cEvDRAAAAAASUVORK5CYII=&apos;); background-size: cover; display: block;&quot;
  &gt;&lt;/span&gt;
  &lt;img
        class=&quot;gatsby-resp-image-image&quot;
        alt=&quot;20210630 9&quot;
        title=&quot;20210630 9&quot;
        src=&quot;/static/835bafe76b389c96a09e9538835f0a40/3d4b6/20210630-9.png&quot;
        srcset=&quot;/static/835bafe76b389c96a09e9538835f0a40/5a46d/20210630-9.png 300w,
/static/835bafe76b389c96a09e9538835f0a40/0a47e/20210630-9.png 600w,
/static/835bafe76b389c96a09e9538835f0a40/3d4b6/20210630-9.png 712w&quot;
        sizes=&quot;(max-width: 712px) 100vw, 712px&quot;
        style=&quot;width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;&quot;
        loading=&quot;lazy&quot;
      /&gt;
    &lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;a href=&quot;https://alibaba-cloud.medium.com/getting-started-with-kubernetes-etcd-a26cba0b4258&quot;&gt;https://alibaba-cloud.medium.com/getting-started-with-kubernetes-etcd-a26cba0b4258&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Data Model - Logical View&lt;/strong&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;em&gt;flat binary key space&lt;/em&gt;&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;etcd는 데이터를 multi-version으로 저장한다.&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;키의 버전은 1부터 시작하여 수정될 때마다 증가한다. 키가 삭제된 경우 버전을 0으로 재설정한다.&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;strong&gt;Data Model - Physical View&lt;/strong&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;etcd는 키 밸류 쌍을 &lt;strong&gt;&lt;em&gt;B+ Tree&lt;/em&gt;&lt;/strong&gt;로 저장한다.&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;B+ Tree는 키를 사전 순으로 정렬하여 저장하므로, Range Query가 매우 빠르다.&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;효율성을 위해 새로운 리비전을 모두 저장하지 않고, 이전 리비전과의 차이(delta)만 기록한다.&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;또한 etcd는 키에 대한 Range Query를 빠르게 하기 위해 인 메모리 B Tree를 하나 더 둔다.&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;이 B Tree에 있는 키는 유저에게 노출된다.&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id=&quot;3-etcd-in-kubernetes&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#3-etcd-in-kubernetes&quot; aria-label=&quot;3 etcd in kubernetes permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;3. etcd in Kubernetes&lt;/h2&gt;
&lt;p&gt;&lt;span
      class=&quot;gatsby-resp-image-wrapper&quot;
      style=&quot;position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 1200px; &quot;
    &gt;
      &lt;span
    class=&quot;gatsby-resp-image-background-image&quot;
    style=&quot;padding-bottom: 46.666666666666664%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAJCAYAAAAywQxIAAAACXBIWXMAAAsTAAALEwEAmpwYAAACEUlEQVQozz2SbW/SUBiG+ad+9K9oYvygP8BvmjhZpkOzwQYU2p7SUvrKOjrWrkDLiHvROTI23S4Pxdjkyjltmuvcz/OciutHNNQh/YHPwPFoiyG6GeC4HmEYEkVRiR8EBL5LWw9R5D+ea5PnBevn4f6O2fcVyfw3FUWzefE+p9b08WydNx9T3n0Z0+120DTtP6rEFArPX8U8e5mhqhppmpTCeZ5heDOCsz9UTMtG1W06qonZEwijh6I79Mw+lmXKVX7/hyXZb9t8azryECGFaSn8dXNFPyw4mkqhYTlYA1uWbGNI2duthNqhi9rtlsmEMCSiFBo9E2dg4cty1+9ZlvH0BHfLG6KzG7zkgYrVbDPc+cCg08I0dHYOhuweOCiKgud5LM5zTk/HpEnCvJgRxyfMphMm2RnT6YzHxyceVreMJrf4qRQ6hw22q4J6tY4ldKp1H03YsnSLMHCp6bIcP8Ubnpb70XFEq38uKWTvJpuhrJbEE5lyKofitJrs1kyUzw36huD11pxaK5L9NMqpfhWX2MFGuN6PRse0+3NJLhNvhPcy4cn0lqNMJtRVA0tpojbq7O0foOsGHc2iq22EVeWCnpsyCMZ8Ui45lgn3REFd5BSzrBReX10wmf+kuHykEo1inOAIL4zw/FAylHduSBBs7mCSjDmJ45JE9jKOR2VP1+tisSiFy+WSH9dXrFZ3/AUzF3FIUMRNFQAAAABJRU5ErkJggg==&apos;); background-size: cover; display: block;&quot;
  &gt;&lt;/span&gt;
  &lt;img
        class=&quot;gatsby-resp-image-image&quot;
        alt=&quot;20210630 10&quot;
        title=&quot;20210630 10&quot;
        src=&quot;/static/18995d04e58c023289df4de7a1d426ea/c1b63/20210630-10.png&quot;
        srcset=&quot;/static/18995d04e58c023289df4de7a1d426ea/5a46d/20210630-10.png 300w,
/static/18995d04e58c023289df4de7a1d426ea/0a47e/20210630-10.png 600w,
/static/18995d04e58c023289df4de7a1d426ea/c1b63/20210630-10.png 1200w,
/static/18995d04e58c023289df4de7a1d426ea/0d0e4/20210630-10.png 1230w&quot;
        sizes=&quot;(max-width: 1200px) 100vw, 1200px&quot;
        style=&quot;width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;&quot;
        loading=&quot;lazy&quot;
      /&gt;
    &lt;/span&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;쿠버네티스에서는 etcd를 클러스터의 데이터(설정 데이터, 클러스터 상태, 메타데이터 등)를 관리하는 용도로 사용한다.&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;etcd는 분산 환경에서 고가용성, consistency, fault-tolerance 등을 지원하므로 쿠버네티스의 백엔드로 사용하기 적합하다.&lt;/li&gt;
&lt;li&gt;etcd의 &lt;code class=&quot;language-text&quot;&gt;Watch&lt;/code&gt; 기능은 키의 수정에 대한 모니터링을 제공하므로, 클러스터를 &lt;strong&gt;선언한 상태(Desired State)&lt;/strong&gt;로 계속해서 유지하려 하는 쿠버네티스에 적합하다.&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;쿠버네티스에서 etcd를 접근할 때는 반드시 kube-apiserver를 통해서만 접근이 가능하다.&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;kubectl 명령 등으로 쿠버네티스 클러스터의 데이터를 읽는 명령은 모두 etcd에 저장된 데이터를 읽어 제공된다.&lt;/p&gt;
&lt;p&gt;(예시로 kube-system 네임스페이스로 구동되고 있는 파드의 이름들을 출력해봤다.)&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;kubectl 사용&lt;/strong&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;bash&quot;&gt;&lt;pre class=&quot;language-bash&quot;&gt;&lt;code class=&quot;language-bash&quot;&gt;$ kubectl get pods -n kube-system -o name

pod/coredns-74ff55c5b-ksmcb
pod/coredns-74ff55c5b-wjxnx
pod/dragon-tf-operator
pod/etcd-dnclab1-master
pod/kube-apiserver-dnclab1-master
pod/kube-controller-manager-dnclab1-master
pod/kube-flannel-ds-22cdr
pod/kube-flannel-ds-5lqc4
pod/kube-flannel-ds-js4jq
pod/kube-flannel-ds-ld9bs
pod/kube-proxy-9nvqm
pod/kube-proxy-ft77b
pod/kube-proxy-hxlhd
pod/kube-proxy-s6nbd
pod/kube-scheduler-dnclab1-master
pod/kube-state-metrics-5c544bc55-ffzpd
pod/metrics-server-5f8ff9b957-bpdm5
pod/nvidia-device-plugin-daemonset-1.12-9xcpn
pod/nvidia-device-plugin-daemonset-1.12-pptfm
pod/nvidia-device-plugin-daemonset-1.12-qnhxm&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;etcdctl 사용&lt;/strong&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;bash&quot;&gt;&lt;pre class=&quot;language-bash&quot;&gt;&lt;code class=&quot;language-bash&quot;&gt;$ &lt;span class=&quot;token assign-left variable&quot;&gt;ETCDCTL_API&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;3&lt;/span&gt; etcdctl --endpoints&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;localhost:2379 &lt;span class=&quot;token punctuation&quot;&gt;\&lt;/span&gt;
		--cacert /etc/kubernetes/pki/etcd/ca.crt &lt;span class=&quot;token punctuation&quot;&gt;\&lt;/span&gt;
		--cert /etc/kubernetes/pki/etcd/server.crt &lt;span class=&quot;token punctuation&quot;&gt;\&lt;/span&gt;
		--key /etc/kubernetes/pki/etcd/server.key &lt;span class=&quot;token punctuation&quot;&gt;\&lt;/span&gt;
		get /registry/pods/kube-system &lt;span class=&quot;token punctuation&quot;&gt;\&lt;/span&gt;
			--prefix --keys-only

/registry/pods/kube-system/coredns-74ff55c5b-ksmcb
/registry/pods/kube-system/coredns-74ff55c5b-wjxnx
/registry/pods/kube-system/dragon-tf-operator
/registry/pods/kube-system/etcd-dnclab1-master
/registry/pods/kube-system/kube-apiserver-dnclab1-master
/registry/pods/kube-system/kube-controller-manager-dnclab1-master
/registry/pods/kube-system/kube-flannel-ds-22cdr
/registry/pods/kube-system/kube-flannel-ds-5lqc4
/registry/pods/kube-system/kube-flannel-ds-js4jq
/registry/pods/kube-system/kube-flannel-ds-ld9bs
/registry/pods/kube-system/kube-proxy-9nvqm
/registry/pods/kube-system/kube-proxy-ft77b
/registry/pods/kube-system/kube-proxy-hxlhd
/registry/pods/kube-system/kube-proxy-s6nbd
/registry/pods/kube-system/kube-scheduler-dnclab1-master
/registry/pods/kube-system/kube-state-metrics-5c544bc55-ffzpd
/registry/pods/kube-system/metrics-server-5f8ff9b957-bpdm5
/registry/pods/kube-system/nvidia-device-plugin-daemonset-1.12-9xcpn
/registry/pods/kube-system/nvidia-device-plugin-daemonset-1.12-pptfm
/registry/pods/kube-system/nvidia-device-plugin-daemonset-1.12-qnhxm&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;글 초반에 서술했듯이 키는 계층적으로 저장되고 있으며, kube-system 네임스페이스를 나타내는 키 밑에 파드들의 키 또한 생성되어 있다. 조회하고 싶은 파드에 대한 키로 조회하면 해당 파드에 대한 설정을 얻을 수 있다.  &lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;클러스터에 존재하는 파드에 대한 상태 정보는 &lt;code class=&quot;language-text&quot;&gt;/registry/pods/{namespace}/{pod_name}&lt;/code&gt; 키에 존재한다.&lt;/li&gt;
&lt;li&gt;네임스페이스에 대한 정보는 &lt;code class=&quot;language-text&quot;&gt;/registry/namespaces/{namespace}&lt;/code&gt; 키에 존재한다.&lt;/li&gt;
&lt;li&gt;이와 같이 etcd는 쿠버네티스 클러스터를 운영함에 있어 중요한 데이터들이 관리되고 있으므로, etcd의 백업 또한 매우 중요하다. (CKA 시험에서 필수로 나온다고 들었다)&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id=&quot;4-vs-other-dbs&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#4-vs-other-dbs&quot; aria-label=&quot;4 vs other dbs permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;4. vs other DBs&lt;/h2&gt;
&lt;p&gt;etcd는 key-value store이고 성능도 좋아보이는데, 다른 NoSQL 데이터베이스들을 아예 대체해서 사용할 수는 없을까?&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;etcd는 메인 데이터베이스로 주로 쓰이는 MongoDB 등의 DBMS와 달리, 분산 시스템의 네트워크 장애 등 상황에서 한정된 양의 데이터를 보다 더 신뢰성 있게(reliable) 관리하는 것에 중점을 두고 개발되었다.&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;메타데이터와 같은 작은 키밸류 쌍을 저장하는 것으로 설계되었기 때문에 요청은 최대 1.5 MiB로 한정되어 있다.&lt;/li&gt;
&lt;li&gt;etcd 스토리지의 사이즈는 기본 2GB로 설정되어 있으며 권장되는 최대 사이즈는 8GB이다.&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;또한 안정성과 일관성을 위해 디스크에 데이터를 유지하므로, 어느정도 속도의 희생이 있다.&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id=&quot;references&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#references&quot; aria-label=&quot;references permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;References&lt;/h2&gt;
&lt;p&gt;&lt;strong&gt;M3&lt;/strong&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href=&quot;https://eng.uber.com/m3/&quot;&gt;https://eng.uber.com/m3/&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://medium.com/dataseries/uber-m3-is-an-open-source-large-scaltime-series-metrics-platform-d583aef37b07&quot;&gt;https://medium.com/dataseries/uber-m3-is-an-open-source-large-scaltime-series-metrics-platform-d583aef37b07&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;strong&gt;etcd&lt;/strong&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href=&quot;https://alibaba-cloud.medium.com/getting-started-with-kubernetes-etcd-a26cba0b4258&quot;&gt;https://alibaba-cloud.medium.com/getting-started-with-kubernetes-etcd-a26cba0b4258&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://www.ibm.com/cloud/learn/etcd&quot;&gt;https://www.ibm.com/cloud/learn/etcd&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://etcd.io/docs/v3.5/learning/data_model/&quot;&gt;https://etcd.io/docs/v3.5/learning/data_model/&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;strong&gt;vs NoSQL&lt;/strong&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href=&quot;https://stackoverflow.com/questions/41063238/using-etcd-as-primary-store-database&quot;&gt;https://stackoverflow.com/questions/41063238/using-etcd-as-primary-store-database&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://stackshare.io/stackups/etcd-vs-mongodb&quot;&gt;https://stackshare.io/stackups/etcd-vs-mongodb&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;</content:encoded></item><item><title><![CDATA[쿠버네티스 | 쿲벖넶팂슶 Ep.1]]></title><description><![CDATA[소개 쿠버네티스 공식 문서에서는 애플리케이션 배포 방법에 따라 3개의 시대로 나눈다. 전통적인 배포 시대(Traditional deployment era), 가상화된 배포 시대(Virtualized deployment era…]]></description><link>https://blog.frec.kr/cloud/kubernetes_1/</link><guid isPermaLink="false">https://blog.frec.kr/cloud/kubernetes_1/</guid><pubDate>Thu, 03 Jun 2021 15:43:00 GMT</pubDate><content:encoded>&lt;p&gt;&lt;span
      class=&quot;gatsby-resp-image-wrapper&quot;
      style=&quot;position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 1200px; &quot;
    &gt;
      &lt;span
    class=&quot;gatsby-resp-image-background-image&quot;
    style=&quot;padding-bottom: 21.666666666666668%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAECAYAAACOXx+WAAAACXBIWXMAAC4jAAAuIwF4pT92AAAA00lEQVQY02MwyHri7V334nZC76vPloVPlxqW/udiYGBgYeUS42BAAB4GYoFFwdMLC3Z9+n/ixo9/WVNe/5dM/OkNFJZmZGJtAUkDcSgQtwMxSDwRiAOBOBqI/YE4GYjTgDgWiCOAOJ7BvvTZk3k7P/3ffe7br5ypr/+rZ3xIAErwMTKxTQDSZUDcCMQNQNwGxJ1QjTFQfhcQg9R3AHEJEHczKCU8tvesffE2puvVf7P8pysZGPYzMjD8Z0h/8B/kATYohnmfFUozQmlmUPBAxUFsTgAC3EC8QpdcDwAAAABJRU5ErkJggg==&apos;); background-size: cover; display: block;&quot;
  &gt;&lt;/span&gt;
  &lt;img
        class=&quot;gatsby-resp-image-image&quot;
        alt=&quot;20210603 1&quot;
        title=&quot;20210603 1&quot;
        src=&quot;/static/e41528f5257d89d58028ff39c3c2f712/c1b63/20210603-1.png&quot;
        srcset=&quot;/static/e41528f5257d89d58028ff39c3c2f712/5a46d/20210603-1.png 300w,
/static/e41528f5257d89d58028ff39c3c2f712/0a47e/20210603-1.png 600w,
/static/e41528f5257d89d58028ff39c3c2f712/c1b63/20210603-1.png 1200w,
/static/e41528f5257d89d58028ff39c3c2f712/4929c/20210603-1.png 1727w&quot;
        sizes=&quot;(max-width: 1200px) 100vw, 1200px&quot;
        style=&quot;width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;&quot;
        loading=&quot;lazy&quot;
      /&gt;
    &lt;/span&gt;  &lt;/p&gt;
&lt;h2 id=&quot;소개&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#%EC%86%8C%EA%B0%9C&quot; aria-label=&quot;소개 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;소개&lt;/h2&gt;
&lt;p&gt;쿠버네티스 공식 문서에서는 애플리케이션 배포 방법에 따라 3개의 시대로 나눈다.&lt;/p&gt;
&lt;p&gt;&lt;em&gt;전통적인 배포 시대(Traditional deployment era)&lt;/em&gt;, &lt;em&gt;가상화된 배포 시대(Virtualized deployment era)&lt;/em&gt;, &lt;em&gt;컨테이너 개발 시대(Container deployment era)&lt;/em&gt;.&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;https://d33wubrfki0l68.cloudfront.net/26a177ede4d7b032362289c6fccd448fc4a91174/eb693/images/docs/container_evolution.svg&quot; alt=&quot;https://d33wubrfki0l68.cloudfront.net/26a177ede4d7b032362289c6fccd448fc4a91174/eb693/images/docs/container_evolution.svg&quot;&gt;&lt;/p&gt;
&lt;p&gt;전통적인 배포 시대에는 각 조직이 보유하고 있는 물리 서버에서 애플리케이션을 구동했었다. 알아야 할 것도 많고, 환경 구성부터 매우 복잡한 현대적 배포 방식과는 다르게 물리 서버에 애플리케이션을 올려두면 되는 어떻게 보면 간단한 방법이었다. 다만 서비스의 사용자에 따른 인프라의 탄력적인 확장(scaling)이 불가능했고, 서로 격리되지 않은 애플리케이션들이 영향을 주고받는 등 많은 문제가 발생했다.&lt;/p&gt;
&lt;p&gt;한 예시로, 구동 중인 어떤 애플리케이션이 리소스를 점점 많이 잡아먹더니, 서버의 한계만큼 차지한 상황을 보자. 서비스의 수요 증가에 대응하기 위해서 리소스를 더 할당해줘야 하는 것은 맞지만, 이로 인해 리소스를 더 요구하는 다른 애플리케이션이 영향을 받게 된다면 그 서비스는 장애가 발생할 것이다. 그러나 수요가 늘어난다고 다른 서비스에 할당될 리소스까지 할당해줄 수는 없다. 따라서 각 애플리케이션이 서로 격리되어야 할 필요성과, 리소스 할당에 한계를 두어야 할 필요성이 대두되었다.&lt;/p&gt;
&lt;p&gt;후에 발전한 가상화 기술은 전통적인 배포 시대 문제점들의 해결책이 되어주었다. &lt;strong&gt;가상화&lt;/strong&gt;를 도입하면서, 하나의 물리적인 서버를 여러 대의 논리적인 서버로 나누어 사용할 수 있게 되었다. 이렇게 나누어진 논리적인 서버는 &lt;strong&gt;가상 머신(VM, Virtual Machine)&lt;/strong&gt;이라고 불리며, 이 VM들은 서로 격리되어 각각 OS를 구동한다.&lt;/p&gt;
&lt;p&gt;가상화의 도입으로 시스템의 리소스를 하드웨어 레벨에서 나누어 각 VM에 할당할 수 있고, 전통적인 배포 방식보다 더 효율적으로 리소스를 사용할 수 있게 되었다.&lt;/p&gt;
&lt;p&gt;그러나 쿠버네티스 공식 사이트의 설명에 따르면 HW 레벨 가상화의 VM들은 OS를 포함한 모든 구성 요소를 실행하는 하나의 완전한 머신이므로 머신의 크기가 GB 단위를 넘어가며 너무나 크다는 단점이 있다. 이에 대한 해결책으로, 호스트 OS를 공유하여 조금 더 가벼운 격리 속성을 가진 &lt;strong&gt;컨테이너&lt;/strong&gt; 기술이 등장한다.&lt;/p&gt;
&lt;p&gt;컨테이너는 가벼운 VM이라고 생각하면 편한데, VM처럼 OS를 포함한 모든 종속성을 포함하는 것이 아닌, 동작할 애플리케이션의 종속성만을 포함해 묶은 것이라고 할 수 있다. &lt;/p&gt;
&lt;p&gt;이렇게 컨테이너를 이용함으로써 가볍고 빠르며 잘 격리된 환경에서 애플리케이션을 실행할 수 있게 되었다. 도커(Docker)의 등장 이후 많은 수의 애플리케이션들이 컨테이너화되어 배포되고 있다. 그러나 구글의 관점에서 볼 때, 너무나 많은 수의 컨테이너들이 배포되고 교체되어 관리의 복잡성이 증가하고 있었고, 컨테이너 간 네트워크 또한 이 복잡성에 크게 영향을 주고 있었다. 구글은 내부에서 사용하던 Borg라는 플랫폼을 통해 일주일에 20억 개 이상의 컨테이너를 배포하는 등 컨테이너들을 종합적으로 관리할 툴이 필요하게 되었다.&lt;/p&gt;
&lt;p&gt;쿠버네티스는 이러한 흐름 속에서, 여러 컨테이너들의 스케일링, 장애 처리, 배포 등을 종합적으로 &lt;strong&gt;오케스트레이션(Orchestration)&lt;/strong&gt;하는 플랫폼으로 개발되었다. 컨테이너에 대해 원하는 상태(desired state)를 미리 선언해두고, 쿠버네티스는 이 상태를 유지하기 위해 자동으로 rollout, rollback을 수행한다. 또한 컨테이너에서 fail이 발생한다면 다시 시작하고 교체하는 능력을 포함한다. 로드밸런싱을 통한 안정적인 네트워크 트래픽 처리 또한 포함하고 있다.&lt;/p&gt;
&lt;h2 id=&quot;쿠버네티스-클러스터-구축&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#%EC%BF%A0%EB%B2%84%EB%84%A4%ED%8B%B0%EC%8A%A4-%ED%81%B4%EB%9F%AC%EC%8A%A4%ED%84%B0-%EA%B5%AC%EC%B6%95&quot; aria-label=&quot;쿠버네티스 클러스터 구축 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;쿠버네티스 클러스터 구축&lt;/h2&gt;
&lt;h3 id=&quot;관리형-쿠버네티스-서비스&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#%EA%B4%80%EB%A6%AC%ED%98%95-%EC%BF%A0%EB%B2%84%EB%84%A4%ED%8B%B0%EC%8A%A4-%EC%84%9C%EB%B9%84%EC%8A%A4&quot; aria-label=&quot;관리형 쿠버네티스 서비스 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;관리형 쿠버네티스 서비스&lt;/h3&gt;
&lt;p&gt;&lt;strong&gt;GKE (Google Kubernetes Engine)&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;&lt;a href=&quot;https://cloud.google.com/kubernetes-engine&quot;&gt;GKE&lt;/a&gt;는 GCP(Google Cloud Platform)을 통해서 유저에게 제공된다. 쿠버네티스의 설치 등 클러스터 인프라 구축 작업과 유지 보수 작업은 모두 GCP에서 대신해준다. GKE는 구글의 &lt;a href=&quot;https://cloud.google.com/sdk/?utm_source=google&amp;#x26;utm_medium=cpc&amp;#x26;utm_campaign=japac-AU-all-en-dr-bkws-all-pkws-trial-e-dr-1009882&amp;#x26;utm_content=text-ad-none-none-DEV_c-CRE_495131377608-ADGP_Hybrid%20%7C%20BKWS%20-%20EXA%20%7C%20Txt%20~%20Developer%20Tools%20~%20Cloud%20SDK_cloud%20sdk-general%20-%20Products-44225-KWID_43700060418855956-kwd-76317487932&amp;#x26;userloc_1009871-network_g&amp;#x26;utm_term=KW_google%20cloud%20sdk&amp;#x26;gclid=Cj0KCQjw2NyFBhDoARIsAMtHtZ7hAYsUdZ_i1ZpDiJzjPTrZu0YhEnuo0fQLmG6y56TfIMAKn7DPfSAaAlR4EALw_wcB&amp;#x26;gclsrc=aw.ds&quot;&gt;클라우드 SDK&lt;/a&gt;를 사용해서 접근할 수 있으며, 간편하게 웹 콘솔을 이용할 수도 있다. 여러 개의 Failure Zone (AWS의 AZ, Available Zone에 대응)에 걸쳐서 워커 노드를 분산시켜 Multizone 클러스터를 구성할 수 있다.&lt;/p&gt;
&lt;p&gt;GKE는 클러스터의 워커 노드(Google Compute Engine 인스턴스를 사용)를 기준으로 노드가 생성됐을 때부터 삭제될 때까지 초 단위로 비용을 청구하는 과금 모델을 지원한다.&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;AWS EKS (Amazon Elastic Kubernetes Service)&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;EKS는 AWS를 통해서 제공된다. GKE와 마찬가지로 인프라 관련 작업은 아마존에서 자동으로 진행되며, AWS 웹 콘솔 및 AWS SDK를 통해서 접근할 수 있다.&lt;/p&gt;
&lt;p&gt;다만, 구글의 GKE나 마이크로소프트의 AKS와 비교했을 때 일반적으로 더 많은 비용이 든다고 한다.&lt;/p&gt;
&lt;h3 id=&quot;자체-호스팅을-위한-설치-툴&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#%EC%9E%90%EC%B2%B4-%ED%98%B8%EC%8A%A4%ED%8C%85%EC%9D%84-%EC%9C%84%ED%95%9C-%EC%84%A4%EC%B9%98-%ED%88%B4&quot; aria-label=&quot;자체 호스팅을 위한 설치 툴 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;자체 호스팅을 위한 설치 툴&lt;/h3&gt;
&lt;p&gt;&lt;strong&gt;kops&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;&lt;a href=&quot;https://github.com/kubernetes/kops&quot;&gt;kops&lt;/a&gt;는 클러스터 구축, 오케스트레이션 뿐만 아니라 프로비저닝까지 직접 수행하는 툴로, 클러스터의 생명주기 전반에 관여하고 있다. 온프레미스 환경보다는 클라우드 환경, 특히 AWS와 GCP에서 쿠버네티스를 직접 구축할 경우에 좋은 선택이 될 수 있다고 한다.&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;kubespray&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;&lt;a href=&quot;https://github.com/kubernetes-sigs/kubespray&quot;&gt;kubespray&lt;/a&gt;는 온프레미스 서버에 클러스터 구축하는데 중점을 두고 있으며, 멀티 플랫폼에서의 설치 또한 지원된다. kops와는 다르게 프로비저닝 등을 위해 &lt;strong&gt;Ansible&lt;/strong&gt;을 사용하기 때문에, Ansible에 익숙한 경우 편리하다고 한다. 그러나 멀티 플랫폼 환경이 아니라, 하나의 플랫폼만을 사용할 것이라면 kops가 더 유용할 수 있다.&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;kubeadm&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;&lt;a href=&quot;https://github.com/kubernetes/kubeadm&quot;&gt;kubeadm&lt;/a&gt;은 위의 다른 툴과는 다르게 인프라를 직접 다루기 보다는, 클러스터의 구축, 부트스트랩에만 관여한다. 대부분의 다른 설치 툴들이 내부적으로 kubeadm을 사용하고 있으므로 쿠버네티스 클러스터의 구축에 있어 가장 기본이 되는 툴이라고 할 수 있다. 온프레미스 서버나 클라우드 인스턴스에 설치하는데 적합하다고 한다. 처음 쿠버네티스를 공부하는 상황이라면 kubeadm을 사용해서 설치하는 것이 도움이 될 것이라고 생각한다.&lt;/p&gt;
&lt;h3 id=&quot;클러스터를-설치하기-전에&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#%ED%81%B4%EB%9F%AC%EC%8A%A4%ED%84%B0%EB%A5%BC-%EC%84%A4%EC%B9%98%ED%95%98%EA%B8%B0-%EC%A0%84%EC%97%90&quot; aria-label=&quot;클러스터를 설치하기 전에 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;클러스터를 설치하기 전에&lt;/h3&gt;
&lt;p&gt;쿠버네티스를 설치하기 위해서 각 노드는 다음 조건을 모두 만족해야 한다.&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;각 노드는 &lt;strong&gt;2GB&lt;/strong&gt; 이상의 RAM을 갖출 것&lt;/li&gt;
&lt;li&gt;각 노드는 &lt;strong&gt;2개 이상의 코어&lt;/strong&gt;를 가진 CPU를 갖출 것&lt;/li&gt;
&lt;li&gt;각 노드의 &lt;strong&gt;Swap을 비활성화&lt;/strong&gt;할 것&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;위의 조건들을 모두 만족해야 노드에서 kubelet이 구동될 수 있고, 클러스터에 참여할 수 있다.&lt;/p&gt;
&lt;h3 id=&quot;클러스터-규모-상한선&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#%ED%81%B4%EB%9F%AC%EC%8A%A4%ED%84%B0-%EA%B7%9C%EB%AA%A8-%EC%83%81%ED%95%9C%EC%84%A0&quot; aria-label=&quot;클러스터 규모 상한선 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;클러스터 규모 상한선&lt;/h3&gt;
&lt;p&gt;쿠버네티스 클러스터를 구성하기 위해 노드가 갖춰야 할 최소 조건을 알아봤으니, 클러스터가 가질 수 있는 최대 규모에 대해서도 가볍게 짚고 넘어가려 한다.&lt;/p&gt;
&lt;p&gt;v1.21 버전 기준 쿠버네티스는 다음과 같은 규모 제한이 있다. [1]&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;노드 : 최대 5000개&lt;/li&gt;
&lt;li&gt;노드 당 파드 수 : 최대 100개&lt;/li&gt;
&lt;li&gt;클러스터 전체 파드 수 : 최대 150,000개&lt;/li&gt;
&lt;li&gt;클러스터 전체 컨테이너 수 : 최대 300,000개&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;처음 클러스터를 구축하고 부하 실험을 하던 도중, 노드 당 파드 수 100개 제한에 걸려 파드가 더 생성이 되지 않았었다. 제한이 빡빡하다고 생각했었지만 노드에 fail이 발생했을 경우 100개의 파드에 장애가 생길 수 있다고 생각하니 적절한 제한이라고 느꼈다.&lt;/p&gt;
&lt;h2 id=&quot;references&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#references&quot; aria-label=&quot;references permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;References&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href=&quot;https://kubernetes.io/ko/docs/concepts/overview/what-is-kubernetes/&quot;&gt;https://kubernetes.io/ko/docs/concepts/overview/what-is-kubernetes/&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;J. Arundel, J. Domingus, Cloud Native DevOps with Kubernetes, O’Reilly Media, 2019.&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;(번역판) 쿠버네티스를 활용한 클라우드 네이티브 데브옵스 (최경현 옮김), 한빛미디어.&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;[1] &lt;a href=&quot;https://kubernetes.io/ko/docs/setup/best-practices/cluster-large/&quot;&gt;https://kubernetes.io/ko/docs/setup/best-practices/cluster-large/&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;</content:encoded></item><item><title><![CDATA[VirtualBox로 가상머신 만들어 Kubernetes 클러스터 구성하기]]></title><description><![CDATA[수정사항 2021.03.09 13:48 :: calico, flannel 설치 명령 오타 수정 2021.03.17 13:22 :: flannel 제외 2021.03.29 16.24 :: kubeadm init 시 pod-network-cidr…]]></description><link>https://blog.frec.kr/cloud/virtualbox_k8s/</link><guid isPermaLink="false">https://blog.frec.kr/cloud/virtualbox_k8s/</guid><pubDate>Mon, 08 Mar 2021 17:13:00 GMT</pubDate><content:encoded>&lt;p&gt;수정사항&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;2021.03.09 13:48 :: calico, flannel 설치 명령 오타 수정&lt;/li&gt;
&lt;li&gt;2021.03.17 13:22 :: flannel 제외&lt;/li&gt;
&lt;li&gt;2021.03.29 16.24 :: kubeadm init 시 pod-network-cidr 옵션 추가, calico 대신 flannel 설치&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id=&quot;환경&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#%ED%99%98%EA%B2%BD&quot; aria-label=&quot;환경 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;환경&lt;/h2&gt;
&lt;p&gt;&lt;strong&gt;호스트 서버&lt;/strong&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Ubuntu 18.04&lt;/li&gt;
&lt;li&gt;VirtualBox&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;strong&gt;VirtualBox 가상머신 * 4ea&lt;/strong&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;vCPU 2ea, RAM 2GiB&lt;/li&gt;
&lt;li&gt;Ubuntu Server 20.04&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id=&quot;virtualbox-설치&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#virtualbox-%EC%84%A4%EC%B9%98&quot; aria-label=&quot;virtualbox 설치 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;VirtualBox 설치&lt;/h2&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;bash&quot;&gt;&lt;pre class=&quot;language-bash&quot;&gt;&lt;code class=&quot;language-bash&quot;&gt;$ &lt;span class=&quot;token function&quot;&gt;sudo&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;apt&lt;/span&gt; update
$ &lt;span class=&quot;token function&quot;&gt;sudo&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;apt&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;install&lt;/span&gt; -y virtualbox
$ &lt;span class=&quot;token function&quot;&gt;sudo&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;apt&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;install&lt;/span&gt; -y virtualbox-ext-pack&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;h2 id=&quot;virtualbox로-가상머신-생성&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#virtualbox%EB%A1%9C-%EA%B0%80%EC%83%81%EB%A8%B8%EC%8B%A0-%EC%83%9D%EC%84%B1&quot; aria-label=&quot;virtualbox로 가상머신 생성 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;VirtualBox로 가상머신 생성&lt;/h2&gt;
&lt;p&gt;VirtualBox를 켜고, 먼저 각 노드들이 연결될 가상 네트워크를 하나 생성할 것이다.&lt;/p&gt;
&lt;p&gt;VirtualBox 화면에서 상단 메뉴의 File &gt; Preferences를 눌러 설정화면으로 들어가서 Networks 탭으로 들어간다. 우측의 네트워크 추가 버튼을 눌러 다음과 같이 설정한다. (10.0.0.0/8 대역은 사설 IP 대역이다.) &lt;/p&gt;
&lt;p&gt;&lt;span
      class=&quot;gatsby-resp-image-wrapper&quot;
      style=&quot;position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 747px; &quot;
    &gt;
      &lt;span
    class=&quot;gatsby-resp-image-background-image&quot;
    style=&quot;padding-bottom: 70%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAOCAYAAAAvxDzwAAAACXBIWXMAAAsTAAALEwEAmpwYAAACqklEQVQ4y32TaU8TQRzG93upEI9CavQVMfFA1E/hCxMjUaBSBTniK7+JMRI5Ss/tXbbntrvd++oBxSg8/mcqBvF48cszs7PzzP+YEW6Gr2IqdAXToQlMT00gdOMybt8K4fGju3g4ewdPSGfvz2COxg/ujZURnp7k/4eJ61OTmAtfwtOZaxCWFl4gGnmF6Osxy5GXWIku4f3GKt6tLGNz7S3WSNdXo+P5+go21t4gsjgPtjdCLCzMY3PxOT4sPoPg2gZqlSLKhSwqBRHVcp7GIkr5DHquidHAx1HPxVHfw4gYeBbnkL6dwdYHgYt+34dg6yokMknsbSOfjqMgpiCm9pHPJKHIdXTkJrqKTNqgeRM9nzYGHvpMz0OGvqVDYFHoSguZRAzFbBJZMk3EdlDKZVCXKiiViqhVqygX8ziolDEcDnA8OvqT4xEC14Lg2zr6lEIxm0IunSBNU5RJpOJ7kBtVNOo1KEqHDAvQNQ2npyc4+f4NX8mAmZzXwLUhOIbK02MRslRT+7vY2/6MNBm2mzUeJatpnkrRqB3weV0qw3dMStVBz7N/4VM/BNdUUc6LvCENqQSplP/VHLXd5JvFZIzDDt7Z+kSZxGHrCjxLg2d2Sc/QxikPA4cz8KmDvs3HrAyH1DVmGt/9wslSSVjz5LrE19le3zEQ/MSjucBPuYBrjk9zqRxWt40umbLGmTQ2VJmrpXU4bH62xg7gEV7Es5hqcCwDtm3BITRNhdIhc7UDlZrExqrShmkasEydq2v9xzAgQ83QIes2DK+HeCaLj1vbiIs57MRTRBJbuzFIrQ5MfwjN8SmAfxpqXF1Sy+jCJix6AB51kW0q0hWSDqj75RI67RaanSyydN1M+uevhudNg9++j2tcKeb4fa2W6W6qbbRkEQW6x+zV/QCAwceweViPywAAAABJRU5ErkJggg==&apos;); background-size: cover; display: block;&quot;
  &gt;&lt;/span&gt;
  &lt;img
        class=&quot;gatsby-resp-image-image&quot;
        alt=&quot;20210308 1&quot;
        title=&quot;20210308 1&quot;
        src=&quot;/static/7d45450d79ab328ec4eeffe5e2b488df/d54e4/20210308-1.png&quot;
        srcset=&quot;/static/7d45450d79ab328ec4eeffe5e2b488df/5a46d/20210308-1.png 300w,
/static/7d45450d79ab328ec4eeffe5e2b488df/0a47e/20210308-1.png 600w,
/static/7d45450d79ab328ec4eeffe5e2b488df/d54e4/20210308-1.png 747w&quot;
        sizes=&quot;(max-width: 747px) 100vw, 747px&quot;
        style=&quot;width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;&quot;
        loading=&quot;lazy&quot;
      /&gt;
    &lt;/span&gt;  &lt;/p&gt;
&lt;p&gt;이렇게 가상네트워크를 만들고 가상머신 생성을 시작한다. 이미지는 &lt;a href=&quot;https://ubuntu.com/download/server&quot;&gt;우분투 20.04 서버 이미지&lt;/a&gt;를 사용했다.&lt;/p&gt;
&lt;p&gt;&lt;span
      class=&quot;gatsby-resp-image-wrapper&quot;
      style=&quot;position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 1200px; &quot;
    &gt;
      &lt;span
    class=&quot;gatsby-resp-image-background-image&quot;
    style=&quot;padding-bottom: 58.333333333333336%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAMCAYAAABiDJ37AAAACXBIWXMAAAsTAAALEwEAmpwYAAACl0lEQVQoz42Sy08TURTGb2KiC1cu/BPc6NbowmhcqYkCAgvLFIEaQR660EQjGggLNRg3bCQxGIPviBpfKPRJW6BQoKUPpEyfUGin7TClFRDczOeZaXFhQsLil+/MOTffOffcYbV1HGp1WrlGp0UNxdqqSlRzlaQVaGyoQ0vTJTQ36nCtpR4Nl2vAacoL9SJKrNGUy3Wa87jOla6xm2eOy21nT6Dt1FE84Ergczkx43Xjp9eFgN9DTGNWwTeNGU8hp9S2UHKR4Czi0aC8EA6AlTGGG4cPyrerdejQVoH3TsE1OQ735Bi8rgl4qIFrwgGfW4kn4J+mutOh1pV4cT6M5XRCXs9LWF0RZfa1uxv3e75B0/oU7d2faBoPrGY9Ru1DsFmMGLGaMWTSwzlqx4jNAsewFfYhI8ZGbGrsdNhhMxvUZqKwCNZ+twsf9ePo7TOg53k/TTIF40A/mRpgMQ6S2SCGrSbV1GIYgJXUpP9BfCdjEzW2wG4xkPEwpHQS7EJFE45wHXjZ+xnVjZ3weT20Qxe8dB0f4acd+WmnXvekmlP2q+QCP32Iz0cgZYQC6SUiDvaovASVzZ24dacL3JV7CPFzWIiGEAvzmI8EVeKxMC1+DtHQHBLxGCmPfFbEak5CLptBfkXCciqGTJIHa93L4Oh6CNubD+itv4psPEIHROSWBSL1j7xUICcKyNN3NpNANk1kkmq8IqaINFj9HoYnJw/hLVeGx6ePIRnlkZPSNP7W4e0QyEBQNatqIc/O7WbQ7mMo3cVw8cB+JKJBuk6m2FXYnqLB/3k28PoZzO9fwfTuBexf+iAm48XOyR1MmKLdJZT/UFX1lf9srGHz9yo2STfWf+3QLFl4WdoZHwohwPP0mAGklhbwF7nACup1iIphAAAAAElFTkSuQmCC&apos;); background-size: cover; display: block;&quot;
  &gt;&lt;/span&gt;
  &lt;img
        class=&quot;gatsby-resp-image-image&quot;
        alt=&quot;20210308 2&quot;
        title=&quot;20210308 2&quot;
        src=&quot;/static/8671a5700e30b625dde2600082d541ff/c1b63/20210308-2.png&quot;
        srcset=&quot;/static/8671a5700e30b625dde2600082d541ff/5a46d/20210308-2.png 300w,
/static/8671a5700e30b625dde2600082d541ff/0a47e/20210308-2.png 600w,
/static/8671a5700e30b625dde2600082d541ff/c1b63/20210308-2.png 1200w,
/static/8671a5700e30b625dde2600082d541ff/6c2de/20210308-2.png 1334w&quot;
        sizes=&quot;(max-width: 1200px) 100vw, 1200px&quot;
        style=&quot;width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;&quot;
        loading=&quot;lazy&quot;
      /&gt;
    &lt;/span&gt;  &lt;/p&gt;
&lt;p&gt;&lt;span
      class=&quot;gatsby-resp-image-wrapper&quot;
      style=&quot;position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 1200px; &quot;
    &gt;
      &lt;span
    class=&quot;gatsby-resp-image-background-image&quot;
    style=&quot;padding-bottom: 55.99999999999999%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAALCAYAAAB/Ca1DAAAACXBIWXMAAAsTAAALEwEAmpwYAAACbUlEQVQoz3WSSUxTURSGb+LGxJUrF8a1O7eaGHTjkAgLh4WSoNFg2tgItGFqsahA1ehCmmhCXKgbjGJMqhAXaoIk0HlChta2r7wWaOG1b2gLHaPv974nKCouvvz3npz7n5NzDzFc13xv0V5Bq+6q3HKtGe16Hbo6WtHd2QazqQMDfWbcvmnCnf5eWPrNMPd0wNilh6nbAFPXL2RFH5javhGrpgma/Xvk9gP7oN27EzbrPczNz2A24MGXgBdelx1BrwvTfg88zikk4hFUi3mU8iLKa9JW5IKUBbGcqpMvEoLeE0dlg7YHtuFXCM0G4Hc7EPA44KOGPrddPSuo5j43LeZRc4JeJwJep6zkpJKMTKz1h9HXdAn3/TJ048BoQMS0cxwuxxQckxNUJ+H3ONVOFfVREzeNbXbPRMNYYhmkFlkUciLIk8bTePYxiM4QcOF1DWNBCSlmBuHQHJIJFtVKGbVqGZVSEZXyFrbca7UKJJ5D4msQZOj8GYyM2fFYBC5Pyng7xyMR8iM8PwsmFkGSjSO1vKhWz0vCP+TELIrFdYSDdky8ew7yqKEOt042YDSSx9MM4EgK4BJRrCwn6UwWsMjGkF5iIWVXIGYo2W3IpJETOBRoAfLw7DHodxEYDx6CsVGLz+8/oFQQVIO8sErhkONX1UfSNqjxDVMxkwIx1h/BuR0EzbsJjtPfHrbcQLVaBL+ytJH0+9HfbBcnn968wMvBu7ANDWKE7uD01DhtnYfApf4w3ESJ8xSB+2mmKM+lVVUgRbqUlfI6yqU1VQs5HuJ/zBQDJhJCJDxPFzxG55ZFPM4gHI2CXYjRecfxA2vN2HOsYMSuAAAAAElFTkSuQmCC&apos;); background-size: cover; display: block;&quot;
  &gt;&lt;/span&gt;
  &lt;img
        class=&quot;gatsby-resp-image-image&quot;
        alt=&quot;20210308 3&quot;
        title=&quot;20210308 3&quot;
        src=&quot;/static/7ac8c6bc11869915592ab03f3b0b7b8c/c1b63/20210308-3.png&quot;
        srcset=&quot;/static/7ac8c6bc11869915592ab03f3b0b7b8c/5a46d/20210308-3.png 300w,
/static/7ac8c6bc11869915592ab03f3b0b7b8c/0a47e/20210308-3.png 600w,
/static/7ac8c6bc11869915592ab03f3b0b7b8c/c1b63/20210308-3.png 1200w,
/static/7ac8c6bc11869915592ab03f3b0b7b8c/c1bea/20210308-3.png 1388w&quot;
        sizes=&quot;(max-width: 1200px) 100vw, 1200px&quot;
        style=&quot;width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;&quot;
        loading=&quot;lazy&quot;
      /&gt;
    &lt;/span&gt;  &lt;/p&gt;
&lt;p&gt;쿠버네티스 노드는 메모리가 2GB 이상으로 설정되어야 한다고 한다.&lt;/p&gt;
&lt;p&gt;&lt;span
      class=&quot;gatsby-resp-image-wrapper&quot;
      style=&quot;position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 1200px; &quot;
    &gt;
      &lt;span
    class=&quot;gatsby-resp-image-background-image&quot;
    style=&quot;padding-bottom: 55.99999999999999%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAALCAYAAAB/Ca1DAAAACXBIWXMAAAsTAAALEwEAmpwYAAACLklEQVQoz42SS0hUURjHD7QJWrVqEa3btS0Ia9MD0kWPRQgWiDGSlA/UHFOTYlRqkUKBtKhVElJiJEEUuElp8NE4XmfuncfVoXk4M/d6x8ZXUt1f515bWGS1+PF9cM75n///nE80XPN8v15dSW3NFbv2ahWN9TW0NNXR0lxH+80mfHc6JO10+27R09VJR1sz3hv1tLY0bMd26r3Wum+iz1OB5+A+u/HQAar372aot4tQSEEJTBGY9JNMxFkvWhQtg5WCwWrBZHV5SWL+jl2U68J3psS+JAQdp47bDZ5WXg4Moiofmfgw5grGVMUlKlGVAHFtjlBwmmhYQZubkQSJhIL2fDSMlc/Yoq/0KLcrLnN32qZmFEYCBWJBvxQcZ9I/TiQ8Kw/PEo+EpOAMwekJsqkEBWMRS+LUpXzGxenFo/KzPHkboDkM5c+/MjRpMBUPE07rJLNR5lPqLySSKrlEhLwkJV2noipxPU46nWQ+piH6L55jcGSchxZUvrcZVgwyeggjt3XjTizl0ujStS6jmtm061BGRjwoK6HzdBmvIp95nAd/qsCakXbjWD83/QlHdNnMumy/SNw/f4L6PQLv4SN4y6sZff1G/pghHWT+KrgTwlt6jAu7BFV7BSflbz/1tbG5uY65mPxr5J0Q714M8Ky3m+H+Xgb7epgZG6UoZ815o3+5cVKYcp+Z2+odxNpKgS8bq2ysr7i1KIfU+h8xiR7V0DQVLRZjQY/xaUHnBxa03IJBZiGJAAAAAElFTkSuQmCC&apos;); background-size: cover; display: block;&quot;
  &gt;&lt;/span&gt;
  &lt;img
        class=&quot;gatsby-resp-image-image&quot;
        alt=&quot;20210308 4&quot;
        title=&quot;20210308 4&quot;
        src=&quot;/static/8f2db79db833922ce729afa1d5df5d18/c1b63/20210308-4.png&quot;
        srcset=&quot;/static/8f2db79db833922ce729afa1d5df5d18/5a46d/20210308-4.png 300w,
/static/8f2db79db833922ce729afa1d5df5d18/0a47e/20210308-4.png 600w,
/static/8f2db79db833922ce729afa1d5df5d18/c1b63/20210308-4.png 1200w,
/static/8f2db79db833922ce729afa1d5df5d18/c1bea/20210308-4.png 1388w&quot;
        sizes=&quot;(max-width: 1200px) 100vw, 1200px&quot;
        style=&quot;width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;&quot;
        loading=&quot;lazy&quot;
      /&gt;
    &lt;/span&gt;  &lt;/p&gt;
&lt;p&gt;하드디스크 설정 등을 거쳐 가상머신이 생성되면 실행해본다. 가상머신이 시작될 디스크를 선택하라는 메세지가 나오는데, 다운받았던 우분투 서버 이미지 파일(&lt;code class=&quot;language-text&quot;&gt;.iso&lt;/code&gt;)을 선택해서 부팅한다.&lt;/p&gt;
&lt;p&gt;&lt;span
      class=&quot;gatsby-resp-image-wrapper&quot;
      style=&quot;position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 1200px; &quot;
    &gt;
      &lt;span
    class=&quot;gatsby-resp-image-background-image&quot;
    style=&quot;padding-bottom: 58.333333333333336%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAMCAYAAABiDJ37AAAACXBIWXMAAAsTAAALEwEAmpwYAAACl0lEQVQoz42Sy08TURTGb2KiC1cu/BPc6NbowmhcqYkCAgvLFIEaQR660EQjGggLNRg3bCQxGIPviBpfKPRJW6BQoKUPpEyfUGin7TClFRDczOeZaXFhQsLil+/MOTffOffcYbV1HGp1WrlGp0UNxdqqSlRzlaQVaGyoQ0vTJTQ36nCtpR4Nl2vAacoL9SJKrNGUy3Wa87jOla6xm2eOy21nT6Dt1FE84Ergczkx43Xjp9eFgN9DTGNWwTeNGU8hp9S2UHKR4Czi0aC8EA6AlTGGG4cPyrerdejQVoH3TsE1OQ735Bi8rgl4qIFrwgGfW4kn4J+mutOh1pV4cT6M5XRCXs9LWF0RZfa1uxv3e75B0/oU7d2faBoPrGY9Ru1DsFmMGLGaMWTSwzlqx4jNAsewFfYhI8ZGbGrsdNhhMxvUZqKwCNZ+twsf9ePo7TOg53k/TTIF40A/mRpgMQ6S2SCGrSbV1GIYgJXUpP9BfCdjEzW2wG4xkPEwpHQS7EJFE45wHXjZ+xnVjZ3weT20Qxe8dB0f4acd+WmnXvekmlP2q+QCP32Iz0cgZYQC6SUiDvaovASVzZ24dacL3JV7CPFzWIiGEAvzmI8EVeKxMC1+DtHQHBLxGCmPfFbEak5CLptBfkXCciqGTJIHa93L4Oh6CNubD+itv4psPEIHROSWBSL1j7xUICcKyNN3NpNANk1kkmq8IqaINFj9HoYnJw/hLVeGx6ePIRnlkZPSNP7W4e0QyEBQNatqIc/O7WbQ7mMo3cVw8cB+JKJBuk6m2FXYnqLB/3k28PoZzO9fwfTuBexf+iAm48XOyR1MmKLdJZT/UFX1lf9srGHz9yo2STfWf+3QLFl4WdoZHwohwPP0mAGklhbwF7nACup1iIphAAAAAElFTkSuQmCC&apos;); background-size: cover; display: block;&quot;
  &gt;&lt;/span&gt;
  &lt;img
        class=&quot;gatsby-resp-image-image&quot;
        alt=&quot;20210308 5&quot;
        title=&quot;20210308 5&quot;
        src=&quot;/static/8671a5700e30b625dde2600082d541ff/c1b63/20210308-5.png&quot;
        srcset=&quot;/static/8671a5700e30b625dde2600082d541ff/5a46d/20210308-5.png 300w,
/static/8671a5700e30b625dde2600082d541ff/0a47e/20210308-5.png 600w,
/static/8671a5700e30b625dde2600082d541ff/c1b63/20210308-5.png 1200w,
/static/8671a5700e30b625dde2600082d541ff/6c2de/20210308-5.png 1334w&quot;
        sizes=&quot;(max-width: 1200px) 100vw, 1200px&quot;
        style=&quot;width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;&quot;
        loading=&quot;lazy&quot;
      /&gt;
    &lt;/span&gt;  &lt;/p&gt;
&lt;p&gt;가상머신이 부팅되었고 우분투 환경 세팅이 시작된다. 가상머신이 할당받은 IP를 우선은 기록해둔다.&lt;/p&gt;
&lt;p&gt;&lt;span
      class=&quot;gatsby-resp-image-wrapper&quot;
      style=&quot;position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 800px; &quot;
    &gt;
      &lt;span
    class=&quot;gatsby-resp-image-background-image&quot;
    style=&quot;padding-bottom: 75%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAPCAIAAABr+ngCAAAACXBIWXMAAB2HAAAdhwGP5fFlAAABHElEQVQoz92S0W6CMBSGez2h7WkLhbYgZoo6CS7ZzZi7Qm+c2bsO3APupMwlJi7R7G5f/hz+lH6hSSFd67ptdnxf9m9lf1h0+9mw4uNLi3Efret3+XGXfx7Kfj/tWouLZBrDPFWbx6qpFpv1CtOsytd6ifOlmuN8fphhwdSFXU/c0/y+nmRozbQgAQeMyfLEOp2aODWgIgoCpy+SCYzCBIyPGA8owzJYBAA456WnKIrxeJwkiVJKax1FEZY4jofyM6WU4CHDwxhjrXXOoRN7hEeeEOecyfg19HHiCzwIXMe3zE/ALRD4A/9OxvuQAn8WELfLPGTsjsKIA+O3yAI4ZaZ2bjuBRisX/eYTeokgCHSepKUNDQMJNLy4i34Bny1WDavyRx4AAAAASUVORK5CYII=&apos;); background-size: cover; display: block;&quot;
  &gt;&lt;/span&gt;
  &lt;img
        class=&quot;gatsby-resp-image-image&quot;
        alt=&quot;20210308 6&quot;
        title=&quot;20210308 6&quot;
        src=&quot;/static/9246357bb14207fa5d1a9df190d4e6a3/5a190/20210308-6.png&quot;
        srcset=&quot;/static/9246357bb14207fa5d1a9df190d4e6a3/5a46d/20210308-6.png 300w,
/static/9246357bb14207fa5d1a9df190d4e6a3/0a47e/20210308-6.png 600w,
/static/9246357bb14207fa5d1a9df190d4e6a3/5a190/20210308-6.png 800w&quot;
        sizes=&quot;(max-width: 800px) 100vw, 800px&quot;
        style=&quot;width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;&quot;
        loading=&quot;lazy&quot;
      /&gt;
    &lt;/span&gt;  &lt;/p&gt;
&lt;p&gt;프로필 세팅을 거치고, OpenSSH 서버를 설치할 것인지를 묻는데 체크해줬다.&lt;/p&gt;
&lt;p&gt;&lt;span
      class=&quot;gatsby-resp-image-wrapper&quot;
      style=&quot;position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 800px; &quot;
    &gt;
      &lt;span
    class=&quot;gatsby-resp-image-background-image&quot;
    style=&quot;padding-bottom: 75%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAPCAIAAABr+ngCAAAACXBIWXMAAB2HAAAdhwGP5fFlAAABLElEQVQoz82SXU+DMBSGuTVjLad8FVraOTeYGYbIHfFKN0ycvxbYD/SsZMiUJe7OJyftS9OnhxSs5k02u6Q9ZN0hxdDsZLdXWMd3fax1W6uuVu3+u46fWfuxal4FitYqgCzyXoptlW+qPKu2abnSuYpwLJbJk47L9QLD84PCKhaiTO8fE47WOmSW7QAWATZ3AMsLuc8jrEgmYSzcILSpMyOnwmAyPQVjWQDAGJNSxnHcj0IIDJxzDPjoXRIEAZyx+gmXQoPv+73Wm9IgRmitsdmFjLgGPBtGOIZxppT+7DyAp/bvNuCfGRpelYcOY/rF3zsn5L/zH2W8HpcB3hG7VWaA/xG9IzDDj+PcIqNJqChUsl86VeBJH674FpnCtu1Q8SgV85iCC2Q+uYt8AdWJVcFQC8dSAAAAAElFTkSuQmCC&apos;); background-size: cover; display: block;&quot;
  &gt;&lt;/span&gt;
  &lt;img
        class=&quot;gatsby-resp-image-image&quot;
        alt=&quot;20210308 7&quot;
        title=&quot;20210308 7&quot;
        src=&quot;/static/5238325ed32ac2232c1e30746997c5ab/5a190/20210308-7.png&quot;
        srcset=&quot;/static/5238325ed32ac2232c1e30746997c5ab/5a46d/20210308-7.png 300w,
/static/5238325ed32ac2232c1e30746997c5ab/0a47e/20210308-7.png 600w,
/static/5238325ed32ac2232c1e30746997c5ab/5a190/20210308-7.png 800w&quot;
        sizes=&quot;(max-width: 800px) 100vw, 800px&quot;
        style=&quot;width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;&quot;
        loading=&quot;lazy&quot;
      /&gt;
    &lt;/span&gt;  &lt;/p&gt;
&lt;p&gt;우분투가 추가적으로 서버용 툴들 설치할지 확인하고 있다. 어차피 도커를 설치해야 하니 여기서 docker를 선택했었는데, 여기서 설치하면 &lt;code class=&quot;language-text&quot;&gt;snap&lt;/code&gt;으로 설치되기 때문에 &lt;code class=&quot;language-text&quot;&gt;apt&lt;/code&gt;로 설치한 도커와 설치 위치가 달라져 나중에 쿠버네티스 설치가 조금 힘들었다. 그냥 취소하고 자신의 방법대로 &lt;strong&gt;우분투 설치 완료 후 설치&lt;/strong&gt;하자.&lt;/p&gt;
&lt;p&gt;&lt;span
      class=&quot;gatsby-resp-image-wrapper&quot;
      style=&quot;position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 800px; &quot;
    &gt;
      &lt;span
    class=&quot;gatsby-resp-image-background-image&quot;
    style=&quot;padding-bottom: 75%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAPCAIAAABr+ngCAAAACXBIWXMAAB2HAAAdhwGP5fFlAAAB9UlEQVQoz22R65KaQBCFfQBBQWBghos3QAUveIM1lVRiNj+2Ng8b3TxgPplNbWntKWqqmT6nT3dP53IOLz+j62t+ecmur9kt+JXcLp/j63NEqv1CHfw5h39/528v6eWHgtOZelYeON8P1ddqeVoXXzblUzlrivQ4m5zK/NumqOfTpzJvFulpeTu36ahIJKpU2J1u3zIsOxlPxmnmeMK0bNv1hFSuLz2phAqFPlXoBVLIcOAJy3FR8XUsC7o9mUyWy+VwODRNMwiCw+FQVdV6vc6ybDwe53metiCAGUUREoQ38WAwIAF1Op1CTZJkt9tRa7VacS4WC8oppbhHJqUMwxDJnXi/3+vCYLvdbjYb/Nct6AiZLuF5nu/7juP0+/33thHjQ23DMCDhXBQFnpxlWc5mM/RCCDScmOP3Liai4aZp6Lnb7dIVnnpO7lFyn/4HBndinFkM4yEjQW96ZnZG8zgTUItGuNQrfFwYJKrqro7HIzI0enjWQXbYQrZ4bBsqheM4JseSiBmYRdA2bvP5HHNoBI/OJJgZHu8slcSqrutqW9VNjZ4q1KIiBP0iH2KioAXL5Jfz9qQyikQY+5GSSjc8Go2cFq7rfohBv4WOLdsyu4ZfyuCcmLVjK6dn9DSse3TMz2B0DREHQaYM2bMcyzSMT2n/AJfMek/hPgQCAAAAAElFTkSuQmCC&apos;); background-size: cover; display: block;&quot;
  &gt;&lt;/span&gt;
  &lt;img
        class=&quot;gatsby-resp-image-image&quot;
        alt=&quot;20210308 8&quot;
        title=&quot;20210308 8&quot;
        src=&quot;/static/bfabe1198869e8ede4b4da458b5841ff/5a190/20210308-8.png&quot;
        srcset=&quot;/static/bfabe1198869e8ede4b4da458b5841ff/5a46d/20210308-8.png 300w,
/static/bfabe1198869e8ede4b4da458b5841ff/0a47e/20210308-8.png 600w,
/static/bfabe1198869e8ede4b4da458b5841ff/5a190/20210308-8.png 800w&quot;
        sizes=&quot;(max-width: 800px) 100vw, 800px&quot;
        style=&quot;width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;&quot;
        loading=&quot;lazy&quot;
      /&gt;
    &lt;/span&gt;  &lt;/p&gt;
&lt;p&gt;다음 화면이 나오면 우분투 서버 20.04 설치 완료! 가상머신을 재부팅한다.&lt;/p&gt;
&lt;p&gt;&lt;span
      class=&quot;gatsby-resp-image-wrapper&quot;
      style=&quot;position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 800px; &quot;
    &gt;
      &lt;span
    class=&quot;gatsby-resp-image-background-image&quot;
    style=&quot;padding-bottom: 75%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAPCAIAAABr+ngCAAAACXBIWXMAAB2HAAAdhwGP5fFlAAABn0lEQVQoz42S2Y6bQBBFec+Y3SzGYBw3ewBvwOQxJJGyfaxNfjBnIGMNUpBy1Wp1V9epW00j3fvtvfeHn8nwPRp+pfev4e2Td+u3t94bx8vpS85nf/gSMH7/iIdv4t57BKXI1mPHqEXYZFFXJG0quky0mfhYxIznIm6S9895dInC3HcYRbAp9z4IoPSkarJuuN42PIj8Q1nWx/J4Kqo6r2pn65u2y6lqmLJmPCkq452s6GuLIKCkaZoxyvO8qqrO5/PpdLpcLlEUKYqi67o6SnsVa8uyyGf9F2bPIs9zYEqUZdm2bZZlxN+SizDRoiiapsGZKmma7nY727a1uRadgbEFpmcwZdT/tl3X9fV65cLwh8PBH7Ver6fURXjy4apglDiO6rqOdRAErus+zP8BU36z2ZAKjDn9x3GcJAn9c0rdRWfeY7/fYwvMjCfdrlar6c5TwiKMMOFteCcujDNb0zRph1mdi3KO48zaxhOSmbcVQtAtVw3DkNeihDUX8Znz5DNZTRF+OMjpa9G28UaPW0jyqNWrHlsYSL4iSfKC/gCpE2sT7fm1NgAAAABJRU5ErkJggg==&apos;); background-size: cover; display: block;&quot;
  &gt;&lt;/span&gt;
  &lt;img
        class=&quot;gatsby-resp-image-image&quot;
        alt=&quot;20210308 9&quot;
        title=&quot;20210308 9&quot;
        src=&quot;/static/b4c74b12a60109145f31f9ade05409ec/5a190/20210308-9.png&quot;
        srcset=&quot;/static/b4c74b12a60109145f31f9ade05409ec/5a46d/20210308-9.png 300w,
/static/b4c74b12a60109145f31f9ade05409ec/0a47e/20210308-9.png 600w,
/static/b4c74b12a60109145f31f9ade05409ec/5a190/20210308-9.png 800w&quot;
        sizes=&quot;(max-width: 800px) 100vw, 800px&quot;
        style=&quot;width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;&quot;
        loading=&quot;lazy&quot;
      /&gt;
    &lt;/span&gt;  &lt;/p&gt;
&lt;p&gt;지금 생성된 가상머신을 마스터 노드로 사용하고, 워커 노드로 사용할 가상머신을 3개 더 만들자. 지금 했던 과정을 3번 더 반복하고, 각 노드의 이름만 &lt;code class=&quot;language-text&quot;&gt;node1&lt;/code&gt;, &lt;code class=&quot;language-text&quot;&gt;node2&lt;/code&gt;등으로 설정해주었다.&lt;/p&gt;
&lt;p&gt;(나중에 보니 VM 화면에서 가상머신을 우클릭하고 복제를 누르면 된다. 물론 복제 후 노드 이름은 변경해줘야 한다.)&lt;/p&gt;
&lt;h2 id=&quot;가상머신-포트포워딩&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#%EA%B0%80%EC%83%81%EB%A8%B8%EC%8B%A0-%ED%8F%AC%ED%8A%B8%ED%8F%AC%EC%9B%8C%EB%94%A9&quot; aria-label=&quot;가상머신 포트포워딩 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;가상머신 포트포워딩&lt;/h2&gt;
&lt;p&gt;호스트에서 가상머신들에 SSH 접속을 하기 위해서 포트포워딩 설정을 해줘야 한다.&lt;/p&gt;
&lt;p&gt;VirtualBox 화면에서 상단 메뉴의 Files &gt; Preference를 클릭, Network 탭으로 가서 이전에 만들어두었던 NAT Network를 수정한다.&lt;/p&gt;
&lt;p&gt;Port Forwarding 버튼을 누르고 다음 화면처럼 세팅한다.&lt;/p&gt;
&lt;p&gt;&lt;span
      class=&quot;gatsby-resp-image-wrapper&quot;
      style=&quot;position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 1200px; &quot;
    &gt;
      &lt;span
    class=&quot;gatsby-resp-image-background-image&quot;
    style=&quot;padding-bottom: 71.00000000000001%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAOCAYAAAAvxDzwAAAACXBIWXMAAAsTAAALEwEAmpwYAAABwElEQVQ4y61Ta1PbMBDUb6aBGdyktJl2gH7qT+sjhARDHDvxmxgrluW3tieTZBi+AdHMju7Op92VZLHR57Puy/AMw/OBGhoDjIxT6Hl4/gnfLgxcfr/A1Y+v+Hk1xvXlGGOqUe9zzw4jY6AMWvdrdKJYlm6Q8Sflr20kUYBSpAfI7RPKLEWR7WKh4+e5yvmhT38vBVcy42BJHKg0ifFgzpVjWyjyLWzrHvPZFDx5pPoMy8U9kscI039/sHaW2MQBJn9/I/Rd+K4Dcz5T1nIGx50qFvprWJYFx3FQVRX0iKIQUkp0XQfXdRGEIYqigG3baJoWZVlisVggyzKkaYq6blCVEunGA4sCt29crVb0oe4J4zjqCZRS8H2P8rgn0aJt2xJpDZvinES3nFPeQHUkRLtjobeGaZo96d5hHEUHhx45DHcO9U704rquKF5CCAFOhNpISyKSzpKJbbpTbXpHGjp/Ge/zl3VNogX3ta5tUNAFMX0zxxgdbbknzMmmHnvl9+AVIT824ccdasr+DPWlSHGcM6T/Rr8W9E+vLHKUUhDyN6PQ6wqJPM/AiYslkYdN6L4b89sJ7m5vcPcwwQ3N/wFs/B31YpSHSQAAAABJRU5ErkJggg==&apos;); background-size: cover; display: block;&quot;
  &gt;&lt;/span&gt;
  &lt;img
        class=&quot;gatsby-resp-image-image&quot;
        alt=&quot;20210308 10&quot;
        title=&quot;20210308 10&quot;
        src=&quot;/static/fac9f2eed2b52c59534a48001e5072ac/c1b63/20210308-10.png&quot;
        srcset=&quot;/static/fac9f2eed2b52c59534a48001e5072ac/5a46d/20210308-10.png 300w,
/static/fac9f2eed2b52c59534a48001e5072ac/0a47e/20210308-10.png 600w,
/static/fac9f2eed2b52c59534a48001e5072ac/c1b63/20210308-10.png 1200w,
/static/fac9f2eed2b52c59534a48001e5072ac/6569d/20210308-10.png 1328w&quot;
        sizes=&quot;(max-width: 1200px) 100vw, 1200px&quot;
        style=&quot;width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;&quot;
        loading=&quot;lazy&quot;
      /&gt;
    &lt;/span&gt;  &lt;/p&gt;
&lt;p&gt;이제 각 노드는 다음 명령을 통해 접속할 수 있다.&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;bash&quot;&gt;&lt;pre class=&quot;language-bash&quot;&gt;&lt;code class=&quot;language-bash&quot;&gt;$ &lt;span class=&quot;token function&quot;&gt;ssh&lt;/span&gt; -p &lt;span class=&quot;token number&quot;&gt;11001&lt;/span&gt; node@127.0.0.1 &lt;span class=&quot;token comment&quot;&gt;# Node1&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;자주 접속을 하게 될 것 같아서 호스트의 &lt;code class=&quot;language-text&quot;&gt;~/.ssh/config&lt;/code&gt; 파일을 다음과 같이 수정했다.&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;text&quot;&gt;&lt;pre class=&quot;language-text&quot;&gt;&lt;code class=&quot;language-text&quot;&gt;Host node1
	HostName 127.0.0.1
	User node
	Port 11001

Host node2
	HostName 127.0.0.1
	User node
	Port 11002

Host node3
	HostName 127.0.0.1
	User node
	Port 11003

Host node4
	HostName 127.0.0.1
	User node
	Port 11004&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;bash&quot;&gt;&lt;pre class=&quot;language-bash&quot;&gt;&lt;code class=&quot;language-bash&quot;&gt;$ &lt;span class=&quot;token function&quot;&gt;ssh&lt;/span&gt; node1&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;h2 id=&quot;각-노드에-kubernetes-설치&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#%EA%B0%81-%EB%85%B8%EB%93%9C%EC%97%90-kubernetes-%EC%84%A4%EC%B9%98&quot; aria-label=&quot;각 노드에 kubernetes 설치 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;각 노드에 Kubernetes 설치&lt;/h2&gt;
&lt;p&gt;먼저 도커부터 설치한다.&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;bash&quot;&gt;&lt;pre class=&quot;language-bash&quot;&gt;&lt;code class=&quot;language-bash&quot;&gt;$ &lt;span class=&quot;token function&quot;&gt;curl&lt;/span&gt; -fsSL https://get.docker.com/ &lt;span class=&quot;token operator&quot;&gt;|&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;sudo&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;sh&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;도커가 설치되면 &lt;code class=&quot;language-text&quot;&gt;systemctl status docker&lt;/code&gt; 명령을 통해 서비스가 동작하고 있는지(&lt;em&gt;running&lt;/em&gt;) 확인하고 쿠버네티스를 설치한다.&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;bash&quot;&gt;&lt;pre class=&quot;language-bash&quot;&gt;&lt;code class=&quot;language-bash&quot;&gt;$ &lt;span class=&quot;token function&quot;&gt;sudo&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;apt&lt;/span&gt; update &lt;span class=&quot;token operator&quot;&gt;&amp;amp;&amp;amp;&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;sudo&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;apt&lt;/span&gt; upgrade
$ &lt;span class=&quot;token function&quot;&gt;curl&lt;/span&gt; -s https://packages.cloud.google.com/apt/doc/apt-key.gpg &lt;span class=&quot;token operator&quot;&gt;|&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;sudo&lt;/span&gt; apt-key &lt;span class=&quot;token function&quot;&gt;add&lt;/span&gt; -

$ &lt;span class=&quot;token function&quot;&gt;cat&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;&amp;lt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;EOF&lt;span class=&quot;token bash punctuation&quot;&gt; &lt;span class=&quot;token operator&quot;&gt;|&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;sudo&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;tee&lt;/span&gt; /etc/apt/sources.list.d/kubernetes.list&lt;/span&gt;
deb https://apt.kubernetes.io/ kubernetes-xenial main
EOF&lt;/span&gt;

$ &lt;span class=&quot;token function&quot;&gt;sudo&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;apt&lt;/span&gt; update
$ &lt;span class=&quot;token function&quot;&gt;sudo&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;apt&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;install&lt;/span&gt; -y kubelet kubeadm kubectl&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;쿠버네티스는 &lt;strong&gt;Swap이 설정된 머신에서는 동작하지 않고 에러&lt;/strong&gt;를 낸다. Swap이 설정되어 있으면 pod들이 일관적인 성능을 내는 것을 보장할 수 없다고 한다. 쿠버네티스 개발진은 이를 해결할 수는 있지만, &lt;strong&gt;해결해서 얻는 이득이 딱히 크지 않다&lt;/strong&gt;고 판단해 우선순위를 뒤로 미뤄둔 것 같다.&lt;/p&gt;
&lt;p&gt;다음 명령을 통해 swap을 영구적으로 비활성화한다.&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;bash&quot;&gt;&lt;pre class=&quot;language-bash&quot;&gt;&lt;code class=&quot;language-bash&quot;&gt;$ &lt;span class=&quot;token function&quot;&gt;sudo&lt;/span&gt; swapoff -a
$ &lt;span class=&quot;token function&quot;&gt;sudo&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;sed&lt;/span&gt; -i &lt;span class=&quot;token string&quot;&gt;&apos;/ swap / s/^\(.*\)$/#&lt;span class=&quot;token entity&quot; title=&quot;\1&quot;&gt;\1&lt;/span&gt;/g&apos;&lt;/span&gt; /etc/fstab&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;쿠버네티스 실행에 앞서 한 가지 더 필요한 설정이 있는데, &lt;strong&gt;쿠버네티스와 도커의 cgroup 드라이버가 동일해야 한다&lt;/strong&gt;는 것이다. 도커의 cgroup 기본 드라이버는 &lt;code class=&quot;language-text&quot;&gt;cgroupfs&lt;/code&gt;인데, 쿠버네티스에서 권장하는 드라이버는 &lt;code class=&quot;language-text&quot;&gt;systemd&lt;/code&gt;라고 한다.&lt;/p&gt;
&lt;p&gt;우선 도커의 cgroup 드라이버를 확인해보자.&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;bash&quot;&gt;&lt;pre class=&quot;language-bash&quot;&gt;&lt;code class=&quot;language-bash&quot;&gt;$ &lt;span class=&quot;token function&quot;&gt;sudo&lt;/span&gt; docker info &lt;span class=&quot;token operator&quot;&gt;|&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;grep&lt;/span&gt; -i cgroup

&lt;span class=&quot;token comment&quot;&gt;# output&lt;/span&gt;
&lt;span class=&quot;token punctuation&quot;&gt;..&lt;/span&gt;.
Cgroup Driver: cgroupfs
&lt;span class=&quot;token punctuation&quot;&gt;..&lt;/span&gt;.&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;다음 명령들을 통해 드라이버를 변경하고, 도커 서비스를 재시작한다.&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;bash&quot;&gt;&lt;pre class=&quot;language-bash&quot;&gt;&lt;code class=&quot;language-bash&quot;&gt;&lt;span class=&quot;token comment&quot;&gt;# 권한 부여&lt;/span&gt;
$ &lt;span class=&quot;token function&quot;&gt;sudo&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;chown&lt;/span&gt; &lt;span class=&quot;token environment constant&quot;&gt;$USER&lt;/span&gt;:docker /etc/docker

&lt;span class=&quot;token comment&quot;&gt;# 도커 대몬 교체&lt;/span&gt;
&lt;span class=&quot;token function&quot;&gt;cat&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;&gt;&lt;/span&gt; /etc/docker/daemon.json &lt;span class=&quot;token operator&quot;&gt;&amp;lt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;EOF
{
  &quot;exec-opts&quot;: [&quot;native.cgroupdriver=systemd&quot;],
  &quot;log-driver&quot;: &quot;json-file&quot;,
  &quot;log-opts&quot;: {
    &quot;max-size&quot;: &quot;100m&quot;
  },
  &quot;storage-driver&quot;: &quot;overlay2&quot;
}
EOF&lt;/span&gt;

$ &lt;span class=&quot;token function&quot;&gt;sudo&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;mkdir&lt;/span&gt; -p /etc/systemd/system/docker.service.d

&lt;span class=&quot;token comment&quot;&gt;# 도커 서비스 재시작&lt;/span&gt;
$ &lt;span class=&quot;token function&quot;&gt;sudo&lt;/span&gt; systemctl daemon-reload
$ &lt;span class=&quot;token function&quot;&gt;sudo&lt;/span&gt; systemctl restart docker&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;h2 id=&quot;kubeadm-이용해서-클러스터-구성&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#kubeadm-%EC%9D%B4%EC%9A%A9%ED%95%B4%EC%84%9C-%ED%81%B4%EB%9F%AC%EC%8A%A4%ED%84%B0-%EA%B5%AC%EC%84%B1&quot; aria-label=&quot;kubeadm 이용해서 클러스터 구성 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;kubeadm 이용해서 클러스터 구성&lt;/h2&gt;
&lt;p&gt;kubernetes.io에 따르면 kubeadm은 &lt;strong&gt;쿠버네티스 클러스터 생성 용도의 툴&lt;/strong&gt;로, 시스템 프로비저닝까지 다루지 않고 부트스트랩(bootstrapping)까지만 다루도록 설계되었다고 한다.&lt;/p&gt;
&lt;p&gt;여기서는 kubeadm을 이용해 클러스터를 구성할 것이다. &lt;/p&gt;
&lt;p&gt;마스터 노드에서 다음 명령을 입력해 클러스터를 구성한다.&lt;/p&gt;
&lt;p&gt;(물론 kubeadm init 명령에서 IP는 자신이 세팅한 마스터 노드의 IP로 설정한다.)&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;bash&quot;&gt;&lt;pre class=&quot;language-bash&quot;&gt;&lt;code class=&quot;language-bash&quot;&gt;$ &lt;span class=&quot;token function&quot;&gt;sudo&lt;/span&gt; kubeadm init --apiserver-advertise-address&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;10.0&lt;/span&gt;.2.15 --pod-network-cidr&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;10.244&lt;/span&gt;.0.0/16

$ &lt;span class=&quot;token function&quot;&gt;mkdir&lt;/span&gt; -p &lt;span class=&quot;token environment constant&quot;&gt;$HOME&lt;/span&gt;/.kube
$ &lt;span class=&quot;token function&quot;&gt;sudo&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;cp&lt;/span&gt; -i /etc/kubernetes/admin.conf &lt;span class=&quot;token environment constant&quot;&gt;$HOME&lt;/span&gt;/.kube/config
$ &lt;span class=&quot;token function&quot;&gt;sudo&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;chown&lt;/span&gt; &lt;span class=&quot;token variable&quot;&gt;&lt;span class=&quot;token variable&quot;&gt;$(&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;id&lt;/span&gt; -u&lt;span class=&quot;token variable&quot;&gt;)&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token builtin class-name&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;token variable&quot;&gt;&lt;span class=&quot;token variable&quot;&gt;$(&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;id&lt;/span&gt; -g&lt;span class=&quot;token variable&quot;&gt;)&lt;/span&gt;&lt;/span&gt; &lt;span class=&quot;token environment constant&quot;&gt;$HOME&lt;/span&gt;/.kube/config

&lt;span class=&quot;token comment&quot;&gt;# root 권한으로 설정&lt;/span&gt;
$ &lt;span class=&quot;token builtin class-name&quot;&gt;export&lt;/span&gt; &lt;span class=&quot;token assign-left variable&quot;&gt;KUBECONFIG&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;/etc/kubernetes/admin.conf&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;마스터노드에서 &lt;code class=&quot;language-text&quot;&gt;kubeadm init&lt;/code&gt; 명령이 완료되면 그 클러스터로 참가할 수 있는 명령이 출력된다. 이 명령을 워커 노드에서 입력해야 하므로 복사해둔다.&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;bash&quot;&gt;&lt;pre class=&quot;language-bash&quot;&gt;&lt;code class=&quot;language-bash&quot;&gt;$ &lt;span class=&quot;token function&quot;&gt;sudo&lt;/span&gt; kubeadm &lt;span class=&quot;token function&quot;&gt;join&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;10.0&lt;/span&gt;.2.15:6443 --token 8rzhrw.av7q1aoyqwsco3q --discovery-token-ca-cert-hash sha256:3be2271256e896a6762f7b39a69f38c990cafbfd39ab92c01df6fdbf4bfc3d9&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;&lt;code class=&quot;language-text&quot;&gt;Flannel&lt;/code&gt;이라는 쿠버네티스 애드온을 설치한다. 마스터 노드에서 입력하자. 이는 CNI(Container Network Interface) 플러그인으로, &lt;strong&gt;기본 쿠버네티스 자체적으로는 pod간 통신을 위한 네트워크를 구성해주지 않기 때문&lt;/strong&gt;에 추가로 설치해 사용하게 된다.&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;bash&quot;&gt;&lt;pre class=&quot;language-bash&quot;&gt;&lt;code class=&quot;language-bash&quot;&gt;$ kubectl apply -f https://raw.githubusercontent.com/coreos/flannel/master/Documentation/kube-flannel.yml&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;이제 마스터 노드의 설정이 끝났고, 위에서 복사해둔 &lt;code class=&quot;language-text&quot;&gt;kubeadm join&lt;/code&gt; 명령을 각 워커 노드에서 실행하면 클러스터 구성이 완료된다.&lt;/p&gt;
&lt;p&gt;워커들이 클러스터에 제대로 참여했는지 마스터 노드에서 확인해보자.&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;bash&quot;&gt;&lt;pre class=&quot;language-bash&quot;&gt;&lt;code class=&quot;language-bash&quot;&gt;$ &lt;span class=&quot;token function&quot;&gt;sudo&lt;/span&gt; kubectl get nodes

&lt;span class=&quot;token comment&quot;&gt;# output&lt;/span&gt;
NAME    STATUS   ROLES                  AGE   VERSION
node1   Ready    control-plane,master   40m   v1.20.4
node2   Ready    &lt;span class=&quot;token operator&quot;&gt;&amp;lt;&lt;/span&gt;none&lt;span class=&quot;token operator&quot;&gt;&gt;&lt;/span&gt;                 21m   v1.20.4
node3   Ready    &lt;span class=&quot;token operator&quot;&gt;&amp;lt;&lt;/span&gt;none&lt;span class=&quot;token operator&quot;&gt;&gt;&lt;/span&gt;                 21m   v1.20.4
node4   Ready    &lt;span class=&quot;token operator&quot;&gt;&amp;lt;&lt;/span&gt;none&lt;span class=&quot;token operator&quot;&gt;&gt;&lt;/span&gt;                 21m   v1.20.4&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;h2 id=&quot;troubleshooting&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#troubleshooting&quot; aria-label=&quot;troubleshooting permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;Troubleshooting&lt;/h2&gt;
&lt;p&gt;이번 포스팅에서 다룬 가상머신으로 클러스터 구성한 것과, 연구실 서버로 클러스터 구성하면서 해결한 몇몇 에러를 소개한다. 아직 쿠버네티스 실력 수준이 낮고, 복잡한 클러스터를 다뤄보지 못해서 이 정도 에러만 소개하고 포스팅을 마치려 한다.&lt;/p&gt;
&lt;h3 id=&quot;워커-노드들의-status가-전부-notready로-뜨는-경우&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#%EC%9B%8C%EC%BB%A4-%EB%85%B8%EB%93%9C%EB%93%A4%EC%9D%98-status%EA%B0%80-%EC%A0%84%EB%B6%80-notready%EB%A1%9C-%EB%9C%A8%EB%8A%94-%EA%B2%BD%EC%9A%B0&quot; aria-label=&quot;워커 노드들의 status가 전부 notready로 뜨는 경우 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;워커 노드들의 Status가 전부 NotReady로 뜨는 경우&lt;/h3&gt;
&lt;p&gt;Calico 애드온 설정을 빼먹어서, 진행해줬더니 Ready 상태로 변경되었다.&lt;/p&gt;
&lt;h3 id=&quot;kubelet-서비스가-실행되지-않는-경우&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#kubelet-%EC%84%9C%EB%B9%84%EC%8A%A4%EA%B0%80-%EC%8B%A4%ED%96%89%EB%90%98%EC%A7%80-%EC%95%8A%EB%8A%94-%EA%B2%BD%EC%9A%B0&quot; aria-label=&quot;kubelet 서비스가 실행되지 않는 경우 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;kubelet 서비스가 실행되지 않는 경우&lt;/h3&gt;
&lt;p&gt;마스터 노드에서 클러스터에 계속 접속이 되지 않아 kubelet 서비스가 제대로 동작하고 있는지 확인을 해봤다.&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;bash&quot;&gt;&lt;pre class=&quot;language-bash&quot;&gt;&lt;code class=&quot;language-bash&quot;&gt;$ &lt;span class=&quot;token function&quot;&gt;sudo&lt;/span&gt; systemctl status kubelet&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;보통 때면 초록색으로 active (running)이 표시될텐데 그렇지 않았다.&lt;/p&gt;
&lt;p&gt;이 상황은 세 번을 겪었는데, &lt;ins&gt;한 번은 도커가 실행되지 않고 있던 경우&lt;/ins&gt;, 도커는 실행되었지만 &lt;ins&gt;도커와 쿠버네티스의 cgroup 드라이버가 서로 맞지 않던 경우&lt;/ins&gt;, 마지막으로 &lt;ins&gt;머신에 swap이 켜져있던 경우&lt;/ins&gt;였다.&lt;/p&gt;
&lt;p&gt;journalctl 명령을 통해 kubelet 서비스의 로그를 먼저 확인해서 각 경우를 해결했다.&lt;/p&gt;
&lt;p&gt;도커와 쿠버네티스 cgroup 드라이버가 일치하지 않던 경우는 위에서 했던대로 도커의 드라이버를 변경해주고 서비스를 재시작하면 바로 해결되었다.&lt;/p&gt;
&lt;p&gt;swap이 켜져있던 경우도 위에서 설정했던대로 다시 swap을 꺼주었다. swap을 비활성화하는 &lt;code class=&quot;language-text&quot;&gt;swapoff -a&lt;/code&gt; 명령만 수행했더니 영구적으로 적용되지 않아 머신이 재부팅한 후에 swap이 다시 활성화됐던 것이었다. 그 밑의 명령까지 수행하자.&lt;/p&gt;
&lt;p&gt;도커가 실행되지 않던 상황은, /etc/docker/daemon.json 파일이 어떤 이유로 비워졌기 때문이었다. cgroup 드라이버 변경할 때 넣었던 내용을 다시 입력해주었다.&lt;/p&gt;
&lt;h2 id=&quot;references&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#references&quot; aria-label=&quot;references permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;References&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;VirtualBox 설치 : &lt;a href=&quot;https://phoenixnap.com/kb/install-virtualbox-on-ubuntu&quot;&gt;https://phoenixnap.com/kb/install-virtualbox-on-ubuntu&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;Swap을 꺼야하는 이유 : &lt;a href=&quot;https://github.com/kubernetes/kubernetes/issues/53533&quot;&gt;https://github.com/kubernetes/kubernetes/issues/53533&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;kubeadm : &lt;a href=&quot;https://velog.io/@seunghyeon/Kubeadm%EC%9C%BC%EB%A1%9C-K8S-%EA%B5%AC%EC%84%B1&quot;&gt;https://velog.io/@seunghyeon/Kubeadm으로-K8S-구성&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;가상머신 구성 : &lt;a href=&quot;https://velog.io/@evanjin/kubernetes-virtualbox%EB%A5%BC-%EC%9D%B4%EC%9A%A9%ED%95%98%EC%97%AC-%EC%84%A4%EC%B9%98mac-ijk495l4e9&quot;&gt;https://velog.io/@evanjin/kubernetes-virtualbox를-이용하여-설치mac-ijk495l4e9&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;Calico, Flannel : &lt;a href=&quot;https://jonnung.dev/kubernetes/2020/02/24/kubernetes-pod-networking/&quot;&gt;https://jonnung.dev/kubernetes/2020/02/24/kubernetes-pod-networking/&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;</content:encoded></item><item><title><![CDATA[서버리스 아키텍처(Serverless Architecture)와 콜드 스타트(Cold Start)]]></title><description><![CDATA[…]]></description><link>https://blog.frec.kr/cloud/serverless_and_cold_start/</link><guid isPermaLink="false">https://blog.frec.kr/cloud/serverless_and_cold_start/</guid><pubDate>Thu, 18 Feb 2021 15:18:00 GMT</pubDate><content:encoded>&lt;h2 id=&quot;들어가기-전에&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#%EB%93%A4%EC%96%B4%EA%B0%80%EA%B8%B0-%EC%A0%84%EC%97%90&quot; aria-label=&quot;들어가기 전에 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;들어가기 전에&lt;/h2&gt;
&lt;p&gt;우선 서버리스는 문자 그대로 서버가 없다는 뜻은 전혀 아니다. &lt;strong&gt;서버에 대해 고려를 할 필요가 없는&lt;/strong&gt; 구조라고 이해하는 것이 좋다. 서버리스라는 단어는 실제 이 아키텍처를 함축한 단어로는 적합하지 않고, 오히려 상술에 가까운 말이라고 생각한다. 다만 용어가 가지는 파급력과 간결함 때문에 논문에도 자주 등장하며 이 아키텍처를 표현하는 단어로 곧잘 사용되는 것 같다.&lt;/p&gt;
&lt;h2 id=&quot;서버리스-아키텍처의-개념&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#%EC%84%9C%EB%B2%84%EB%A6%AC%EC%8A%A4-%EC%95%84%ED%82%A4%ED%85%8D%EC%B2%98%EC%9D%98-%EA%B0%9C%EB%85%90&quot; aria-label=&quot;서버리스 아키텍처의 개념 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;서버리스 아키텍처의 개념&lt;/h2&gt;
&lt;p&gt;우선 서버리스 아키텍처라는 개념에 대한 설명을 가져왔다.
redhat 홈페이지에선,&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;서버리스(Serverless)는 개발자가 서버를 관리할 필요 없이 애플리케이션을 빌드하고 실행할 수 있도록 하는 클라우드 네이티브 개발 모델이다.&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;매우 간단히 설명하긴 했는데, &lt;strong&gt;개발자가 서버를 관리할 필요가 없다&lt;/strong&gt;는 가장 중요한 표현이 들어가 있다.&lt;/p&gt;
&lt;p&gt;기존 &lt;em&gt;온프레미스(On-premise)&lt;/em&gt; 환경이나 &lt;em&gt;IaaS(Infrastructre-as-a-Service)&lt;/em&gt; 컴퓨팅 모델을 사용하는 경우에는 서버 프로그램을 빌드해서 계속 돌려두게 되는데, 이 경우엔 서버의 환경과 상태에 대해 지속적으로 신경써야 하고 관리를 해야한다.&lt;/p&gt;
&lt;p&gt;반면에 서버리스 아키텍처는 서버의 환경 등 시스템, 인프라에 관련된 것은 대부분 추상화되어 제공된다. 개발자는 이러한 것을 고려할 필요 없이 비즈니스 로직에 집중하여 개발을 진행한다.&lt;/p&gt;
&lt;h2 id=&quot;faas-function-as-a-service&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#faas-function-as-a-service&quot; aria-label=&quot;faas function as a service permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;FaaS (Function-as-a-Service)&lt;/h2&gt;
&lt;p&gt;서버리스 아키텍처는 &lt;em&gt;FaaS(Funtion-as-a-Service)&lt;/em&gt;와 &lt;em&gt;BaaS(Backend-as-a-Service)&lt;/em&gt;로 나뉘지만, 일반적으로 &lt;strong&gt;서버리스&lt;/strong&gt;라고 하면 FaaS를 가리킨다.&lt;/p&gt;
&lt;p&gt;프로그램을 함수 단위로 클라우드에 배포하고, 이벤트가 발생하면 함수가 실행되는 방법으로, 사용자는 함수가 실행된 횟수 및 시간에 따른 비용만 지불하게 된다.&lt;/p&gt;
&lt;p&gt;이때, 이벤트는 웹 요청이 들어오면 발생시킬 수도 있고, 특정 시간 주기로 발생할 수도 있으며, 직접 호출할 수도 있음. 이를 이용해 웹과 같은 서비스에서 백엔드 API 서버를 구성할 수도 있다.&lt;/p&gt;
&lt;p&gt;FaaS는 &lt;em&gt;AWS Lambda&lt;/em&gt;, &lt;em&gt;Google Cloud Functions&lt;/em&gt;, &lt;em&gt;Azure Function&lt;/em&gt; 등의 서비스를 이용해 구축된다.&lt;/p&gt;
&lt;h2 id=&quot;faas의-특징&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#faas%EC%9D%98-%ED%8A%B9%EC%A7%95&quot; aria-label=&quot;faas의 특징 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;FaaS의 특징&lt;/h2&gt;
&lt;ol&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;Stateless&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;FaaS 서비스는 함수가 실행되는 동안에만 관련된 자원을 할당하게 됨. 또한 함수가 항상 같은 머신에서 실행된다는 보장이 없음. 따라서, 함수 실행 시 로컬에서의 어떤 상태(State)가 유지될 수 없다.&lt;/p&gt;
&lt;p&gt;이를 해결하고 싶다면 메모리에 상태를 저장하지 않고 AWS의 경우엔 S3을 이용하거나 아예 DB를 사용해야 한다.&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;Ephemeral&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;위에서 말한 것과 같이 함수는 특정 이벤트가 발생했을 때만 컨테이너로서 배포가 되고, 실행이 끝난 후엔 자원이 회수되므로 일시적으로만 배포된다고 할 수 있다.&lt;/p&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;h2 id=&quot;장점&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#%EC%9E%A5%EC%A0%90&quot; aria-label=&quot;장점 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;장점&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;서버 인프라에 대해 고려할 필요가 없음 (서비스에서 추상화되어 제공)&lt;/p&gt;
&lt;p&gt;⇒ 신속한 개발 및 배포 가능&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;서버리스에 적합한 서비스들의 경우 비용을 획기적으로 줄일 수 있음 (서버를 24시간 소유하고 구동할 필요가 없음)&lt;/li&gt;
&lt;li&gt;뛰어난 확장성&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id=&quot;단점&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#%EB%8B%A8%EC%A0%90&quot; aria-label=&quot;단점 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;단점&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;인프라를 제공하는 회사(AWS, Google, MS 등)에 강하게 의존하게 됨&lt;/p&gt;
&lt;p&gt;⇒ 인프라 변경 시 상당한 비용 발생&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;인프라가 제공되는 수준 이상으로 커스터마이징을 할 수 없음&lt;/li&gt;
&lt;li&gt;서비스가 서버에 올라가 지속적으로 작업을 해야하는 경우에 적합하지 않음&lt;/li&gt;
&lt;li&gt;대부분의 인프라 제공 회사에서는 함수의 실행에 대해 자원 제한을 걸어둠&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id=&quot;challenge--cold-start-문제&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#challenge--cold-start-%EB%AC%B8%EC%A0%9C&quot; aria-label=&quot;challenge  cold start 문제 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;Challenge :: Cold Start 문제&lt;/h2&gt;
&lt;p&gt;계속 말했듯이 FaaS는 함수가 실행되는 동안만 관련된 자원이 할당되고, 실행이 끝난다면 자원은 회수된다. 물론 함수의 모든 실행마다 할당과 회수를 반복하지는 않는다. 자주 실행되는 함수의 경우 자원을 완전히 회수하지 않고 다음 실행에 대비하지만, 오래 호출되지 않은 함수의 경우엔 다음 실행에 대한 대비가 되어있지 않다. 그래서 가끔씩 함수를 호출할 때, 평소엔 응답까지 약 50ms가 걸리던 함수가 첫 실행에 한해 300ms까지 소요되는 상황이 발생한다. 이를 콜드 스타트 (Cold Start)라고 한다.&lt;/p&gt;
&lt;p&gt;함수가 오랜만에 호출될 때 발생하는 응답 지연은 다음 이유들로 인해 발생한다.&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;함수를 실행하기 위해 자원을 프로비져닝하고 시작하는데 걸리는 시간 (가상머신이나 컨테이너 등)&lt;/li&gt;
&lt;li&gt;함수의 런타임 환경을 구동 및 초기화하는데 걸리는 시간 (JVM이나 파이썬 인터프리터, Chrome V8 엔진 등)&lt;/li&gt;
&lt;li&gt;함수 내 어플리케이션의 부트스트랩 시간 (라이브러리 컴파일과 로딩 등)&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;이를 최적화하는 방법은 많은 곳에 소개되어 있다. (자원을 할당하고 회수하는 한 완전한 해결은 불가능함)&lt;/p&gt;
&lt;p&gt;&lt;span
      class=&quot;gatsby-resp-image-wrapper&quot;
      style=&quot;position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 1015px; &quot;
    &gt;
      &lt;span
    class=&quot;gatsby-resp-image-background-image&quot;
    style=&quot;padding-bottom: 58.333333333333336%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAMCAYAAABiDJ37AAAACXBIWXMAAAsTAAALEwEAmpwYAAACb0lEQVQoz1VTyXLaQBDlmgqLjS3EYpDAgBY0EmgXEtgkBoKxs1Sqckz5kL/IJX/+8kbEKXPomunu6afu108Vu9gi3H6GXeyQfPoGb/OI4OEZ8f5rGe+5KWojBxdjF41bcTrH4tx/c1aujDnaTgTVDtEVCdqz070/z0qw5nRePjwvPvff5iuNWxe1gYGr6AE3L795N1Fnsjacoc7O5MPmxINi+v+LXk36l4YP7dcfNMUSjdEMFZmo6zYunAzq4Sdq8i5jBJMmgaXfsgJUea/9s9euamxIPb6gbgQnQFnUn+cQ6z3s9B5mvi0BptlHWOTVzHfQ/ALXxgL2akeOj3DJc9uJSzq8+wMmwQom3yuWj0p1JGCEIXaHNVYPKxyPazTJUZCnOBwKPD3mWGQxuu4Syf4LPmwLPD/dIS5idiwwjVLW8E2x5PLI4bURopMeaDu0kx1ayR7jbIMgNBHEDkJaRBOLO/QmdzDFBvo0h26uMIhDaEsHzocA+lKg5XHLPc6tSL7IRYPddpwEEeWic8yGXArHV9nxWHLsZsiffsBabtG0faiLGCq5TR6/o0VlKI6DisoibWijT+CeZkG7dTBhUpsGUG4sKH0b3YGNwSzFlShwE2ygeBtUjRQNm5IyBbQo4cdcXM+ElI0ou5DiValBQdKNeIko88hTgDj3MU8D6pNjkXx9kcFPXCSMR5mPIF1AmUo1CKpCnGRzSZ1J4A4BZ9ysla4IlsBLIoIxFkXoiRhDAo6jNZcUlosS5NBLY7StRYnRkltWzIC8xejwL1HIh5SHYoVomhHeD1280wVPcaZNGX+16sjjdAJdTjANU/wFiGNnJPxY0QoAAAAASUVORK5CYII=&apos;); background-size: cover; display: block;&quot;
  &gt;&lt;/span&gt;
  &lt;img
        class=&quot;gatsby-resp-image-image&quot;
        alt=&quot;20210218 1&quot;
        title=&quot;20210218 1&quot;
        src=&quot;/static/d609410c34b3c23cecae65ca6c4054c7/e088a/20210218-1.png&quot;
        srcset=&quot;/static/d609410c34b3c23cecae65ca6c4054c7/5a46d/20210218-1.png 300w,
/static/d609410c34b3c23cecae65ca6c4054c7/0a47e/20210218-1.png 600w,
/static/d609410c34b3c23cecae65ca6c4054c7/e088a/20210218-1.png 1015w&quot;
        sizes=&quot;(max-width: 1015px) 100vw, 1015px&quot;
        style=&quot;width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;&quot;
        loading=&quot;lazy&quot;
      /&gt;
    &lt;/span&gt;  &lt;/p&gt;
&lt;p&gt;먼저 AWS등과 같이 FaaS를 제공하는 업체에서 최적화를 해야하는 부분이 있다. 위의 자료 이미지에서 보듯이 코드를 다운받고 컨테이너를 새로 생성하는 등의 과정은 사용자가 해결할 수 있는 부분은 아니다. 이에 관해서는 한 논문을 소개하고 넘어가려 한다.&lt;/p&gt;
&lt;p&gt;2020년 Middleware에서 발표된 Paulo Silva의 논문에서는 CRIU 툴을 이용해 함수가 실행되는 프로세스의 스냅샷을 백업/복원하여 속도를 향상시키는 방법을 제안했다.&lt;/p&gt;
&lt;p&gt;그리고, &lt;a href=&quot;https://lumigo.io/aws-lambda-performance-optimization/&quot;&gt;https://lumigo.io/aws-lambda-performance-optimization/&lt;/a&gt; 에서 사용자가 최적화하는 몇가지 팁에 대해 소개하고 있다.&lt;/p&gt;
&lt;p&gt;여기서는 함수의 구현 언어를 선택하는 것도 매우 중요하다고 한다.&lt;/p&gt;
&lt;p&gt;다음 실험은 AWS Lambda에서 언어별 콜드 스타트를 테스트한 것이다. (2018년 기준)&lt;/p&gt;
&lt;p&gt;&lt;span
      class=&quot;gatsby-resp-image-wrapper&quot;
      style=&quot;position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 899px; &quot;
    &gt;
      &lt;span
    class=&quot;gatsby-resp-image-background-image&quot;
    style=&quot;padding-bottom: 80%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAQCAYAAAAWGF8bAAAACXBIWXMAAAsTAAALEwEAmpwYAAADd0lEQVQ4y22Uf2xTVRTHl/inf4j6h0ZMYNMlU7es21pWFAZBiQlqEP+QRNQoaCYZMoOLv1MTh5nBGdBhdauwsMlAurqVCFNMmcmcAwUkrIpQusHa0t/tSrv2te+9fnx9b4MyPcnNO/fccz/ve+4795Xk83kKo2BZUSI+naAwE5WRFGbUePJajGDASzYrImfTpFPX1LiUniGTTKr+HKdElmWKoepiOkXulx8hlVThsiQjy3kKuddzivNn96vA2Yj6kDMucsIJ8gE/mTXVyBMXtB3FoFkBxaBiK9EWJHUiRnoRfC8rwAjZp5cgT7pugsxX9X9Wks1mFQGiWpoQ2k/a2wSxNDNP6RXgxVmgpAA0qBgJKecoqPnFpV4vWXVkUTvksI3p8xsQzo2QWFOHNDGn8IaC9AurkU6NanFJUqv77xkqFhVSTE11Enboib5bSvRxnQLUFIopJ2mPSeuEJ+qQfzt+89nmi0vOCarT5fyS9mP1JBwrFeB9hFbryLn/0bJSf5AcX4o4EyKpKBfHhjWOmEZMnlF9oWM7uaF+SoQ54F9f8dERI7GhFYRayvCtqkZUSp5WXu/2WomN1BLvfpKI8S5yJ3/VlGe8JJ1GZAIIjevJdX1aKFnGdhbWfb+L1h/qCdgbCDSXMrmiErx+jgUdNB/WEXcYiH5Wg7/2DjInNCC5OLE/VxI7tI742ocQersKQIl3BmQeMO/AZF+C17qMq02luBsqSV/wsu/Sz2yy1RA8oie8w8Bk1e1w+hRxEvSd2c7lkaXEdlYQXHUPqX0WBZjP8OF3Ke7f2co2q4HLfY9w5dVFSslVdH57kYd7Bnn+YDVX+uvwt9YxUXkbgeOn6b00znM2I84hPZF2HZ6GhSS6VYV5TL1RytpMNB+ox92znMmNZXge07Grc5wHvzjA2h4drv16PCYDvto7sVpGqTKP8Wz/o/xuMxD4WId72b3Eui0acFvHFAtatrLRUsHf5mpczyzAbSijrW2Uu9/fzfLPF3HOXM7E1nLci2+hr/0nFn5gx/h1DY495XhaFuOsuJWgebf2UfYO+njxmy46jr6Oy/4Gnk9ewvtWE9aDZ9m0d5D3Bho5P/Aavs4teDavZ9h6klcsw7x9+E3G7I3492zGvWUDkaGj2k2Z60wplyccS8zvVWQlHgzHkedfXOUX4LsaQuRGf/8LHWoyejOke58AAAAASUVORK5CYII=&apos;); background-size: cover; display: block;&quot;
  &gt;&lt;/span&gt;
  &lt;img
        class=&quot;gatsby-resp-image-image&quot;
        alt=&quot;20210218 2&quot;
        title=&quot;20210218 2&quot;
        src=&quot;/static/37769b6593ad23ada4362d14a43dc430/681f1/20210218-2.png&quot;
        srcset=&quot;/static/37769b6593ad23ada4362d14a43dc430/5a46d/20210218-2.png 300w,
/static/37769b6593ad23ada4362d14a43dc430/0a47e/20210218-2.png 600w,
/static/37769b6593ad23ada4362d14a43dc430/681f1/20210218-2.png 899w&quot;
        sizes=&quot;(max-width: 899px) 100vw, 899px&quot;
        style=&quot;width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;&quot;
        loading=&quot;lazy&quot;
      /&gt;
    &lt;/span&gt;  &lt;/p&gt;
&lt;p&gt;아무래도 JVM을 구동해야 하는 자바가 더 큰 콜드 스타트 문제를 보여줬다.&lt;/p&gt;
&lt;p&gt;또한 위에서 소개했던 Silva의 논문에서, 함수의 크기 (Function Size) 별로 함수의 start-up time을 비교한 이미지를 첨부한다.&lt;/p&gt;
&lt;p&gt;&lt;span
      class=&quot;gatsby-resp-image-wrapper&quot;
      style=&quot;position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 959px; &quot;
    &gt;
      &lt;span
    class=&quot;gatsby-resp-image-background-image&quot;
    style=&quot;padding-bottom: 71.33333333333334%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAOCAYAAAAvxDzwAAAACXBIWXMAAAsTAAALEwEAmpwYAAACaUlEQVQ4y41TS2tTQRS+S3dKFWrdWB8VF/4AEcSFWmpVaKxBcKfgrrsIim40lYhtfLTajaAIogtx4wsVVKg2bVoriTePm9fNy6Rqqo15mJjce/M5Z5Kb3AYsDhzmnDNzvvnmmzNCrVYDmT6M8b/80lIeyTkforMit7hTRDbxla8JmqahUCg0Cygm02NjXlUUXuR/8h4X1uzFxc4+WLsO4Pyq3XhhGasDlkql/2aoqSr3pedTuLzhEK5tM+P69mO4tK4Pr85O1AHT6TRyuVyrqJ0h+ZRjYGq1zlB69gG2rn6MbhmEvecohjt68fLMrTpgJpOB2ji5BVBDu7Z8na3pDG3rW4BWDthgmEqlUCwWUTNe2eBrqgaFaVepVFAp/zEwPAj71kFc7TFjeK0BMJ/Po1qt1gGYKYytoirQGuyeDtkxvvMEbu45hbFdJ/HAfA7T449wZeMARjcfMVy5AahfJ/0pgHuHLbgzYMFd02nc7h2Cc+IxHjIA6+p9GO02wdbZjxs7jmNy5D5GuhngJhNnaO3Y39KQ9FKpdRazkN/NI/x2DtLrGUTefMR3fwyLwQTiMyKCk/OITYtYcIeQTX7Dl1nWh47PkKdcSLD8Tzm1nOEy8dvifPk3kgsp/Pi1hJUGaS6Q2Hq7VMmnV2YPUS6VubaqorJ8lbeNwtqGmpseiXx6MH5DRWn2qOB0OuFwOBAOh7m53W7Isgy/349gMMiN/EAggEgkws3r9UKSJL43FAo11+PxOASPx8OTVEgzFfh8viYoFdNB5NNMhTo47YnFYhBFEYQTjUYhUNLlcnEQ+jVGPfQf067TSuMvvubXczTiPGcAAAAASUVORK5CYII=&apos;); background-size: cover; display: block;&quot;
  &gt;&lt;/span&gt;
  &lt;img
        class=&quot;gatsby-resp-image-image&quot;
        alt=&quot;20210218 3&quot;
        title=&quot;20210218 3&quot;
        src=&quot;/static/51d1803cf07d992055d5e2aed1577d2e/d7abb/20210218-3.png&quot;
        srcset=&quot;/static/51d1803cf07d992055d5e2aed1577d2e/5a46d/20210218-3.png 300w,
/static/51d1803cf07d992055d5e2aed1577d2e/0a47e/20210218-3.png 600w,
/static/51d1803cf07d992055d5e2aed1577d2e/d7abb/20210218-3.png 959w&quot;
        sizes=&quot;(max-width: 959px) 100vw, 959px&quot;
        style=&quot;width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;&quot;
        loading=&quot;lazy&quot;
      /&gt;
    &lt;/span&gt;&lt;br&gt;
함수의 크기가 크다면 그에 비례해서 콜드 스타트 문제도 더 크게 발생할 수 있으므로, 함수의 크기를 최대한 줄이는 것 또한 사용자가 할 수 있는 최적화의 한 방법이 될 수 있다.&lt;/p&gt;
&lt;h2 id=&quot;references&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#references&quot; aria-label=&quot;references permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;References&lt;/h2&gt;
&lt;p&gt;서버리스 개념 관련&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href=&quot;https://www.redhat.com/ko/topics/cloud-native-apps/what-is-serverless&quot;&gt;https://www.redhat.com/ko/topics/cloud-native-apps/what-is-serverless&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://www.redhat.com/ko/topics/cloud-native-apps/what-is-faas&quot;&gt;https://www.redhat.com/ko/topics/cloud-native-apps/what-is-faas&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://cloudmt.co.kr/?p=3774&quot;&gt;https://cloudmt.co.kr/?p=3774&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;콜드 스타트 관련&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Paulo Silva, Daniel Fireman, and Thiago Emmanuel Pereira, 2020. &lt;em&gt;Prebaking Functions to Warm the Serverless Cold Start&lt;/em&gt;. In &lt;em&gt;Middleware ‘20, December 7-11, 2020, Delft, Netherlands&lt;/em&gt;. &lt;a href=&quot;https://doi.org/10.1145/3423211.3425682&quot;&gt;https://doi.org/10.1145/3423211.3425682&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://lumigo.io/aws-lambda-performance-optimization/how-to-improve-aws-lambda-cold-start-performance/&quot;&gt;https://lumigo.io/aws-lambda-performance-optimization/how-to-improve-aws-lambda-cold-start-performance/&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://lumigo.io/aws-lambda-performance-optimization/&quot;&gt;https://lumigo.io/aws-lambda-performance-optimization/&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://levelup.gitconnected.com/lambda-cold-starts-language-comparison-%EF%B8%8F-a4f4b5f16a62&quot;&gt;https://levelup.gitconnected.com/lambda-cold-starts-language-comparison-️-a4f4b5f16a62&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;이미지 출처&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href=&quot;https://www.slideshare.net/AmazonWebServices/become-a-serverless-black-belt-optimizing-your-serverless-applications-aws-online-tech-talks/14&quot;&gt;https://www.slideshare.net/AmazonWebServices/become-a-serverless-black-belt-optimizing-your-serverless-applications-aws-online-tech-talks/14&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://levelup.gitconnected.com/lambda-cold-starts-language-comparison-%EF%B8%8F-a4f4b5f16a62&quot;&gt;https://levelup.gitconnected.com/lambda-cold-starts-language-comparison-️-a4f4b5f16a62&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;Paulo Silva, Daniel Fireman, and Thiago Emmanuel Pereira, 2020. &lt;em&gt;Prebaking Functions to Warm the Serverless Cold Start&lt;/em&gt;. In &lt;em&gt;Middleware ‘20, December 7-11, 2020, Delft, Netherlands&lt;/em&gt;. &lt;a href=&quot;https://doi.org/10.1145/3423211.3425682&quot;&gt;https://doi.org/10.1145/3423211.3425682&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;</content:encoded></item><item><title><![CDATA[나만의 Golang 바이블 | Ep. 0]]></title><description><![CDATA[※ 주의 본 포스팅 시리즈는 제가 빠르게 찾아볼 수 있도록 개인적으로 공부하면서 정리했으며, 조사가 미흡해 오류가 있을 수 있습니다. Go Go언어는 구글의 로버트 그리즈머(Robert Griesemer), 롭 파이크(Rob Pike…]]></description><link>https://blog.frec.kr/golang/bible-0/</link><guid isPermaLink="false">https://blog.frec.kr/golang/bible-0/</guid><pubDate>Fri, 07 Aug 2020 16:26:00 GMT</pubDate><content:encoded>&lt;p&gt;※ 주의&lt;/p&gt;
&lt;p&gt;본 포스팅 시리즈는 제가 빠르게 찾아볼 수 있도록 개인적으로 공부하면서 정리했으며, 조사가 미흡해 오류가 있을 수 있습니다.&lt;/p&gt;
&lt;h2 id=&quot;go&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#go&quot; aria-label=&quot;go permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;Go&lt;/h2&gt;
&lt;p&gt;Go언어는 구글의 로버트 그리즈머(Robert Griesemer), 롭 파이크(Rob Pike), 켄 톰슨(Ken Thompson)에 의해 개발되었다. 롭 파이크의 말에 의하면 대규모 소프트웨어 서비스를 제작하고 읽고 디버깅하는 개발자들을 위해 설계되었다고 한다.&lt;/p&gt;
&lt;p&gt;첫 버전은 2009년 10월에 공개되었고, 2016년 이후로는 2월, 8월에 메이저 업데이트가 있다.&lt;/p&gt;
&lt;p&gt;2020년 8월 기준으로 최신 메이저 버전은 이번에 공개된 1.15이며, Go 2 버전도 계속 논의되고 있는 듯 하다.&lt;/p&gt;
&lt;p&gt;※ Go라는 단어가 가지는 의미가 많다보니 구글에서 검색하려면 golang이라는 키워드를 사용하는 것이 편하다.&lt;/p&gt;
&lt;h2 id=&quot;특징&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#%ED%8A%B9%EC%A7%95&quot; aria-label=&quot;특징 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;특징&lt;/h2&gt;
&lt;p&gt;랭킹으로 보는 Go의 최근 동향&lt;/p&gt;
&lt;p&gt;&lt;span
      class=&quot;gatsby-resp-image-wrapper&quot;
      style=&quot;position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 944px; &quot;
    &gt;
      &lt;span
    class=&quot;gatsby-resp-image-background-image&quot;
    style=&quot;padding-bottom: 59.333333333333336%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAMCAYAAABiDJ37AAAACXBIWXMAAA7DAAAOwwHHb6hkAAABi0lEQVQoz2VT27KCMAz0/z/RB+eggMLIRUToDXKyq3F65jxkutDtZpO0h6ZppOs6STHK9XqVx+MhPgSpr7Wsq5NxHKWqKqnrmuG9l5QS1+KnUM4q4zBwb993OUQV2raNBOCUFLtVYnA8uCwL/4MMXtBkFkyu51blPJ9P8g/OOW5ig1gPh+AleEehaZpIBgYHXMN93/P7Nc8UpyB+AJgoyHnAoXHy/+bQOEiMCujQMhqOn5KA4Q59tGT/HCqePxwKGhFrfigXxNDs+7sqFw5Z8usl02N6l5wLYmIxJnF+VbcLMcjmPE8EPlyZ4J8ewqod2HSaKWrPdDDA1kNw8jD3EEFCiPLalGUpjMtFiqLgnSurUi4awKfTSc7nM3Ee5aWU4/H45QC3bSMHNBZ2B72c9/udveiHTrrhzsndmhubDzfgWaBcewht2/Jiz3p92EMrAXjfdglJr1D0LAElI1AWyrOSgVFmUuy09xBjydYjrxf5/Sr0Wa0qsMx8NXDS65Sx5sNBclQFDDHsI8kvUcahCwZPX2oAAAAASUVORK5CYII=&apos;); background-size: cover; display: block;&quot;
  &gt;&lt;/span&gt;
  &lt;img
        class=&quot;gatsby-resp-image-image&quot;
        alt=&quot;20200807 2&quot;
        title=&quot;20200807 2&quot;
        src=&quot;/static/32c86cc66d21a8338d1b8414f086409c/966a0/20200807-2.png&quot;
        srcset=&quot;/static/32c86cc66d21a8338d1b8414f086409c/5a46d/20200807-2.png 300w,
/static/32c86cc66d21a8338d1b8414f086409c/0a47e/20200807-2.png 600w,
/static/32c86cc66d21a8338d1b8414f086409c/966a0/20200807-2.png 944w&quot;
        sizes=&quot;(max-width: 944px) 100vw, 944px&quot;
        style=&quot;width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;&quot;
        loading=&quot;lazy&quot;
      /&gt;
    &lt;/span&gt;  &lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href=&quot;https://www.tiobe.com/tiobe-index/&quot;&gt;Tiobe Index&lt;/a&gt; 11위 (2020년 8월 기준, 1년 전에 비해 7단계 상승)&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://madnight.github.io/githut/#/stars/2020/1&quot;&gt;github star 3위&lt;/a&gt; (2020년 1분기 기준)&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;Go를 주로 사용하는 오픈소스 프로젝트들로는 &lt;em&gt;Docker&lt;/em&gt;, &lt;em&gt;Kubernetes&lt;/em&gt;, &lt;em&gt;Prometheus&lt;/em&gt;, &lt;em&gt;InfluxDB&lt;/em&gt; 등이 있으며 클라우드쪽 분야에서 특히 선호하는 듯하다. (중국에서도 많은 인기를 끄는 것 같다)&lt;/p&gt;
&lt;p&gt;언어 설계 측면&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;문법적으로 C와 유사함. (정적 타입, 코드를 묶는데 중괄호를 사용하는 등)&lt;/li&gt;
&lt;li&gt;Python 등 동적 타이핑 언어처럼 좋은 &lt;strong&gt;생산성&lt;/strong&gt;, &lt;strong&gt;가독성&lt;/strong&gt;.&lt;/li&gt;
&lt;li&gt;class가 없으며 상속 등의 개념도 없음. 다만 &lt;code class=&quot;language-text&quot;&gt;struct&lt;/code&gt;와 &lt;code class=&quot;language-text&quot;&gt;interface&lt;/code&gt;가 있음.&lt;/li&gt;
&lt;li&gt;빠른 컴파일 속도.&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;가비지 컬렉션의 존재.&lt;/p&gt;
&lt;p&gt;(C를 완전히 대체하기가 어려운 이유 중 하나)&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;고루틴&lt;/strong&gt;(매우 경량화된 쓰레드의 일종)과 &lt;strong&gt;채널&lt;/strong&gt;의 존재.&lt;/p&gt;
&lt;p&gt;→ 매우 쉬운 동시성 프로그래밍&lt;/p&gt;
&lt;p&gt;→ 네트워킹, 멀티프로세싱 등에 고효율&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;원격 저장소에서 바로 가져와 임포트할 수 있는 패키지 시스템.&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id=&quot;설치&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#%EC%84%A4%EC%B9%98&quot; aria-label=&quot;설치 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;설치&lt;/h2&gt;
&lt;p&gt;&lt;a href=&quot;https://golang.org/dl/&quot;&gt;https://golang.org/dl/&lt;/a&gt;&lt;/p&gt;
&lt;h2 id=&quot;공부에-도움될-자료들&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#%EA%B3%B5%EB%B6%80%EC%97%90-%EB%8F%84%EC%9B%80%EB%90%A0-%EC%9E%90%EB%A3%8C%EB%93%A4&quot; aria-label=&quot;공부에 도움될 자료들 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;공부에 도움될 자료들&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;&lt;a href=&quot;http://pyrasis.com/go.html&quot;&gt;http://pyrasis.com/go.html&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;→ 한국어 작성으로, 차근차근 따라하면서 공부하기 좋다. 이 블로그 토대로 책도 집필하신 것 같다.&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;a href=&quot;https://play.golang.org/&quot;&gt;https://play.golang.org&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;→ IDE 없이 간단히 문법 공부하는 용도로 사용하기 좋다.&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;a href=&quot;http://www.acornpub.co.kr/book/concurrency-in-go&quot;&gt;[Go 동시성 프로그래밍]&lt;/a&gt;, Katherine Cox-Buday 저&lt;/p&gt;
&lt;p&gt;→ Go에 웬만큼 적응했을 때 읽기 좋다. 동시성에 대한 개념과 여러 패턴 및 테크닉을 소개한다.&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id=&quot;references&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#references&quot; aria-label=&quot;references permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;References&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href=&quot;https://www.infoworld.com/article/3442978/10-open-source-projects-proving-the-power-of-google-go.html&quot;&gt;https://www.infoworld.com/article/3442978/10-open-source-projects-proving-the-power-of-google-go.html&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://kuree.gitbooks.io/the-go-programming-language-report&quot;&gt;https://kuree.gitbooks.io/the-go-programming-language-report&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://en.wikipedia.org/wiki/Go_(programming_language)&quot;&gt;https://en.wikipedia.org/wiki/Go&lt;em&gt;(programming&lt;/em&gt;language)&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://qarea.com/blog/the-evolution-of-go-a-history-of-success&quot;&gt;https://qarea.com/blog/the-evolution-of-go-a-history-of-success&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;</content:encoded></item><item><title><![CDATA[Docker Network 간단 정리]]></title><description><![CDATA[Docker Network 도커 컨테이너는 기본적으로 ,  인터페이스를 가지고 있다. 각 컨테이너의 에는  대역의 IP가 할당되는데, 이 대역은 호스트 내부의 사설 IP…]]></description><link>https://blog.frec.kr/docker/docker_network/</link><guid isPermaLink="false">https://blog.frec.kr/docker/docker_network/</guid><pubDate>Fri, 24 Jul 2020 10:54:00 GMT</pubDate><content:encoded>&lt;h2 id=&quot;docker-network&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#docker-network&quot; aria-label=&quot;docker network permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;Docker Network&lt;/h2&gt;
&lt;p&gt;도커 컨테이너는 기본적으로 &lt;code class=&quot;language-text&quot;&gt;lo&lt;/code&gt;, &lt;code class=&quot;language-text&quot;&gt;eth0&lt;/code&gt; 인터페이스를 가지고 있다.&lt;/p&gt;
&lt;p&gt;각 컨테이너의 &lt;code class=&quot;language-text&quot;&gt;eth0&lt;/code&gt;에는 &lt;code class=&quot;language-text&quot;&gt;172.17.0.0/16&lt;/code&gt; 대역의 IP가 할당되는데, 이 대역은 호스트 내부의 사설 IP이므로 외부에서 접속이 불가능하다.&lt;/p&gt;
&lt;p&gt;그래서 도커 엔진에서는 호스트에 &lt;code class=&quot;language-text&quot;&gt;veth&lt;/code&gt; 라는 가상 네트워크 인터페이스를 만들고, 각 컨테이너의 &lt;code class=&quot;language-text&quot;&gt;eth0&lt;/code&gt;와 연결한다. 이때, &lt;code class=&quot;language-text&quot;&gt;veth&lt;/code&gt; 인터페이스들은 호스트의 &lt;code class=&quot;language-text&quot;&gt;docker0&lt;/code&gt; 브릿지에 바인딩되어 외부와의 통신을 가능케 한다.&lt;/p&gt;
&lt;p&gt;이 &lt;code class=&quot;language-text&quot;&gt;docker0&lt;/code&gt; 브릿지는 도커 컨테이너들의 &lt;strong&gt;게이트웨이&lt;/strong&gt; 역할을 한다.&lt;/p&gt;
&lt;p&gt;&lt;span
      class=&quot;gatsby-resp-image-wrapper&quot;
      style=&quot;position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 1200px; &quot;
    &gt;
      &lt;span
    class=&quot;gatsby-resp-image-background-image&quot;
    style=&quot;padding-bottom: 47.333333333333336%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAJCAYAAAAywQxIAAAACXBIWXMAABcRAAAXEQHKJvM/AAACLUlEQVQoz12Sy08TQRzHJ8Z/zqsX490YTEy8GA/8CT4SQCSgxBiMiRcxhqQqQgxSSkGqpUi3s9uXlJZ9zc5juy2ldL7Otpw8fPKbZGaS7+NHuOCk47VvOI6dUFpBu9PWnEeaRQz/Exm6MkRsCEIffjBGS+5rxQP4ob9DABBzueC5HlzXvWCMQUo5RggBzgUiQz/p4shu4P7SFh69yeHYqsC2KWpVG2u5Y3zetyA5A8EIxPXdWRV3IZUacs61kFJzIdHrxhgNkvHsJwl2SzZuPdnA3YUs9n4WsJM1czen576UMb9u6Sj0LscKGfNn04/DfneYxFKnZ1wkqLcDbBZPUG56RnGMkt3E7KcDLGWKoI6DWq2Ker2KQ8vRJVoFj5gmsqcJbbaebx21sP2nNSw3XKz/+ovfzhlWczXce5XHyncKKRTiWEGfC1z2uYlhkmto6MUMgySNhoMQcv3aZsF58XDlANPvCsPVXFVPvczj8ccS3v9wcGcxh9cbFQx6icmwiQfL25h+m0eF2nCMykbNQWbP0usHFIIbhVeWZ0aDHi7PJ5aNd2B0Duc0xLdiC4f1ieWdIsXtZ5uYWswiv19A9irDmUxZz321YDIcEWgQz3cXhFQwRVykrZ6ZxlunbfPAh4p8CBaM7aYtP/2wh/m1AixK4ZiGq4bDMjU52um6GXURI63Oyc20XaXUmCAI0hWC5/vonE1mukaxkuh3ucmMI/0cTdBSRFpJjpCFR/8AR793zO/6uqwAAAAASUVORK5CYII=&apos;); background-size: cover; display: block;&quot;
  &gt;&lt;/span&gt;
  &lt;img
        class=&quot;gatsby-resp-image-image&quot;
        alt=&quot;20200724-2.png&quot;
        title=&quot;20200724-2.png&quot;
        src=&quot;/static/8cfea48c2d9abc2ffd2e2d28bbfe73a5/c1b63/20200724-2.png&quot;
        srcset=&quot;/static/8cfea48c2d9abc2ffd2e2d28bbfe73a5/5a46d/20200724-2.png 300w,
/static/8cfea48c2d9abc2ffd2e2d28bbfe73a5/0a47e/20200724-2.png 600w,
/static/8cfea48c2d9abc2ffd2e2d28bbfe73a5/c1b63/20200724-2.png 1200w,
/static/8cfea48c2d9abc2ffd2e2d28bbfe73a5/71c1d/20200724-2.png 1536w&quot;
        sizes=&quot;(max-width: 1200px) 100vw, 1200px&quot;
        style=&quot;width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;&quot;
        loading=&quot;lazy&quot;
      /&gt;
    &lt;/span&gt;  &lt;/p&gt;
&lt;h2 id=&quot;docker-network-drivers&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#docker-network-drivers&quot; aria-label=&quot;docker network drivers permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;Docker Network Drivers&lt;/h2&gt;
&lt;p&gt;도커에서 기본으로 제공하는 네트워크 드라이버는 다음이 있다.&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;code class=&quot;language-text&quot;&gt;bridge&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;&lt;code class=&quot;language-text&quot;&gt;host&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;&lt;code class=&quot;language-text&quot;&gt;overlay&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;&lt;code class=&quot;language-text&quot;&gt;none&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;&lt;code class=&quot;language-text&quot;&gt;macvlan&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;Network Plugins (도커에서 제공하지 않는 3rd-party 플러그인)&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id=&quot;bridge-network&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#bridge-network&quot; aria-label=&quot;bridge network permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;Bridge Network&lt;/h2&gt;
&lt;p&gt;네트워크 드라이버 기본 세팅이다.&lt;/p&gt;
&lt;p&gt;도커 엔진 설치 시 기본으로 생성되는 docker0도 브릿지 네트워크이며, 사용자가 직접 브릿지 네트워크를 생성해 적용할 수도 있다.&lt;/p&gt;
&lt;p&gt;같은 도커 호스트에서 여러 컨테이너들이 통신할 필요가 있을 때 가장 유용하다.&lt;/p&gt;
&lt;h2 id=&quot;host-network&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#host-network&quot; aria-label=&quot;host network permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;Host Network&lt;/h2&gt;
&lt;p&gt;호스트 네트워크는 컨테이너의 네트워크를 직접 호스트에 연결해 사용하는 방식으로, 컨테이너들의 네트워크가 도커 호스트에서 따로 고립될 필요가 없을 때 사용한다.&lt;/p&gt;
&lt;h2 id=&quot;overlay-network&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#overlay-network&quot; aria-label=&quot;overlay network permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;Overlay Network&lt;/h2&gt;
&lt;p&gt;오버레이 네트워크는 여러 도커 데몬(한 호스트에 여러 데몬 or 여러 호스트)에서 실행되는 컨테이너들을 한 네트워크로 묶는다. Swarm 서비스 사용할 때 사용된다.&lt;/p&gt;
&lt;h2 id=&quot;none-network&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#none-network&quot; aria-label=&quot;none network permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;None Network&lt;/h2&gt;
&lt;p&gt;컨테이너에 모든 네트워크를 비활성화한다. 보통 커스텀 네트워크 드라이버와 같이 구성되어 사용된다. Swarm 서비스에는 사용이 불가능하다.&lt;/p&gt;
&lt;h2 id=&quot;macvlan-network&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#macvlan-network&quot; aria-label=&quot;macvlan network permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;Macvlan Network&lt;/h2&gt;
&lt;p&gt;컨테이너에 MAC 주소를 할당해서, 네트워크에 물리 디바이스로 나타나게 한다.&lt;/p&gt;</content:encoded></item><item><title><![CDATA[169.254.x.x :: Link-Local Addresses]]></title><description><![CDATA[라즈베리파이로 유선 사설 네트워크 구축할때, 인터페이스 두 개(, )를 브릿지로 묶어 구성했었다. Worker(RPi #1, #2)들의 IP는 DHCP 설정한대로  대역을 할당받았지만,  브릿지에 묶인 , 는  대역의 IP…]]></description><link>https://blog.frec.kr/networking/link-local-address/</link><guid isPermaLink="false">https://blog.frec.kr/networking/link-local-address/</guid><pubDate>Wed, 22 Jul 2020 16:25:00 GMT</pubDate><content:encoded>&lt;p&gt;&lt;a href=&quot;https://blog.frec.kr/2020/07/17/20200717-1/&quot;&gt;라즈베리파이로 유선 사설 네트워크 구축&lt;/a&gt;할때, 인터페이스 두 개(&lt;code class=&quot;language-text&quot;&gt;eth1&lt;/code&gt;, &lt;code class=&quot;language-text&quot;&gt;eth2&lt;/code&gt;)를 브릿지로 묶어 구성했었다.&lt;/p&gt;
&lt;p&gt;Worker(RPi #1, #2)들의 IP는 DHCP 설정한대로 &lt;code class=&quot;language-text&quot;&gt;192.168.77.0/24&lt;/code&gt; 대역을 할당받았지만, &lt;code class=&quot;language-text&quot;&gt;br0&lt;/code&gt; 브릿지에 묶인 &lt;code class=&quot;language-text&quot;&gt;eth1&lt;/code&gt;, &lt;code class=&quot;language-text&quot;&gt;eth2&lt;/code&gt;는 &lt;code class=&quot;language-text&quot;&gt;169.254.0.0/16&lt;/code&gt; 대역의 IP를 가지고 있었다.&lt;/p&gt;
&lt;p&gt;&lt;span
      class=&quot;gatsby-resp-image-wrapper&quot;
      style=&quot;position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 1200px; &quot;
    &gt;
      &lt;span
    class=&quot;gatsby-resp-image-background-image&quot;
    style=&quot;padding-bottom: 38.99999999999999%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAICAYAAAD5nd/tAAAACXBIWXMAABcRAAAXEQHKJvM/AAACX0lEQVQozy2RXUhTYRjHn23WRXRR2U0tSDApcBJBkRfddNUHYRAIfSB9MAILtXJzTkl3nOdsng1dutKdeeZxOztpm8pG5ddm02luc0nLEQlBF4EXeddFtj58es+hF37vA+8Dv+f/8MJQqhOG0zQIBO+iBRAR/h/VL1yHrzgDXwifMQ4/MEj67YQuwixIc8aTU1mDPpo21QiTbXfcr1qqQAsnQA2H4Pzxa1BaUgYl5VpFWn76SJFr1V7mXeqqcC/QOleS1YkzZt2nfE3FWv627mzTNPRG7RIV6Ed2zI3hOI2+hPUbsGIz0D4juCMUPLDdUmTOCaOcunIsZkEpY/05nmML0TWmMLLAFEwD3FaLj0NGaKh+5LfRej5caJACG9J75/fgqmMZuASVJaT5pHW9O9J0jqy6k7DDzNddNonDWB8Y/dMm9m/X9/q3zc/5bUM4+NsY9qNz0lZ7j+dJALIgoBIEcRPAO98hEHy+pc6QJ9F+isg0crNr3HSJmRpES1RAdtaDrZFh7HzJ4UNRQoMUQHqCuj/E6w8+85mveEXzBXHRWiWkmTMgJO0wNG8DMeUELt6hTGKkevDMPT469oFJj+eZlXDOnol8pDOhBJWhhZ4ME3TlXOLdSpNgF252h7DO68fRLIviCrsB4rJDE3jr0IxkezSBFKuSv7c7bFDEieRFQEp+QYU98o0Kasf0E+AWWZdn+enfwXTf5os3ti0+Tr2D3lgTuOPN0BczQc90I5QeO6zIahqrVCq1ai9x7CfItZiwD6BoF8B1ebCa4at386+vavsjNw7QXK22dUBf/A+1iELl2Vn9RwAAAABJRU5ErkJggg==&apos;); background-size: cover; display: block;&quot;
  &gt;&lt;/span&gt;
  &lt;img
        class=&quot;gatsby-resp-image-image&quot;
        alt=&quot;20200722-1.png&quot;
        title=&quot;20200722-1.png&quot;
        src=&quot;/static/0608fec22b7f52539d103d868a752aab/c1b63/20200722-1.png&quot;
        srcset=&quot;/static/0608fec22b7f52539d103d868a752aab/5a46d/20200722-1.png 300w,
/static/0608fec22b7f52539d103d868a752aab/0a47e/20200722-1.png 600w,
/static/0608fec22b7f52539d103d868a752aab/c1b63/20200722-1.png 1200w,
/static/0608fec22b7f52539d103d868a752aab/9040f/20200722-1.png 1613w&quot;
        sizes=&quot;(max-width: 1200px) 100vw, 1200px&quot;
        style=&quot;width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;&quot;
        loading=&quot;lazy&quot;
      /&gt;
    &lt;/span&gt;  &lt;/p&gt;
&lt;h2 id=&quot;1692540016&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#1692540016&quot; aria-label=&quot;1692540016 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;169.254.0.0/16&lt;/h2&gt;
&lt;p&gt;&lt;a href=&quot;https://tools.ietf.org/html/rfc3927&quot;&gt;IETF&lt;/a&gt;에 따르면, &lt;code class=&quot;language-text&quot;&gt;eth1&lt;/code&gt;과  &lt;code class=&quot;language-text&quot;&gt;eth2&lt;/code&gt;에 할당됐던 &lt;code class=&quot;language-text&quot;&gt;169.254.0.0/16&lt;/code&gt; 대역의 IP 주소는 DHCP 서버를 찾을 수 없는 경우 동적으로 부여되는 &lt;strong&gt;Link-Local Address&lt;/strong&gt;였다.&lt;/p&gt;
&lt;p&gt;여기서 DHCP 서버는 &lt;code class=&quot;language-text&quot;&gt;br0&lt;/code&gt;에 할당하도록 설정해뒀으니 &lt;code class=&quot;language-text&quot;&gt;eth1&lt;/code&gt;, &lt;code class=&quot;language-text&quot;&gt;eth2&lt;/code&gt;에서는 DHCP를 찾을 수 없어 해당 대역이 할당된 것으로 보인다.&lt;/p&gt;
&lt;p&gt;이 대역의 주소는 단일 세그먼트 네트워크에서만 유효하며 routing은 불가능하다.&lt;/p&gt;
&lt;h2 id=&quot;references&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#references&quot; aria-label=&quot;references permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;References&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href=&quot;https://kb.iu.edu/d/aoyj&quot;&gt;https://kb.iu.edu/d/aoyj&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://tools.ietf.org/html/rfc3927&quot;&gt;https://tools.ietf.org/html/rfc3927&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;</content:encoded></item><item><title><![CDATA[DHCP 간단 정리]]></title><description><![CDATA[DHCP (Dynamic Host Configuration Protocol) TCP/IP 통신을 위해 필요한 설정 정보를 할당/관리하기 위한 프로토콜이다. 7계층에 위치한 프로토콜로 UDP…]]></description><link>https://blog.frec.kr/networking/dhcp/</link><guid isPermaLink="false">https://blog.frec.kr/networking/dhcp/</guid><pubDate>Fri, 17 Jul 2020 21:00:00 GMT</pubDate><content:encoded>&lt;h2 id=&quot;dhcp-dynamic-host-configuration-protocol&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#dhcp-dynamic-host-configuration-protocol&quot; aria-label=&quot;dhcp dynamic host configuration protocol permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;DHCP (Dynamic Host Configuration Protocol)&lt;/h2&gt;
&lt;p&gt;TCP/IP 통신을 위해 필요한 설정 정보를 할당/관리하기 위한 프로토콜이다.&lt;/p&gt;
&lt;p&gt;7계층에 위치한 프로토콜로 UDP 기반으로 통신한다.&lt;/p&gt;
&lt;p&gt;동작은 다음과 같은 순서로 이루어진다.&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;
&lt;p&gt;DHCP Discover&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;클라이언트에서 Broadcast로 IP 할당 요청을 한다.&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;DHCP Offer&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;서버에서 클라이언트에게 (&lt;strong&gt;Broadcast&lt;/strong&gt; or &lt;strong&gt;Unicast&lt;/strong&gt;)로 네트워크 정보 및 할당될 IP주소를 제공한다.&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;DHCP Request&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;클라이언트에서 Broadcast로 해당 IP 할당 요청을 한다.&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;DHCP Ack&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;서버에서 클라이언트에게 DHCP Request에 대한 Ack을 돌려준다.&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ol&gt;</content:encoded></item><item><title><![CDATA[Raspberry Pi as a Wired Router]]></title><description><![CDATA[수정사항 2020-07-18 01:50 :: 누락되었던 bridge 설정 섹션 추가 2020-07-21 14:48 :: Goal 이미지 추가, 결과 이미지 추가, 순서 일부 변경 2020-12-14 02:50 :: 설명 한 줄 추가 Goal…]]></description><link>https://blog.frec.kr/networking/rpi-wired-router/</link><guid isPermaLink="false">https://blog.frec.kr/networking/rpi-wired-router/</guid><pubDate>Fri, 17 Jul 2020 13:45:00 GMT</pubDate><content:encoded>&lt;p&gt;수정사항&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;2020-07-18 01:50 :: 누락되었던 bridge 설정 섹션 추가&lt;br&gt;
2020-07-21 14:48 :: Goal 이미지 추가, 결과 이미지 추가, 순서 일부 변경&lt;br&gt;
2020-12-14 02:50 :: 설명 한 줄 추가&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h2 id=&quot;goal-&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#goal-&quot; aria-label=&quot;goal  permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;Goal 🏀&lt;/h2&gt;
&lt;p&gt;&lt;span
      class=&quot;gatsby-resp-image-wrapper&quot;
      style=&quot;position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 1200px; &quot;
    &gt;
      &lt;span
    class=&quot;gatsby-resp-image-background-image&quot;
    style=&quot;padding-bottom: 45.666666666666664%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAJCAYAAAAywQxIAAAACXBIWXMAABcRAAAXEQHKJvM/AAAB5UlEQVQoz52S3WoTQRiG35nZ//za7G6TCDZNiXWbNFI3pog/NaXS0Nggoa1pkJRqS1uo0AgqFgSFHvWgB16AAU9zCeKRB0WsXoCHegO9gMI40ya0iiB04NkZ2Pmemd3vBc4xqHy4BsHcILCSAlp5qJUrAOd/7vlXLR12NXIzpdPbaV3Luerx3rBC0RoCsuEYJqwBTNkDbNhJEYDJInZGelZMiB1gpDICLGeBeg6RqgdRBLM4pBf4IQIPi+/cjTKPvrx/ZD3xv693Xb7AE+QEes8W7VkrXgXN7FM08q1w1XsA3gZLuxfs/W2YjfG9wc0aT76pH+krY1/bXeFVQakrNgUGFGrE7Lhcq/bS5Lf0s3ke365xvTl60CfPSoQcpMVdC1oAebi4LsgkYr2vLQsWBTNSIC8FlVEze0m+JOpi4bmzPt0JvZ7tqKv+FngHyDhR59cu9NrYZnDt7mezde+TuTDaLnWFUmIJtNNWkOPJ6O+j/e9X8fjHR9zhB4jyF9iR/+VyMlQSHQ02b33IbC3wi28b3Nzwf+6f9uOvYShgunaiDmg2C1tJFo/YxFITMjDQWEwcGcFEysd8/hFZu1EnVa8sGqD8P3SMMiFgMEVU5PokCQSJoIK5EdDlItirKbClayKHX/AbpLVUY3nOzl8AAAAASUVORK5CYII=&apos;); background-size: cover; display: block;&quot;
  &gt;&lt;/span&gt;
  &lt;img
        class=&quot;gatsby-resp-image-image&quot;
        alt=&quot;20200717-1.png&quot;
        title=&quot;20200717-1.png&quot;
        src=&quot;/static/8d422c75074000a77c0de63a4bedfc4a/c1b63/20200717-1.png&quot;
        srcset=&quot;/static/8d422c75074000a77c0de63a4bedfc4a/5a46d/20200717-1.png 300w,
/static/8d422c75074000a77c0de63a4bedfc4a/0a47e/20200717-1.png 600w,
/static/8d422c75074000a77c0de63a4bedfc4a/c1b63/20200717-1.png 1200w,
/static/8d422c75074000a77c0de63a4bedfc4a/8a69d/20200717-1.png 1209w&quot;
        sizes=&quot;(max-width: 1200px) 100vw, 1200px&quot;
        style=&quot;width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;&quot;
        loading=&quot;lazy&quot;
      /&gt;
    &lt;/span&gt;  &lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;text&quot;&gt;&lt;pre class=&quot;language-text&quot;&gt;&lt;code class=&quot;language-text&quot;&gt;                                         +- RPi #1 ------+
                                     +---+ 192.168.77.10 |
                                     |   | {eth0}        |
                                     |   +---------------+
                 +- RPi #0------+    |
                 | DHCP  Server +----+ {eth1}
(Internet)   (((-+ {wlan0}      |
                 | 192.168.77.1 +----+ {eth2}
                 +--------------+    | 
                                     |   +- RPi #2 ------+
                                     +---+ {eth0}        |
                                         | 192.168.77.11 |
                                         +---------------+&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;ul&gt;
&lt;li&gt;외부 AP와 연결된 RPi #0은 일종의 유선 공유기 역할로, Worker들이 eth로 연결 시 IP 주소를 할당.&lt;/li&gt;
&lt;li&gt;다만 eth로 연결되는 공유기와 다르게, RPi #0은 wlan0으로 AP와 연결됨.&lt;/li&gt;
&lt;li&gt;Worker들의 MAC 주소를 참조하여 &lt;strong&gt;고정된 사설IP&lt;/strong&gt;를 제공해야 함.&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id=&quot;필요한-패키지-설치&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#%ED%95%84%EC%9A%94%ED%95%9C-%ED%8C%A8%ED%82%A4%EC%A7%80-%EC%84%A4%EC%B9%98&quot; aria-label=&quot;필요한 패키지 설치 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;필요한 패키지 설치&lt;/h2&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;bash&quot;&gt;&lt;pre class=&quot;language-bash&quot;&gt;&lt;code class=&quot;language-bash&quot;&gt;$ &lt;span class=&quot;token function&quot;&gt;sudo&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;apt&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;install&lt;/span&gt; -y &lt;span class=&quot;token function&quot;&gt;vim&lt;/span&gt; bridge-utils&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;h2 id=&quot;bridge-설정&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#bridge-%EC%84%A4%EC%A0%95&quot; aria-label=&quot;bridge 설정 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;bridge 설정&lt;/h2&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;bash&quot;&gt;&lt;pre class=&quot;language-bash&quot;&gt;&lt;code class=&quot;language-bash&quot;&gt;$ &lt;span class=&quot;token function&quot;&gt;sudo&lt;/span&gt; brctl addbr br0
$ &lt;span class=&quot;token function&quot;&gt;sudo&lt;/span&gt; brctl addif br0 eth1 eth2
$ &lt;span class=&quot;token function&quot;&gt;sudo&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;ifconfig&lt;/span&gt; br0 &lt;span class=&quot;token number&quot;&gt;192.168&lt;/span&gt;.77.1
$ &lt;span class=&quot;token function&quot;&gt;sudo&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;ifconfig&lt;/span&gt; br0 up&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;(이 설정은 재부팅 시마다 계속 다시 하고, &lt;code class=&quot;language-text&quot;&gt;$ sudo systemctl restart dnsmasq&lt;/code&gt;  명령으로 dnsmasq도 다시 시작해야한다.&lt;br&gt;
&lt;code class=&quot;language-text&quot;&gt;/home/pi&lt;/code&gt;에 &lt;code class=&quot;language-text&quot;&gt;bridge-setup.sh&lt;/code&gt;로 저장하고 &lt;code class=&quot;language-text&quot;&gt;crontab&lt;/code&gt;을 이용해서 부팅시에 자동 실행되도록 추가했다.)&lt;/p&gt;
&lt;h2 id=&quot;dhcpcdconf-설정&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#dhcpcdconf-%EC%84%A4%EC%A0%95&quot; aria-label=&quot;dhcpcdconf 설정 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;dhcpcd.conf 설정&lt;/h2&gt;
&lt;p&gt;&lt;code class=&quot;language-text&quot;&gt;/etc/dhcpcd.conf&lt;/code&gt;&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;text&quot;&gt;&lt;pre class=&quot;language-text&quot;&gt;&lt;code class=&quot;language-text&quot;&gt;interface br0
static ip_address=192.168.77.1/24&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;h2 id=&quot;netfilter-설정&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#netfilter-%EC%84%A4%EC%A0%95&quot; aria-label=&quot;netfilter 설정 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;netfilter 설정&lt;/h2&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;bash&quot;&gt;&lt;pre class=&quot;language-bash&quot;&gt;&lt;code class=&quot;language-bash&quot;&gt;$ &lt;span class=&quot;token function&quot;&gt;sudo&lt;/span&gt; iptables -t nat -A POSTROUTING -o wlan0 -j MASQUERADE

$ &lt;span class=&quot;token function&quot;&gt;sudo&lt;/span&gt; iptables -A FORWARD -i eth1 -o wlan0 -m state --state RELATED,ESTABLISHED -j ACCEPT
$ &lt;span class=&quot;token function&quot;&gt;sudo&lt;/span&gt; iptables -A FORWARD -i eth1 -o wlan0 

$ &lt;span class=&quot;token function&quot;&gt;sudo&lt;/span&gt; iptables -A FORWARD -i eth2 -o wlan0 -m state --state RELATED,ESTABLISHED -j ACCEPT
$ &lt;span class=&quot;token function&quot;&gt;sudo&lt;/span&gt; iptables -A FORWARD -i eth2 -o wlan0 

$ &lt;span class=&quot;token function&quot;&gt;sudo&lt;/span&gt; iptables -A FORWARD -i br0 -o wlan0 -m state --state RELATED,ESTABLISHED -j ACCEPT
$ &lt;span class=&quot;token function&quot;&gt;sudo&lt;/span&gt; iptables -A FORWARD -i br0 -o wlan0 

$ &lt;span class=&quot;token function&quot;&gt;sudo&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;apt&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;install&lt;/span&gt; iptables-persistent netfilter-persistent
$ &lt;span class=&quot;token function&quot;&gt;sudo&lt;/span&gt; systemctl &lt;span class=&quot;token builtin class-name&quot;&gt;enable&lt;/span&gt; netfilter-persistent&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;h2 id=&quot;dnsmasq-설치-및-세팅&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#dnsmasq-%EC%84%A4%EC%B9%98-%EB%B0%8F-%EC%84%B8%ED%8C%85&quot; aria-label=&quot;dnsmasq 설치 및 세팅 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;dnsmasq 설치 및 세팅&lt;/h2&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;bash&quot;&gt;&lt;pre class=&quot;language-bash&quot;&gt;&lt;code class=&quot;language-bash&quot;&gt;$ &lt;span class=&quot;token function&quot;&gt;sudo&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;apt&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;install&lt;/span&gt; dnsmasq
$ &lt;span class=&quot;token function&quot;&gt;sudo&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;mv&lt;/span&gt; /etc/dnsmasq.conf /etc/dnsmasq.conf.backup &lt;span class=&quot;token comment&quot;&gt;# 기존 config 파일 백업&lt;/span&gt;
$ &lt;span class=&quot;token function&quot;&gt;sudo&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;vim&lt;/span&gt; /etc/dnsmasq.conf&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;&lt;code class=&quot;language-text&quot;&gt;/etc/dnsmasq.conf&lt;/code&gt;&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;text&quot;&gt;&lt;pre class=&quot;language-text&quot;&gt;&lt;code class=&quot;language-text&quot;&gt;resolv-file=/etc/resolv.dnsmasq
interface=br0
dhcp-range=192.168.77.10,192.168.77.100,255.255.255.0,infinite&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;ul&gt;
&lt;li&gt;&lt;code class=&quot;language-text&quot;&gt;resolv-file&lt;/code&gt; : dns 서버 설정 파일 지정&lt;/li&gt;
&lt;li&gt;&lt;code class=&quot;language-text&quot;&gt;interface&lt;/code&gt; : dhcp 서버를 구동할 인터페이스 설정&lt;/li&gt;
&lt;li&gt;&lt;code class=&quot;language-text&quot;&gt;dhcp-range&lt;/code&gt; : dhcp 서버에서 할당할 IP 범위 지정, subnet mask 지정, 대여 시간(무한=infinite)&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id=&quot;dns-설정&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#dns-%EC%84%A4%EC%A0%95&quot; aria-label=&quot;dns 설정 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;DNS 설정&lt;/h2&gt;
&lt;p&gt;&lt;code class=&quot;language-text&quot;&gt;/etc/resolv.conf&lt;/code&gt; (기존 파일 수정)&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;bash&quot;&gt;&lt;pre class=&quot;language-bash&quot;&gt;&lt;code class=&quot;language-bash&quot;&gt;nameserver &lt;span class=&quot;token number&quot;&gt;192.168&lt;/span&gt;.77.1&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;&lt;code class=&quot;language-text&quot;&gt;/etc/resolv.dnsmasq&lt;/code&gt; (파일 새로 생성)&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;bash&quot;&gt;&lt;pre class=&quot;language-bash&quot;&gt;&lt;code class=&quot;language-bash&quot;&gt;nameserver &lt;span class=&quot;token number&quot;&gt;8.8&lt;/span&gt;.8.8&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;bash&quot;&gt;&lt;pre class=&quot;language-bash&quot;&gt;&lt;code class=&quot;language-bash&quot;&gt;$ &lt;span class=&quot;token function&quot;&gt;sudo&lt;/span&gt; systemctl restart dnsmasq&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;여기까지 했을 때 worker들에서 dns query도 성공하고 잘 동작하는 듯 한데, 외부 인터넷 접속이 안 된다.&lt;/p&gt;
&lt;p&gt;bridge의 패킷이 netfilter에 제대로 걸리지 않는 느낌.
그래서 다음을 추가로 진행했다.&lt;/p&gt;
&lt;h2 id=&quot;iptables-확인&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#iptables-%ED%99%95%EC%9D%B8&quot; aria-label=&quot;iptables 확인 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;iptables 확인&lt;/h2&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;bash&quot;&gt;&lt;pre class=&quot;language-bash&quot;&gt;&lt;code class=&quot;language-bash&quot;&gt;$ &lt;span class=&quot;token function&quot;&gt;sudo&lt;/span&gt; iptables -L -v&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;위 명령으로 확인해본 결과 bridge의 나가는 패킷, 들어오는 패킷이 전부 0으로, 아예 구동하지 않는 듯 했다.&lt;/p&gt;
&lt;p&gt;&lt;code class=&quot;language-text&quot;&gt;/proc/sys/net/ipv4/ip_forward&lt;/code&gt; 에 1을 설정했던 것처럼&lt;/p&gt;
&lt;p&gt;&lt;code class=&quot;language-text&quot;&gt;/proc/sys/net/bridge/bridge-nf-call-iptables&lt;/code&gt;, &lt;code class=&quot;language-text&quot;&gt;/proc/sys/net/bridge/bridge-nf-call-arptables&lt;/code&gt; 를 모두 1로 설정했다.&lt;/p&gt;
&lt;p&gt;No such file or directory 에러가 뜨는데,&lt;/p&gt;
&lt;p&gt;&lt;code class=&quot;language-text&quot;&gt;/etc/sysctl.conf&lt;/code&gt;&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;bash&quot;&gt;&lt;pre class=&quot;language-bash&quot;&gt;&lt;code class=&quot;language-bash&quot;&gt;net.ipv4.ip_forward&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;1&lt;/span&gt; &lt;span class=&quot;token comment&quot;&gt;# 기존 주석 해제&lt;/span&gt;
net.bridge.bridge-nf-call-arptables&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;1&lt;/span&gt; &lt;span class=&quot;token comment&quot;&gt;# 새로 추가&lt;/span&gt;
net.bridge.bridge-nf-call-iptables&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;1&lt;/span&gt; &lt;span class=&quot;token comment&quot;&gt;# 새로 추가&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;bash&quot;&gt;&lt;pre class=&quot;language-bash&quot;&gt;&lt;code class=&quot;language-bash&quot;&gt;$ &lt;span class=&quot;token function&quot;&gt;sudo&lt;/span&gt; sysctl -p &lt;span class=&quot;token comment&quot;&gt;# 에러 발생함.&lt;/span&gt;

$ &lt;span class=&quot;token function&quot;&gt;sudo&lt;/span&gt; modprobe br_netfilter
$ &lt;span class=&quot;token function&quot;&gt;sudo&lt;/span&gt; lsmod &lt;span class=&quot;token operator&quot;&gt;|&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;grep&lt;/span&gt; br_netfilter

$ &lt;span class=&quot;token function&quot;&gt;sudo&lt;/span&gt; sysctl -p &lt;span class=&quot;token comment&quot;&gt;# 완료&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;h2 id=&quot;결과&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#%EA%B2%B0%EA%B3%BC&quot; aria-label=&quot;결과 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;결과&lt;/h2&gt;
&lt;p&gt;&lt;span
      class=&quot;gatsby-resp-image-wrapper&quot;
      style=&quot;position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 1200px; &quot;
    &gt;
      &lt;span
    class=&quot;gatsby-resp-image-background-image&quot;
    style=&quot;padding-bottom: 38.99999999999999%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAICAYAAAD5nd/tAAAACXBIWXMAABcRAAAXEQHKJvM/AAACXklEQVQozy2SXUhTYRjHn23VRXRTdlMLEkwKNomgSKjrvgiDoKBIiPIiGZmyttky3Nk8Z1/HuXKJ7vPMnY4fc86Z2WbTJms6p84UE7wqCAysq25sffj0nlMv/HjheeD3PH/eF0L5NgjP0cARfO9MgIjw/8h+4jp8xgn4hEn4iCn4huOk7yPwhCJEZownxz4Y6+LLLbXBCdMdzytjDSjhBMjhEFw4fgMqyiuhXKWUpKrTR3a4i7ZKX85e1TVlVnemGXUoR6mXNjVV818a1GfasuB64xJa4iFkXvtwMGPF0FvLJjj4ZqCDOvAkKGi03pZkbFwnbl0dS5tQKJh/xFbZUmLNVuIX20tNQmRLN9CLlj7tNS1H03X+aKmR790Q3ju/vyg6Z8GboRYIc4GsZd2V0J8nUXcRdj4K3L9i4MP4IDLw2zgc2K7notuGKLetG4j80g+GkR1n6u9xHFmABASUFkHcBPBNmzlCMJhri/ZkWk8RmUJs2mOGy0zSj6ZRDh0T3ShGs4x5sUnoQ20/j3Sc0jxP6g86U+zVp2n7xXDBWsPlmbPAZW0QmrYCn2fBO2mWJjFCA/RMPTkaW2HmhleZ+aEVWyGxRheEor3QOuItUKM9y+1Dmmo97+RudY2gJixg/xKL/Lx9A/hZpyIy41T0L3QoInmHTHxe19BDSZzJXgKkxAr+Q1UuRpRiskk3eLMOtzfn+RPId34dnLJuBSapRXiW1oNnshk60wboSGmh4thhSVarrZHJ5LK9xLSfIN5lhH3kN+0GOCcOltOh63v8yZvKrpe1B2hfvfJx992yv99VRQXoBCIJAAAAAElFTkSuQmCC&apos;); background-size: cover; display: block;&quot;
  &gt;&lt;/span&gt;
  &lt;img
        class=&quot;gatsby-resp-image-image&quot;
        alt=&quot;20200717-2.png&quot;
        title=&quot;20200717-2.png&quot;
        src=&quot;/static/3d3ac338174b774a1146bbbdef21ae21/c1b63/20200717-2.png&quot;
        srcset=&quot;/static/3d3ac338174b774a1146bbbdef21ae21/5a46d/20200717-2.png 300w,
/static/3d3ac338174b774a1146bbbdef21ae21/0a47e/20200717-2.png 600w,
/static/3d3ac338174b774a1146bbbdef21ae21/c1b63/20200717-2.png 1200w,
/static/3d3ac338174b774a1146bbbdef21ae21/9040f/20200717-2.png 1613w&quot;
        sizes=&quot;(max-width: 1200px) 100vw, 1200px&quot;
        style=&quot;width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;&quot;
        loading=&quot;lazy&quot;
      /&gt;
    &lt;/span&gt;  &lt;/p&gt;
&lt;h2 id=&quot;references&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#references&quot; aria-label=&quot;references permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;References&lt;/h2&gt;
&lt;p&gt;전체적인 흐름&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href=&quot;https://hook.tistory.com/entry/%EB%8D%B0%EB%B9%84%EC%95%88-%EB%A6%AC%EB%88%85%EC%8A%A4-%EB%A8%B8%EC%8B%A0-%EB%98%90%EB%8A%94-%EB%9D%BC%EC%A6%88%EB%B2%A0%EB%A6%AC%ED%8C%8C%EC%9D%B4%EB%A5%BC-%EC%9C%A0%EC%84%A0%EB%9E%9C-%EB%9D%BC%EC%9A%B0%ED%84%B0-%EB%A7%8C%EB%93%A4%EA%B8%B0&quot;&gt;https://hook.tistory.com/entry/데비안-리눅스-머신-또는-라즈베리파이를-유선랜-라우터-만들기&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;dns&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href=&quot;https://sysops.tistory.com/84&quot;&gt;https://sysops.tistory.com/84&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;dnsmasq&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href=&quot;http://www.thekelleys.org.uk/dnsmasq/docs/dnsmasq-man.html&quot;&gt;http://www.thekelleys.org.uk/dnsmasq/docs/dnsmasq-man.html&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://www.linux.com/topic/networking/dns-and-dhcp-dnsmasq/&quot;&gt;https://www.linux.com/topic/networking/dns-and-dhcp-dnsmasq/&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;bridge&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href=&quot;https://unix.stackexchange.com/questions/319979/why-assign-mac-and-ip-addresses-on-bridge-interface&quot;&gt;https://unix.stackexchange.com/questions/319979/why-assign-mac-and-ip-addresses-on-bridge-interface&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://www.element14.com/community/thread/33724/l/multiple-ethernet-ports-on-the-raspberry-pi?displayFullThread=true&quot;&gt;https://www.element14.com/community/thread/33724/l/multiple-ethernet-ports-on-the-raspberry-pi?displayFullThread=true&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://raspberrypi.stackexchange.com/questions/34968/bridge-eth0-and-eth1-and-run-dnsmasq&quot;&gt;https://raspberrypi.stackexchange.com/questions/34968/bridge-eth0-and-eth1-and-run-dnsmasq&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;iptables bridge forward 설정&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href=&quot;https://ablog.jc-lab.net/14&quot;&gt;https://ablog.jc-lab.net/14&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://m.blog.naver.com/woomun/220743262815&quot;&gt;https://m.blog.naver.com/woomun/220743262815&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;</content:encoded></item><item><title><![CDATA[goquery를 이용해서 html 파싱하기]]></title><description><![CDATA[Tiobe 랭킹에 따르면 GoLang은 2020년 3월 기준으로 10위에 랭크되어있다. 많은 사용자가 있고 GoLang…]]></description><link>https://blog.frec.kr/golang/goquery/</link><guid isPermaLink="false">https://blog.frec.kr/golang/goquery/</guid><pubDate>Fri, 20 Mar 2020 23:02:00 GMT</pubDate><content:encoded>&lt;p&gt;&lt;a href=&quot;https://www.tiobe.com/tiobe-index/&quot;&gt;Tiobe 랭킹&lt;/a&gt;에 따르면 GoLang은 2020년 3월 기준으로 10위에 랭크되어있다.&lt;/p&gt;
&lt;p&gt;많은 사용자가 있고 GoLang으로 작성된 프로젝트도 상당히 많아진만큼 괜찮은 언어임에는 이견이 없지만.. 사용에 있어서 언어 자체가 괜찮은 것과는 달리 큰 문제점이 있다.&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;바로 레퍼런스의 부족&lt;/strong&gt;이다.&lt;/p&gt;
&lt;p&gt;한글 문서의 부족은 말할 것도 없고, 심지어 영어 문서도 부족한 경우가 많다.&lt;/p&gt;
&lt;p&gt;다만 GoLang이 중국에서는 꽤나 큰 인기를 얻는지 중문으로 된 글은 많지만 중국어와는 거리가 멀어 전혀 도움이 되지 않았다.&lt;/p&gt;
&lt;p&gt;(비교적 신생 언어라 이해는 하지만 ㅠㅠ)&lt;/p&gt;
&lt;p&gt;개인적으로 제일 많이 사용하는 언어라, 조금이나마 도움이 되고자 GoLang에 관련된 글을 많이 작성하려고 한다.&lt;/p&gt;
&lt;h2 id=&quot;puerkitobiogoquery&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#puerkitobiogoquery&quot; aria-label=&quot;puerkitobiogoquery permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;PuerkitoBio/goquery&lt;/h2&gt;
&lt;p&gt;파이썬을 유저들 대부분은 &lt;a href=&quot;https://www.crummy.com/software/BeautifulSoup/&quot;&gt;BeautifulSoup&lt;/a&gt;을 이용해 웹 스크래핑, 크롤링 등을 진행해본 경험이 있을 것이다.&lt;/p&gt;
&lt;p&gt;간단히 기능에 대해 요약하자면, BeautifulSoup은 HTML이나 XML 소스를 파싱해 트리 형태로 만들어 순회하면서 데이터를 추출하는 용도의 라이브러리이다.&lt;/p&gt;
&lt;p&gt;파이썬의 BeautifulSoup만큼 압도적인 위상을 지니고 있는지는 모르겠지만 GoLang에도 HTML 파싱을 위한 &lt;a href=&quot;https://github.com/PuerkitoBio/goquery&quot;&gt;goquery(링크)&lt;/a&gt;라는 라이브러리가 있다.&lt;/p&gt;
&lt;p&gt;&lt;code class=&quot;language-text&quot;&gt;goquery&lt;/code&gt;는 &lt;code class=&quot;language-text&quot;&gt;net/http&lt;/code&gt; 기본 라이브러리와 CSS Selector 라이브러리인 &lt;a href=&quot;https://github.com/andybalholm/cascadia&quot;&gt;Cascadia&lt;/a&gt; 를 기반으로 개발되었으며 jQuery와 문법 및 기능이 유사하게 개발되었다고 한다.&lt;/p&gt;
&lt;p&gt;다음 명령으로 설치하자.&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;bash&quot;&gt;&lt;pre class=&quot;language-bash&quot;&gt;&lt;code class=&quot;language-bash&quot;&gt;$ go get github.com/PuerkitoBio/goquery&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;(본 포스팅에서는 Go 1.13 버전과 goquery 1.5 버전(2018.11)을 기준으로 작성되었습니다.)&lt;/p&gt;
&lt;h2 id=&quot;간단한-예제&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#%EA%B0%84%EB%8B%A8%ED%95%9C-%EC%98%88%EC%A0%9C&quot; aria-label=&quot;간단한 예제 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;간단한 예제&lt;/h2&gt;
&lt;p&gt;우선, 간단한 예제로 COVID-19 현황을 제공하는 정부 사이트의 현황판을 파싱해보았다.  &lt;/p&gt;
&lt;p&gt;&lt;span
      class=&quot;gatsby-resp-image-wrapper&quot;
      style=&quot;position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 489px; &quot;
    &gt;
      &lt;span
    class=&quot;gatsby-resp-image-background-image&quot;
    style=&quot;padding-bottom: 35%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAHCAIAAACHqfpvAAAACXBIWXMAAAsTAAALEwEAmpwYAAABtklEQVQY0wGrAVT+AL26vL67vb26u+Lf4t7b3uLg4uDh5OTk6OLf5OTk6O7r8vbt9vXs9fbs9fXs9fHt9+zv+e3v+u3v+ers9gCYtuWUtOWTs+SVtOaVteaXtOKOoMiKnMaImsWMm8aQtNON1eOIz+CI0N+K0uOmytXCv8W+wMa8vsPO0NcAJHLhK3fiYJrrVZHnKHXkEl/SACqKI0maR2iqBSiHAVieALHHM77SOb/TDLfQLpOghnp4m5ydfn58pKWpADJ64TB54UGE4z+D4jJ741iP3zhZojxepVp3tDdTn0mKuR6+0Dq/00nE1hu50XCzvZOKiZKUlYKCgaqrrwA5f+FMjOVqnulgl+dcluiBqeRVca1CYqhNbK1PaKtunsNAyNg8v9NKxNcwv9SOwMiZkZCkp6iLioipqq4AKnXgO4HjQ4bkOn7iOoHlF2LSBTCNHUOVLFGfEjKNAFufALPJE7PLHrfNAK/LNJSiiX17i46OfXx7p6erAGKX5V6V5V+V5V+V5F+W51yP3UxrrUxprE9trU1lqUqLu0LE1UO+00a/0z7B1nCxvaeeoKGjppubnbu8wozOAEf+6EClAAAAAElFTkSuQmCC&apos;); background-size: cover; display: block;&quot;
  &gt;&lt;/span&gt;
  &lt;img
        class=&quot;gatsby-resp-image-image&quot;
        alt=&quot;20200320-1.png&quot;
        title=&quot;20200320-1.png&quot;
        src=&quot;/static/b6521ca52eeb2ff616465855ebfb93a6/03e1f/20200320-1.png&quot;
        srcset=&quot;/static/b6521ca52eeb2ff616465855ebfb93a6/5a46d/20200320-1.png 300w,
/static/b6521ca52eeb2ff616465855ebfb93a6/03e1f/20200320-1.png 489w&quot;
        sizes=&quot;(max-width: 489px) 100vw, 489px&quot;
        style=&quot;width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;&quot;
        loading=&quot;lazy&quot;
      /&gt;
    &lt;/span&gt;  &lt;/p&gt;
&lt;p&gt;(타겟 사이트 : &lt;a href=&quot;http://ncov.mohw.go.kr/&quot;&gt;http://ncov.mohw.go.kr/&lt;/a&gt;)&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;go&quot;&gt;&lt;pre class=&quot;language-go&quot;&gt;&lt;code class=&quot;language-go&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;package&lt;/span&gt; main

&lt;span class=&quot;token keyword&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;
 &lt;span class=&quot;token string&quot;&gt;&quot;fmt&quot;&lt;/span&gt;
 &lt;span class=&quot;token string&quot;&gt;&quot;log&quot;&lt;/span&gt;
 &lt;span class=&quot;token string&quot;&gt;&quot;net/http&quot;&lt;/span&gt;

 &lt;span class=&quot;token string&quot;&gt;&quot;github.com/PuerkitoBio/goquery&quot;&lt;/span&gt;
&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;token keyword&quot;&gt;func&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;main&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
 &lt;span class=&quot;token comment&quot;&gt;// Request&lt;/span&gt;
 url &lt;span class=&quot;token operator&quot;&gt;:=&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;http://ncov.mohw.go.kr/&quot;&lt;/span&gt;
 resp&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; err &lt;span class=&quot;token operator&quot;&gt;:=&lt;/span&gt; http&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;Get&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;url&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
 &lt;span class=&quot;token keyword&quot;&gt;if&lt;/span&gt; err &lt;span class=&quot;token operator&quot;&gt;!=&lt;/span&gt; &lt;span class=&quot;token boolean&quot;&gt;nil&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
  log&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;Fatal&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;err&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
 &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;
 &lt;span class=&quot;token keyword&quot;&gt;defer&lt;/span&gt; resp&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;Body&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;Close&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;

 &lt;span class=&quot;token comment&quot;&gt;// HTML 읽기&lt;/span&gt;
 html&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; err &lt;span class=&quot;token operator&quot;&gt;:=&lt;/span&gt; goquery&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;NewDocumentFromReader&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;resp&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;Body&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
 &lt;span class=&quot;token keyword&quot;&gt;if&lt;/span&gt; err &lt;span class=&quot;token operator&quot;&gt;!=&lt;/span&gt; &lt;span class=&quot;token boolean&quot;&gt;nil&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
  log&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;Fatal&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;err&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
 &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;

 &lt;span class=&quot;token comment&quot;&gt;// 현황판 파싱&lt;/span&gt;
 wrapper &lt;span class=&quot;token operator&quot;&gt;:=&lt;/span&gt; html&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;Find&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&quot;ul.liveNum&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
 items &lt;span class=&quot;token operator&quot;&gt;:=&lt;/span&gt; wrapper&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;Find&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&quot;li&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;

 &lt;span class=&quot;token comment&quot;&gt;// items 순회하면서 출력&lt;/span&gt;
 items&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;Each&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token keyword&quot;&gt;func&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;idx &lt;span class=&quot;token builtin&quot;&gt;int&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; sel &lt;span class=&quot;token operator&quot;&gt;*&lt;/span&gt;goquery&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;Selection&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
  title &lt;span class=&quot;token operator&quot;&gt;:=&lt;/span&gt; sel&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;Find&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&quot;strong.tit&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;Text&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
  value &lt;span class=&quot;token operator&quot;&gt;:=&lt;/span&gt; sel&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;Find&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&quot;span.num&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;Text&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
  before &lt;span class=&quot;token operator&quot;&gt;:=&lt;/span&gt; sel&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;Find&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&quot;span.before&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;Text&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;

  fmt&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;Println&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;title&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; value&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; before&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
 &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;아웃풋은 다음과 같다.&lt;/p&gt;
&lt;p&gt;&lt;span
      class=&quot;gatsby-resp-image-wrapper&quot;
      style=&quot;position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 284px; &quot;
    &gt;
      &lt;span
    class=&quot;gatsby-resp-image-background-image&quot;
    style=&quot;padding-bottom: 37.67605633802817%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAICAIAAAB2/0i6AAAACXBIWXMAAAsTAAALEwEAmpwYAAABXUlEQVQY0z1Px27jMBTUZ2woqlKiWC0WNVJWsbOG4cue9v+/Jc8BEh4GMySmMDnP03t/HMcwDKRpetODjHG1zvphHEfvvNu2bZ6nfd+lUowxqeSyLJx1Cdjmeb7d7oBaX/Z9c85P0xRiCDF654TgQEII6xqFEAoClLTWvc2Q5/0Q1/g2hPB8Prf94IxeegNbYIjWWggZ1/X2+bcuC4QQxhgwy7Lker3CTmPMfhzTNIJknD8eD8h2zo7TssyzUrohZAnhfj+hHOOsKIo8zxN4izH2fQ+zpRDWWK0U1HWUSingHmZ3XVeVJUTALyil0Jl/n2ScZg/z3OBHZ60lbQcpOM//IPSRph8IpSlGOEU4Q98S/zjf5peRN81PzRfWuq59GQH8n9OnYncgw8XS5tD8/9gb2lwV6+rq15+A4KQWDQGkdSWbN15a0reE1xWrK1IWnFS6JaQqm7Isi9/i/AuRjVSDaInYNgAAAABJRU5ErkJggg==&apos;); background-size: cover; display: block;&quot;
  &gt;&lt;/span&gt;
  &lt;img
        class=&quot;gatsby-resp-image-image&quot;
        alt=&quot;20200320-2.png&quot;
        title=&quot;20200320-2.png&quot;
        src=&quot;/static/6c3a464d2112b1613bb555b8aa9ce4cb/62f93/20200320-2.png&quot;
        srcset=&quot;/static/6c3a464d2112b1613bb555b8aa9ce4cb/62f93/20200320-2.png 284w&quot;
        sizes=&quot;(max-width: 284px) 100vw, 284px&quot;
        style=&quot;width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;&quot;
        loading=&quot;lazy&quot;
      /&gt;
    &lt;/span&gt;  &lt;/p&gt;
&lt;h2 id=&quot;request&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#request&quot; aria-label=&quot;request permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;request&lt;/h2&gt;
&lt;p&gt;&lt;code class=&quot;language-text&quot;&gt;net/http&lt;/code&gt; 기본 패키지를 이용해서 request를 보냈다.&lt;/p&gt;
&lt;p&gt;만약 User-Agent 등의 헤더를 추가해 보내고 싶다면, 다음 방법을 이용하자.&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;go&quot;&gt;&lt;pre class=&quot;language-go&quot;&gt;&lt;code class=&quot;language-go&quot;&gt;&lt;span class=&quot;token comment&quot;&gt;// Request&lt;/span&gt;
req&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; err &lt;span class=&quot;token operator&quot;&gt;:=&lt;/span&gt; http&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;NewRequest&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&quot;GET&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; url&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token boolean&quot;&gt;nil&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;if&lt;/span&gt; err &lt;span class=&quot;token operator&quot;&gt;!=&lt;/span&gt; &lt;span class=&quot;token boolean&quot;&gt;nil&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
 log&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;Fatal&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;err&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;
req&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;Header&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;Add&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&quot;User-Agent&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;Crawler&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;

client &lt;span class=&quot;token operator&quot;&gt;:=&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;&amp;amp;&lt;/span&gt;http&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;Client&lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;
resp&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; err &lt;span class=&quot;token operator&quot;&gt;:=&lt;/span&gt; client&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;Do&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;req&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;if&lt;/span&gt; err &lt;span class=&quot;token operator&quot;&gt;!=&lt;/span&gt; &lt;span class=&quot;token boolean&quot;&gt;nil&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
 log&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;Fatal&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;err&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;defer&lt;/span&gt; resp&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;Body&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;Close&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;h2 id=&quot;css-selector&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#css-selector&quot; aria-label=&quot;css selector permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;CSS Selector&lt;/h2&gt;
&lt;p&gt;&lt;code class=&quot;language-text&quot;&gt;Find()&lt;/code&gt; 함수에는 string으로 CSS Selector를 전달한다.&lt;/p&gt;
&lt;p&gt;다음은 CSS Selector의 몇가지 예시다.&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;&lt;code class=&quot;language-text&quot;&gt;ul&lt;/code&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;code class=&quot;language-text&quot;&gt;&amp;lt;ul&amp;gt; ... &amp;lt;/ul&amp;gt;&lt;/code&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;code class=&quot;language-text&quot;&gt;ul.liveNum&lt;/code&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;code class=&quot;language-text&quot;&gt;&amp;lt;ul class=&amp;quot;liveNum&amp;quot;&amp;gt; ... &amp;lt;/ul&amp;gt;&lt;/code&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;code class=&quot;language-text&quot;&gt;ul#id&lt;/code&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;code class=&quot;language-text&quot;&gt;&amp;lt;ul id=&amp;quot;id&amp;quot;&amp;gt; ... &amp;lt;/ul&amp;gt;&lt;/code&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;code class=&quot;language-text&quot;&gt;li &amp;gt; strong.tit&lt;/code&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;code class=&quot;language-text&quot;&gt;&amp;lt;li&amp;gt; &amp;lt;strong class=&amp;quot;tit&amp;quot;&amp;gt; ... &amp;lt;/strong&amp;gt; &amp;lt;/li&amp;gt;&lt;/code&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id=&quot;검색--find&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#%EA%B2%80%EC%83%89--find&quot; aria-label=&quot;검색  find permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;검색 : Find()&lt;/h2&gt;
&lt;p&gt;파이썬의 BeautifulSoup에서는 find()와 find_all() 함수가 있었는데, 전자는 처음으로 발견된 검색 결과를 리턴하고 후자는 검색 결과를 리스트로 리턴했다.&lt;/p&gt;
&lt;p&gt;goquery에서 &lt;code class=&quot;language-text&quot;&gt;Find()&lt;/code&gt; 함수는 해당되는 노드를 전부 탐색하며, &lt;code class=&quot;language-text&quot;&gt;*goquery.Selection&lt;/code&gt; 구조체를 리턴한다.&lt;/p&gt;
&lt;p&gt;(자세한 정보는 &lt;a href=&quot;https://godoc.org/github.com/PuerkitoBio/goquery#Selection&quot;&gt;godoc 문서&lt;/a&gt;를 참조)&lt;/p&gt;
&lt;p&gt;이를 순회하기 위해서 &lt;code class=&quot;language-text&quot;&gt;.Each()&lt;/code&gt;를 사용한다.&lt;/p&gt;
&lt;h2 id=&quot;노드-순회--each&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#%EB%85%B8%EB%93%9C-%EC%88%9C%ED%9A%8C--each&quot; aria-label=&quot;노드 순회  each permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;노드 순회 : Each()&lt;/h2&gt;
&lt;p&gt;&lt;code class=&quot;language-text&quot;&gt;Each()&lt;/code&gt;에는 파라미터로 &lt;code class=&quot;language-text&quot;&gt;func(int, *goquery.Selection)&lt;/code&gt;이 요구된다.&lt;/p&gt;
&lt;p&gt;노드를 순회하면서 파라미터로 들어온 함수를 실행하게 된다.&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;go&quot;&gt;&lt;pre class=&quot;language-go&quot;&gt;&lt;code class=&quot;language-go&quot;&gt;fmt&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;Printf&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&quot;검색된 결과 : %d개\n&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; items&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;Length&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;

items&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;Each&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token keyword&quot;&gt;func&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;idx &lt;span class=&quot;token builtin&quot;&gt;int&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; sel &lt;span class=&quot;token operator&quot;&gt;*&lt;/span&gt;goquery&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;Selection&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
 fmt&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;Println&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&quot;현재 위치 :&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; idx&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
 fmt&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;Println&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&quot;현재 태그 :&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; goquery&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;NodeName&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;sel&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;(&lt;code class=&quot;language-text&quot;&gt;goquery.NodeName()&lt;/code&gt; 함수는 해당 노드의 태그 이름을 리턴한다)&lt;/p&gt;
&lt;h2 id=&quot;노드-순회--eachwithbreak&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#%EB%85%B8%EB%93%9C-%EC%88%9C%ED%9A%8C--eachwithbreak&quot; aria-label=&quot;노드 순회  eachwithbreak permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;노드 순회 : EachWithBreak()&lt;/h2&gt;
&lt;p&gt;순회 방법에는 &lt;code class=&quot;language-text&quot;&gt;Each()&lt;/code&gt; 외에도 &lt;code class=&quot;language-text&quot;&gt;EachWithBreak()&lt;/code&gt;가 존재한다.&lt;/p&gt;
&lt;p&gt;특정 조건에서 순회를 멈추고 그 Selection을 전달받고 싶을 때 사용한다.&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;go&quot;&gt;&lt;pre class=&quot;language-go&quot;&gt;&lt;code class=&quot;language-go&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;var&lt;/span&gt; title &lt;span class=&quot;token builtin&quot;&gt;string&lt;/span&gt;
items&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;Each&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token keyword&quot;&gt;func&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;idx &lt;span class=&quot;token builtin&quot;&gt;int&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; sel &lt;span class=&quot;token operator&quot;&gt;*&lt;/span&gt;goquery&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;Selection&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token builtin&quot;&gt;bool&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
 title &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; sel&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;Find&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&quot;strong.tit&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;Text&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
 &lt;span class=&quot;token keyword&quot;&gt;if&lt;/span&gt; title &lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;치료 중(격리 중)&quot;&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
  &lt;span class=&quot;token keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;token boolean&quot;&gt;false&lt;/span&gt;
 &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;
 &lt;span class=&quot;token keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;token boolean&quot;&gt;true&lt;/span&gt;
&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;h2 id=&quot;텍스트-추출&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#%ED%85%8D%EC%8A%A4%ED%8A%B8-%EC%B6%94%EC%B6%9C&quot; aria-label=&quot;텍스트 추출 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;텍스트 추출&lt;/h2&gt;
&lt;p&gt;해당 태그 내의 모든 텍스트를 추출하려면 지금까지 자연스럽게 사용한 &lt;code class=&quot;language-text&quot;&gt;.Text()&lt;/code&gt; 함수를 호출하면 된다.&lt;/p&gt;
&lt;p&gt;만약, 해당 태그 내에서 바로 밑의 자손 텍스트만 출력하기 위해서는 다음과 같이 사용한다.&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;go&quot;&gt;&lt;pre class=&quot;language-go&quot;&gt;&lt;code class=&quot;language-go&quot;&gt;wrapper&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;Contents&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;Each&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token keyword&quot;&gt;func&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;idx &lt;span class=&quot;token builtin&quot;&gt;int&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; sel &lt;span class=&quot;token operator&quot;&gt;*&lt;/span&gt;goquery&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;Selection&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt; &lt;span class=&quot;token comment&quot;&gt;// Contents()는 바로 밑의 자손들&lt;/span&gt;
 &lt;span class=&quot;token keyword&quot;&gt;if&lt;/span&gt; goquery&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;NodeName&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;sel&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;#text&quot;&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt; &lt;span class=&quot;token comment&quot;&gt;// 태그가 없는 단순 텍스트&lt;/span&gt;
  fmt&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;Println&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;sel&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;Text&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
 &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;
&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;h2 id=&quot;속성-추출&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#%EC%86%8D%EC%84%B1-%EC%B6%94%EC%B6%9C&quot; aria-label=&quot;속성 추출 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;속성 추출&lt;/h2&gt;
&lt;p&gt;태그의 속성을 추출할 때, 다음과 같이 사용한다.&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;go&quot;&gt;&lt;pre class=&quot;language-go&quot;&gt;&lt;code class=&quot;language-go&quot;&gt;aTag &lt;span class=&quot;token operator&quot;&gt;:=&lt;/span&gt; item&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;Find&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&quot;a&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
href&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; ok &lt;span class=&quot;token operator&quot;&gt;:=&lt;/span&gt; aTag&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;Attr&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&quot;href&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token comment&quot;&gt;// 속성값 추출&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;!&lt;/span&gt;ok &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
 fmt&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;Println&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&quot;href 없음.&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;h2 id=&quot;마무리&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#%EB%A7%88%EB%AC%B4%EB%A6%AC&quot; aria-label=&quot;마무리 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;마무리&lt;/h2&gt;
&lt;p&gt;GoLang의 HTML 파싱 라이브러리인 &lt;code class=&quot;language-text&quot;&gt;PuerkitoBio/goquery&lt;/code&gt;에 대해 살펴보았다.&lt;/p&gt;
&lt;p&gt;경험상, 본 포스팅에 소개된 함수들만 이용해도 원하는 데이터를 추출하는데 큰 지장은 없던 것 같다.&lt;/p&gt;</content:encoded></item><item><title><![CDATA[missing Location in call to Time.In 에러]]></title><description><![CDATA[Golang missing Location in call to Time.In 에러 (go 1.12.1 버전 기준) GoLang으로 HTTP API를 개발 중이었다. API를 정적 바이너리로 빌드해서, scratch 이미지를 기반으로 Docker…]]></description><link>https://blog.frec.kr/golang/troubleshooting-0/</link><guid isPermaLink="false">https://blog.frec.kr/golang/troubleshooting-0/</guid><pubDate>Thu, 19 Mar 2020 23:02:00 GMT</pubDate><content:encoded>&lt;h1 id=&quot;golang-missing-location-in-call-to-timein-에러&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#golang-missing-location-in-call-to-timein-%EC%97%90%EB%9F%AC&quot; aria-label=&quot;golang missing location in call to timein 에러 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;[Golang] missing Location in call to Time.In 에러&lt;/h1&gt;
&lt;p&gt;(go 1.12.1 버전 기준)&lt;/p&gt;
&lt;p&gt;GoLang으로 HTTP API를 개발 중이었다.&lt;/p&gt;
&lt;p&gt;API를 정적 바이너리로 빌드해서, scratch 이미지를 기반으로 Docker 이미지를 빌드해 사용 중이었는데,&lt;/p&gt;
&lt;p&gt;다음과 같은 에러가 발생하면서 프로그램이 계속 죽었다.&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;go&quot;&gt;&lt;pre class=&quot;language-go&quot;&gt;&lt;code class=&quot;language-go&quot;&gt;loc&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token boolean&quot;&gt;_&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;:=&lt;/span&gt; time&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;LoadLocation&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&quot;Asia/Seoul&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token comment&quot;&gt;// 에러 발생&lt;/span&gt;
timestamp &lt;span class=&quot;token operator&quot;&gt;:=&lt;/span&gt; time&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;Now&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;In&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;loc&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;Unix&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;&lt;code class=&quot;language-text&quot;&gt;time.LoadLocation&lt;/code&gt; 함수는 timezone 데이터(&lt;em&gt;IANA Timezone Database&lt;/em&gt;)를 다른 위치에서 가져오는데, scratch 이미지는 라이브러리가 포함되어 있지 않아 timezone 데이터를 가져올 수 없어 발생하는 에러였다.&lt;/p&gt;
&lt;p&gt;원래는 다음 위치 중 하나에서 timezone 데이터를 가져온다.&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;code class=&quot;language-text&quot;&gt;ZONEINFO&lt;/code&gt; 환경변수&lt;/li&gt;
&lt;li&gt;&lt;code class=&quot;language-text&quot;&gt;$GOROOT/lib/time/zoneinfo.zip&lt;/code&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;$GOROOT/lib/time 경로에 들어가서 &lt;a href=&quot;http://zoneinfo.zip&quot;&gt;zoneinfo.zip&lt;/a&gt; 파일을 가져온 후,&lt;/p&gt;
&lt;p&gt;다음 방법으로 이미지에 timezone 데이터를 추가해 에러를 해결했다.&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;docker&quot;&gt;&lt;pre class=&quot;language-docker&quot;&gt;&lt;code class=&quot;language-docker&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;ADD&lt;/span&gt; zoneinfo.zip
&lt;span class=&quot;token keyword&quot;&gt;ENV&lt;/span&gt; ZONEINFO /zoneinfo.zip&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;</content:encoded></item><item><title><![CDATA[Docker 간단 정리]]></title><description><![CDATA[1. 도커(Docker)란? 컨테이너 기반의 가상화 플랫폼이다. 2. 가상화(Virtualization) 물리 리소스를 추상화하여 사용자에게서 감추며, 여러 개의 논리 리소스인 것처럼 보이게 하는 기술이다.
가상화 기술로는 VM과 Container…]]></description><link>https://blog.frec.kr/docker/docker/</link><guid isPermaLink="false">https://blog.frec.kr/docker/docker/</guid><pubDate>Fri, 13 Mar 2020 10:54:00 GMT</pubDate><content:encoded>&lt;h2 id=&quot;1-도커docker란&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#1-%EB%8F%84%EC%BB%A4docker%EB%9E%80&quot; aria-label=&quot;1 도커docker란 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;1. 도커(&lt;em&gt;Docker&lt;/em&gt;)란?&lt;/h2&gt;
&lt;p&gt;컨테이너 기반의 가상화 플랫폼이다.&lt;/p&gt;
&lt;h2 id=&quot;2-가상화virtualization&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#2-%EA%B0%80%EC%83%81%ED%99%94virtualization&quot; aria-label=&quot;2 가상화virtualization permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;2. 가상화(&lt;em&gt;Virtualization&lt;/em&gt;)&lt;/h2&gt;
&lt;p&gt;&lt;strong&gt;물리 리소스를 추상화&lt;/strong&gt;하여 사용자에게서 감추며, &lt;strong&gt;여러 개의 논리 리소스&lt;/strong&gt;인 것처럼 보이게 하는 기술이다.
가상화 기술로는 VM과 Container 기술이 있다.&lt;/p&gt;
&lt;h3 id=&quot;21-vmvirtual-machine&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#21-vmvirtual-machine&quot; aria-label=&quot;21 vmvirtual machine permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;2.1. VM(&lt;em&gt;Virtual Machine&lt;/em&gt;)&lt;/h3&gt;
&lt;p&gt;물리적 HW 리소스를 Hypervisor를 통해 가상화하는 &lt;strong&gt;HW 레벨의 가상화 기술&lt;/strong&gt;이다.&lt;/p&gt;
&lt;h3 id=&quot;211-bare-metal-native-hypervisor&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#211-bare-metal-native-hypervisor&quot; aria-label=&quot;211 bare metal native hypervisor permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;2.1.1. Bare-Metal (Native) Hypervisor&lt;/h3&gt;
&lt;p&gt;&lt;span
      class=&quot;gatsby-resp-image-wrapper&quot;
      style=&quot;position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 207px; &quot;
    &gt;
      &lt;span
    class=&quot;gatsby-resp-image-background-image&quot;
    style=&quot;padding-bottom: 92.27053140096618%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAASCAYAAABb0P4QAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAD+UlEQVQ4y21Ta0xbZRjuX3/4xx9q5g+HAxejyXTq5sBF2LhsZm5jThOTJYvDbBl0U9oObKEXQCbBC84VeoEak+kP+TEGomxQoOPWUm4TTlthnJ7T0xs4CruwMPeDx+/7TmnQeJIn7/O97/M+5/3OyasIxRKYCogQwguYD8UY+GTc4AE+ijkhmsrz/9EEpTi4OQkBIQ5FfHEJrf1+nLd6UO7wQmX3oJRA0zyKMnJWNo3AzYXR/LuP8TLHKNNQqJvlnnMWN1pds5gTY1Aklldg6ZhG5oXryNf34EhNP45/6cK7xl4U6J14S92FG+MiKn4cxx5NF9MU1vbjWK0Lh0yyJlNzHd9fm0YougjFUmIFLb/NEKETR2v6cPryCDSOMZz8dhCFX/Qht6IbzgkRVT9PIo9wqlFaPPjM7kVRwxA751f2wNLJQYwkDe2dM8jRydMdpJMZnGzCw9X9eOfzbvROSTD9NIlsbTfLHTD0EjiZlp6ztT1o7EgahmNLmJ6VMMqF4PVtAifDPS2CJx995nYE7hlRzic1Yz6JRZoPBGP4UyDfcOXeQ3zVfBVbsk5he0EJ0nPPIiOvGBnJuD2/BFtzzjBszlOk7TuDF/OL8Wzmx6hp/AVSfBmK+6tr0H59BU++egI7DqmJUIlt+4uRnlfC4nN7T+Olg5/ijUINO2fkljCk7y/B7vfLsbPwAp7adRKqiz8gsrgiG+q+uYInXvkIez+sQPaJSrx84DxeP6rGjvdKmeHOI2rsOqYhBmV4kxi8driUTK5E1gda7D5eji1vFxFDh2xIr1zf3IZnsj5BRsE5pJEpXiAT0JhGpkgnjZRv3UfAcnJ9G7nJ8zlnyU2UeHpPEarNrfKVJbIpgTkePp+fIACfP5Dkfpn/DzhS4zbVZzgfeEGUN2Uh8QAdnV2o0GlRU12NqipTCkajAXq9HkaDAQaDnoHyzRrao9Nq0dHxK+YjS7JhOzHUEcNqUjSZqLAKBqMRDQ0NsFltMJsb0dRkwWWzGZcufUeMjUxDtbRHSwzbiSFPDReXV9HW3gm1WoXKykpirGOgIpPRhPr6etTWXmSxrq6O8FpW29DRHpVKhatt18BHE1BEFu+izzUIm80Kh8OBlpaWFOx2O8nbUpFxm/1fGtpjtVrgujmAWZFsihC9g3GfAD58B0JsOYUgeVto4W6KU1AuxldSGj6Zuy39hT/Itvl4silIPg8f3Cd/zI9wOAIhSF4wz4PjOEiSBCkUQjgShSAE4Sd/NyiECBcQj0YJF/H348cbNlCsr68zsrZ6D86+XgwPDWN8bBxjXi+6b3RhaGgIt25NYWJyAp5RD266BjBANIMDgxjzjGBw2I21R4+YB/X6BwhFF4WIZ5b9AAAAAElFTkSuQmCC&apos;); background-size: cover; display: block;&quot;
  &gt;&lt;/span&gt;
  &lt;img
        class=&quot;gatsby-resp-image-image&quot;
        alt=&quot;20200313 1&quot;
        title=&quot;20200313 1&quot;
        src=&quot;/static/bb084fdcb3b79f3aff30bb0dce8a36f9/661c4/20200313-1.png&quot;
        srcset=&quot;/static/bb084fdcb3b79f3aff30bb0dce8a36f9/661c4/20200313-1.png 207w&quot;
        sizes=&quot;(max-width: 207px) 100vw, 207px&quot;
        style=&quot;width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;&quot;
        loading=&quot;lazy&quot;
      /&gt;
    &lt;/span&gt;  &lt;/p&gt;
&lt;p&gt;Hypervisor가 호스트 OS를 통하지 않고 HW를 직접 제어한다.&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;ex) Xen, Hyper-V, KVM, etc.&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h3 id=&quot;212-hosted-hypervisor&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#212-hosted-hypervisor&quot; aria-label=&quot;212 hosted hypervisor permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;2.1.2. Hosted Hypervisor&lt;/h3&gt;
&lt;p&gt;&lt;span
      class=&quot;gatsby-resp-image-wrapper&quot;
      style=&quot;position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 207px; &quot;
    &gt;
      &lt;span
    class=&quot;gatsby-resp-image-background-image&quot;
    style=&quot;padding-bottom: 115.94202898550725%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAXCAYAAAALHW+jAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAE2ElEQVQ4y21VaVBTVxjNTLcZq06Z9nf/dPpD27G1i3Vap+1MUbEyWFRcwVHUgmMXhbIISQhJ2MIihB2ty3SKC3spW1gCZEEEwSUJIRskISEEgwvWLtg5vfc+CJTxzZw533Lu976597vv8exuH3RmJ9yeaTjdU5hwe/1g/qQXNocH4xMeZj9XQ9jumsJtowM856QPgyNOVKmsqFFbUa1aRC3xr3SbYXJMo9/gxlVi1z5HU6k0447Vi3ujdvCmfQ9wsVWHTfFt2MJvZwgSdGDzvL0xphk1vWakXRnGxtgWLi4gGmGHX/8J0RTU62C0OsHz3n+AXzsM2C7qxDeSLkQV9SHuwiAi89UIS+9mBRq1VuTV3GWFdkqV+L6sH6cqbuJ4gYb5tGh58wiMFudih5/FtSIwSYGtZNHXKR2MNycrsOF0E6p7TJBWDrFOAkksSNiObUQTtESTX3+P69Dp8aFfT/dwjOzhGKp6bbhOUKWyMb9SaYXVNYObxilm09h1v2bMrxkyT3F76PE9Rp1Ci6OJ+TghLOYgKEa0oIiAsyMT5Th6Rj4f5xDFL8K3yYXMjojNxdXfumCwuMB7OPsnpKXV4L0VipXvH8QLa8Lw0tq9eOXdfXhxzR68/M4+rHzvAAI+jGBxChp7jfivbziCNzYcZmu/E5XDYveA9+DxU2RW1OLNz6MQdiILodGZCAwXYOsRMUKOibE26Ad8FSHE7pMZCD4mwfZICbYcFmHTnkTsJPodx6VYF/wjErIuwjQ+X1B2rg68t0MR8PEhBHx0CK+SjlatD8fqD8Kxcv1BxitIjPIq4tMc7XrFuv1YTWzaYYz0PMy0oNNDNvz2KGpbNKhr1RBWM2b2PFPUt2qfH2/T4lpjL27rTORQyClPemfInFlw6vwtxF8aQtzFRfx0YQgxP9/y4zTR0NhSTcKlYZwsG0CtZgwGs4Obw8ttOnyR0MbmagtfwUDnaxuZt7B0JXaIu7BL2oXwnF5sJ/NHcws6qvk0thmFDTpusOlN+UWhJwPbjpDUTgSLOhjoQnpzoou07GZEyTU4WXIDu9KUbPAXdCHiTnyZ2IqSRj1XcIoUvKY0YneGinSgxoHsRezPVmFvFkUv9sk4e2meIjxXjR2SblxQjGKEFqSfL4PFgWE9mXa9ZRmsGDYswzId9W/eNcHh8uCOkdwU9/1ZtHcqkSYWISszHZkZaX6kp0kglaQiTSrmWCJm9lKNLDMDohQB2lqaoLe4SUHfLFoUnUhOSoJIlIqUlBQCEQRCIbJl2ZDLC3H2bD7khZTPIicnF0KSoxqqFaWmIj4hAb83NnAFJ31P0NTajvj4OPD5fCQlJyOZ4Ax5gUQsQV5ePmQyGeE85ObmMjuJ5KiGavl8AWJiYtFQXwuDlRSc8D6CStOH0uIiVJSXobysFGWlJYxLS4pRXFSIEpKjvGCXkVz5PM5VlENeUACtqof8SlzcodDNtNjdMI25YKX/D5cXYxMcxl3TfqbahbjNOcVgHndh1EbW2ScxPEIO5dmzf0HvM8XD2acYd05Cb7RgxGSF2eaAftTCsZGc8B0dsw0mG2E7TFY7fA+fgH6xZh79gb/+ngMPyx7TqBEdCgVuaFXQalToH+jHYJ8Wg4ND6GpvgVrdg4GBW9CoutFH4v/Mzf1v/X/cXkSfn1av+QAAAABJRU5ErkJggg==&apos;); background-size: cover; display: block;&quot;
  &gt;&lt;/span&gt;
  &lt;img
        class=&quot;gatsby-resp-image-image&quot;
        alt=&quot;20200313 2&quot;
        title=&quot;20200313 2&quot;
        src=&quot;/static/453ef2e246d86322ed09831e4de484c0/661c4/20200313-2.png&quot;
        srcset=&quot;/static/453ef2e246d86322ed09831e4de484c0/661c4/20200313-2.png 207w&quot;
        sizes=&quot;(max-width: 207px) 100vw, 207px&quot;
        style=&quot;width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;&quot;
        loading=&quot;lazy&quot;
      /&gt;
    &lt;/span&gt;  &lt;/p&gt;
&lt;p&gt;일반 SW처럼 호스트 OS 위에서 동작하나, HW 제어는 호스트 OS를 통한다.
상대적으로 오버헤드가 큰 단점이 있다.&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;ex) VirtualBox, VMWare, etc.&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h3 id=&quot;22-컨테이너container&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#22-%EC%BB%A8%ED%85%8C%EC%9D%B4%EB%84%88container&quot; aria-label=&quot;22 컨테이너container permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;2.2. 컨테이너(&lt;em&gt;Container&lt;/em&gt;)&lt;/h3&gt;
&lt;p&gt;&lt;span
      class=&quot;gatsby-resp-image-wrapper&quot;
      style=&quot;position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 292px; &quot;
    &gt;
      &lt;span
    class=&quot;gatsby-resp-image-background-image&quot;
    style=&quot;padding-bottom: 80.47945205479452%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAQCAYAAAAWGF8bAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAD50lEQVQ4y1WQ+U+TZxzA++v+gC27flmyKyMZm5vJovEaxzgUAdGhC04XJG4MQVmceMyD4DaNZpdz8ci2TBadIhOqQOGlfdtCD9a+pbTQYm0BsaBAWyjnlu2zh5cF3Q+ffI/nk+/zfB9N78gI9T3dNPX6ueXrQSvymyLO0+T3U+fz4+33MxdsItanJ96vZ3rQyNRdWY3z9XifgalAI8xOoDGGglRKLZyUDXxvsXCxw85Zq0VlvndML9PslBkdkAhEffiHFOw+E139dixeGX/YSTDWS/hOA0zeR2MKhTiub+WUych5ux2teNnlTpfIbZw2yVTJRlpcZkbvGQmOB/CFXdRItTRYG9HZdXgHFULxIEN9EkyNoOkaHqLapfCbu5NfRaxWnGo9n18VverOLhx+B5GwjYH4PR7M3GN0bpj7M+GFOD3IwOQQIwNm8cIHaJRwmAtizRqPhxvd3Vzr6uK610Ot18sVMfCCQ8Ha08HYkJ1AbACr7w8cwU5c/R41OgWheJjhu/8NNIfuUNnSyC8OOzc8bq67Fa4oDuq8bqodNipbJWSXgZlBHaFhBy2GKxjaajDb65AttUjGawyMdhINahf+sGN4jDOu25zvCvCD+zbn3AHOCr4RvTOdAb5yBbjuC2B1t2L2mLD527ELnPP0tqMIbN0mFI+ev+am0HwXmOb5xjHelCIsESS2RFgpR8m3TZDZFmOjdZxkU4x1lilSzHEy2+OskMd5WRfjleYFXhL5MjnOyNw/aD7vneExbYRnm6I8JXi8IcqLUoycjknWCwqUaZIscTJscd5TpkQtBrdP8GRjhKebIjwjeKIhQoIU5cHs32i0/jBFNzrY3aBQestJmaDkppMPtU61v63GQmGtjR2/2ymqtbKz3slH2gVvwVdUf3+zm4nZP9H8eKmaZclppOduJDV7g8o7gpSsHPLf/4DS8k/YUVxC0ce7KP+0gvScPPX8oZtH0rps8gq2EYlGxR/+dIkXVqSydO0GlqTnqLyRkUNiahbJm7dTevg4O/cfZkNRCYV7D7I0U3hp2Y+4uaq7ZtNWRiNioE42sedoFYdOnObAF6cWOfjlKfZVnaDk4FF2HTpG2WeV7DlS9T9HRXgVx09S9fUZ4pOTaM5duszrqetYnbeFlTn5i6zIfpe3NxVQfOAIBSXlbC/bS9a2Ipav38TK3IfeqtzNLM/ayNqthYxFY2i+vfgzz721iiViaGJy5iKvJmWIi7LYvnsfW4rLKCyvICV/Kwmr08T52kXvNZEnrElTh6sr3w72cVPS0yybmV//UZoMJuqbJep1EnW6Fm5JhsX+o16jwYi+zcLs3Bz/Ah4/rUaHwI8qAAAAAElFTkSuQmCC&apos;); background-size: cover; display: block;&quot;
  &gt;&lt;/span&gt;
  &lt;img
        class=&quot;gatsby-resp-image-image&quot;
        alt=&quot;20200313 3&quot;
        title=&quot;20200313 3&quot;
        src=&quot;/static/f3ffec38f37de7c47e39cbdf0c4d612a/2e9f9/20200313-3.png&quot;
        srcset=&quot;/static/f3ffec38f37de7c47e39cbdf0c4d612a/2e9f9/20200313-3.png 292w&quot;
        sizes=&quot;(max-width: 292px) 100vw, 292px&quot;
        style=&quot;width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;&quot;
        loading=&quot;lazy&quot;
      /&gt;
    &lt;/span&gt;  &lt;/p&gt;
&lt;p&gt;응용 프로그램의 종속성과 응용 프로그램 자체를 캡슐화한 것이다.
호스트 상에서 프로세스에게 고립된 환경을 제공하는 &lt;strong&gt;OS 레벨의 가상화 기술&lt;/strong&gt;이다.&lt;/p&gt;
&lt;p&gt;컨테이너의 장점으로는 다음 항목들을 꼽을 수 있다.&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;MB 단위의 작은 크기 (VM은 OS가 포함되므로 GB 단위를 넘어간다)&lt;/li&gt;
&lt;li&gt;필요한만큼 컨테이너를 구동 가능하다. (VM에서는 하나의 OS만을 구동한다.)&lt;/li&gt;
&lt;li&gt;배포 속도가 매우 빠르다.&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;단점으로는, 특정 컨테이너가 자원을 많이 사용할 수 있는 문제점이 있다. VM은 정확히 할당할 자원을 세팅이 가능하며 그 안에서만 사용되는데 반해, 컨테이너 환경에서는 제한을 두기 어렵다.&lt;/p&gt;
&lt;h3 id=&quot;31-이미지image&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#31-%EC%9D%B4%EB%AF%B8%EC%A7%80image&quot; aria-label=&quot;31 이미지image permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;3.1. 이미지(&lt;em&gt;Image&lt;/em&gt;)&lt;/h3&gt;
&lt;p&gt;이미지는 &lt;strong&gt;컨테이너 실행에 필요한 파일과 설정값 등을 포함&lt;/strong&gt;하고 있으며, 이는 상태값을 가지지 않고(&lt;em&gt;Non-Stateful&lt;/em&gt;) 불변(&lt;em&gt;Immutable&lt;/em&gt;)하다.
예를 들어 우분투 이미지는 우분투를 구동하기 위한 파일들을 포함하고 있으며, 설정을 선언하고 있다. MySQL 이미지는 우분투 이미지를 기반으로, 그 위에서 추가로 필요한 파일 및 설정을 포함하고 있다.
도커 엔진은 이미지를 기반으로 컨테이너를 실행하게 되는데, 이를 컨테이너 생성을 위한 설계도로 비유가 가능할 것이다.
&lt;a href=&quot;https://hub.docker.com&quot;&gt;Docker Hub&lt;/a&gt;에서 이미지를 Push, Pull이 가능하다.&lt;/p&gt;
&lt;h3 id=&quot;32-레이어layer&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#32-%EB%A0%88%EC%9D%B4%EC%96%B4layer&quot; aria-label=&quot;32 레이어layer permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;3.2. 레이어(&lt;em&gt;Layer&lt;/em&gt;)&lt;/h3&gt;
&lt;p&gt;컨테이너가 경량화된 가상화 기술이긴 해도 방대한 파일과 설정을 포함해야하기 때문에 이미지의 용량이 클 수밖에 없는데, 이는 레이어의 도입으로 이어졌다.&lt;/p&gt;
&lt;p&gt;&lt;span
      class=&quot;gatsby-resp-image-wrapper&quot;
      style=&quot;position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 630px; &quot;
    &gt;
      &lt;span
    class=&quot;gatsby-resp-image-background-image&quot;
    style=&quot;padding-bottom: 43%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAJCAYAAAAywQxIAAAACXBIWXMAAA7DAAAOwwHHb6hkAAABgUlEQVQoz22SiY7bMAxE/f9/2AAJkG03jg/J1n17OnI3iwIbAcTIpkg9UhyO48D/9m59+96c7dq+rO+HH8Gt4SgFR62nttKgJ4f92c1jf1gEk86zvkQ8vcQctlOXsGNwPsCHiK4pJVSx0FbU5yfaJlGEgBUBdjawnxJWBmRbkI+Cu5lw049TP+yMiYmHXRuM8wplLLZNoWiFHCP2VaCRMiuN7DNySbD09dKijbDFnwnGKKgSa1CnDcY6PKYFmrptO4r3iCx1Fhsqg7MjuU1wrGKR9OeK6BKk3eF9hB4dIi8UUWHyJNx2jT/jDEE6sbJEYxBJOC8ChYkzyaMmkfNY5Ub6wksrVDTQ9I2/JLyLGD1bkwMTKoPHc0FXx6AWPA5SFvbvYOIWSOgynCLNShqbUVNFOSpCTUjsZWgJseXzoYacy9nDlP796MMQSOl/f6D7XiuodL5w5au/Vi0ViZdmxnZtnJAfY5NzxvV2w+1+x/V6fTufr28hBS6XC+482zWwmr8XDrnoAANolQAAAABJRU5ErkJggg==&apos;); background-size: cover; display: block;&quot;
  &gt;&lt;/span&gt;
  &lt;img
        class=&quot;gatsby-resp-image-image&quot;
        alt=&quot;20200313 4&quot;
        title=&quot;20200313 4&quot;
        src=&quot;/static/4d1e8e6df209b05d4023f4149a684499/f058b/20200313-4.png&quot;
        srcset=&quot;/static/4d1e8e6df209b05d4023f4149a684499/5a46d/20200313-4.png 300w,
/static/4d1e8e6df209b05d4023f4149a684499/0a47e/20200313-4.png 600w,
/static/4d1e8e6df209b05d4023f4149a684499/f058b/20200313-4.png 630w&quot;
        sizes=&quot;(max-width: 630px) 100vw, 630px&quot;
        style=&quot;width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;&quot;
        loading=&quot;lazy&quot;
      /&gt;
    &lt;/span&gt;  &lt;/p&gt;
&lt;p&gt;위의 자료 사진에서 web app 이미지는 nginx 이미지를 기반으로 빌드되었는데, 이 nginx 이미지는 ubuntu 이미지를 기반으로 하고 있다.
이 때, web app이 새로운 버전으로 업데이트 되었다고 해서 베이스로 깔고 있는 nginx, ubuntu 이미지까지 모두 다시 pull 하는 것이 아니라, 변함이 없는 부분은 그대로 두고 바뀐 부분만 pull하게 된다.
실제로 도커 이미지가 빌드될 때 레이어를 생성하게 하는 특정 명령들이 있으며, 도커 엔진은 이를 적절한 레이어로 빌드하여 최종적으로 이미지를 생성한다.&lt;/p&gt;
&lt;h3 id=&quot;33-dockerfile&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#33-dockerfile&quot; aria-label=&quot;33 dockerfile permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;3.3. Dockerfile&lt;/h3&gt;
&lt;p&gt;Dockerfile은 도커 이미지를 정의하는 파일이다. 도커 엔진에서 지원하는 언어를 이용해서 이미지 생성 과정을 &lt;strong&gt;서술&lt;/strong&gt;한다.&lt;/p&gt;
&lt;p&gt;&lt;span
      class=&quot;gatsby-resp-image-wrapper&quot;
      style=&quot;position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 269px; &quot;
    &gt;
      &lt;span
    class=&quot;gatsby-resp-image-background-image&quot;
    style=&quot;padding-bottom: 84.01486988847584%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAARCAYAAADdRIy+AAAACXBIWXMAAA7DAAAOwwHHb6hkAAACdUlEQVQ4y5VU7XKbMBD0SzT+AiQhviExYCc2GAN2Grtxk3Q6nf5I3/89ticRPB636aQ/dk7Wwfl2b4+BxQRkPIczKyHcEL7nIQxDxMk1ojACs0yYZgfLsjT6s2lap7seA4vbkMkdvNvP8OIMbdtgt93iYX9AvdlAcHYqYBgGjFMx849iuiCzXfjFE8L1C6LyiFjhJsX9/QPaeoP1eo3VaoWiKHF8fsJqucRkMvlrsa5Di4FRl4o6ExIm4zph2zY45xBCaKjfnu9DUnyvO3U/UAdmO+BOQEUZrAtKvX4KhjHVkann3u2QS7h5C/9uD+H49EKnk6LVYzqd6tjfj0ajt9y4y5O24/H4rUOi6+aNHor0Q6zLEm3ToFqXqOsGi/lcoygLmnpA97Ue1qaqUFU1lqTpbJaiqWtyhOqQNBNeDOEnpKXAdZLQAzPEcYSErKMs5JN2aZrBcSSSOKFzSrlY59Vzrusiy1KSggpqfaZjGNS+RZ4bEh3VvkJPWZ2vrj6d6I5Gwy4Oh50URFnFE+WgOELOKmR5jp8/vmPXtnh+fkHTbBBGsbbOdrfTNPeHA24XC2TzBZq2hk0OOJ+6tg2nDWHCgSOlphAQxSAI4LgO2UXqcxhFOvoERTEI1DYlmuZFQVNPtl+lCU3UNM6tYugpn6O/62me22ygzBws9wirbwiLR3jXt3j6esSv11fMs0z/wb98d7mGg+7AtKlNixNYtx20ESqnPNZ/BN7bkIvVs2hLfKidloLDpo+BIF1UlASXdP1osdOm+KtHOPkOeXaDyHfRpDG+rHLUN6Gm7UhOun2woBZf7SiBcUW568bQAzG1FOw/OvwNffjkQPAKNgIAAAAASUVORK5CYII=&apos;); background-size: cover; display: block;&quot;
  &gt;&lt;/span&gt;
  &lt;img
        class=&quot;gatsby-resp-image-image&quot;
        alt=&quot;20200313 5&quot;
        title=&quot;20200313 5&quot;
        src=&quot;/static/a270a9b7f37bd9ddf88c9a1d7cf4facb/98fe2/20200313-5.png&quot;
        srcset=&quot;/static/a270a9b7f37bd9ddf88c9a1d7cf4facb/98fe2/20200313-5.png 269w&quot;
        sizes=&quot;(max-width: 269px) 100vw, 269px&quot;
        style=&quot;width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;&quot;
        loading=&quot;lazy&quot;
      /&gt;
    &lt;/span&gt;  &lt;/p&gt;
&lt;h3 id=&quot;34-주요-명령들&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#34-%EC%A3%BC%EC%9A%94-%EB%AA%85%EB%A0%B9%EB%93%A4&quot; aria-label=&quot;34 주요 명령들 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;3.4. 주요 명령들&lt;/h3&gt;
&lt;p&gt;도커 이용에 필요한 몇 가지 주요 명령들을 나열해 보았다. (자세한 건 구글링~)&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;build&lt;/strong&gt; : Dockerfile을 기반으로 이미지를 새로 생성한다. ex) &lt;code class=&quot;language-text&quot;&gt;$ docker build --tag freckie/api .&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;run&lt;/strong&gt; : 이미지로 컨테이너를 생성하여 구동한다. ex) &lt;code class=&quot;language-text&quot;&gt;$ docker run freckie/api&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;ps&lt;/strong&gt; : 현재 구동 중인 컨테이너 목록을 출력한다. ex) &lt;code class=&quot;language-text&quot;&gt;$ docker ps&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;attach&lt;/strong&gt; : 구동 중인 컨테이너에 접속한다. ex) &lt;code class=&quot;language-text&quot;&gt;$ docker attach e29a1ed8db62&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;exec&lt;/strong&gt; : 구동 중인 컨테이너에 명령을 전달한다. ex) &lt;code class=&quot;language-text&quot;&gt;$ docker exec --it e29a1ed8db62&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;pull&lt;/strong&gt; : Docker Hub에서 이미지를 가져온다. ex) &lt;code class=&quot;language-text&quot;&gt;$ docker pull khudasom/dasomapi&lt;/code&gt;&lt;/li&gt;
&lt;/ul&gt;</content:encoded></item><item><title><![CDATA[Visual Studio 2017에서 Win32 콘솔 응용 프로그램 프로젝트 만들기]]></title><description><![CDATA[Visual Studio 2017 최근 버전에서 ‘Win32 콘솔 응용 프로그램’ 프로젝트가 새 프로젝트 생성 화면에서 사라졌다. (VS2017 15.…]]></description><link>https://blog.frec.kr/cpp/vs2017-win32/</link><guid isPermaLink="false">https://blog.frec.kr/cpp/vs2017-win32/</guid><pubDate>Sun, 25 Mar 2018 00:00:00 GMT</pubDate><content:encoded>&lt;p&gt;Visual Studio 2017 최근 버전에서 ‘Win32 콘솔 응용 프로그램’ 프로젝트가 새 프로젝트 생성 화면에서 사라졌다. (VS2017 15.3 버전 이상)  &lt;/p&gt;
&lt;p&gt;&lt;span
      class=&quot;gatsby-resp-image-wrapper&quot;
      style=&quot;position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 640px; &quot;
    &gt;
      &lt;span
    class=&quot;gatsby-resp-image-background-image&quot;
    style=&quot;padding-bottom: 69.33333333333334%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAOCAIAAACgpqunAAAACXBIWXMAAAsTAAALEwEAmpwYAAABtElEQVQoz5WSWZKbMBCGucoMi7FBSEILQguLPY5T2d7mEjnQJGWDwXPSNFAhKde8uOqrLtSo/279knf+9db/fjtfuvN54nodx/E2DCNwG9+H4dZ1125Kv/fD7Xoduq6/XPppZz96efM9KE5PT4HvR0GwOR2/VtWLta0xdVlWlBZZxjEWhaoxkYXUlIokyZIEpyn26PFVv/6sqzbPOSHs25cfxtbW1VXVWFcxJgjJ4VdZasZk0xy0cVIqKTXLpccI0UJQwrOMAsZYa53WhnMhhPxLAUkQgp7QcMUDjaZ9wThPEUGIBEHo+wHEOyC52WzRvGfFU4VumwMcBpRgHUVxGEYfEcbx7r6Yc7CEruso2jxQPDekaKqnDxcjBEfP0iRDaQbfjxUzrrRrS7uXusaY/WfSnW2TYYsv84wTHhMqRjnmxu0/G9dQOt02xJwK0IJbWABfYECM6S5Jt9sdTAF4cJthEGYIfzqemmZfllZrB9GYSgi1CC2K8FSUMnG8fX72l3GgWBIKwqRtD9ZWczdGlkj4ypynSilZKOscQgiM8AL/3zP48HmsgJdxHDOhS3cQhYZB/gBPK7OU8tIfFAAAAABJRU5ErkJggg==&apos;); background-size: cover; display: block;&quot;
  &gt;&lt;/span&gt;
  &lt;img
        class=&quot;gatsby-resp-image-image&quot;
        alt=&quot;20180325-1.png&quot;
        title=&quot;20180325-1.png&quot;
        src=&quot;/static/946ec4acce648bdaf54c240de8101aaa/6af66/20180325-1.png&quot;
        srcset=&quot;/static/946ec4acce648bdaf54c240de8101aaa/5a46d/20180325-1.png 300w,
/static/946ec4acce648bdaf54c240de8101aaa/0a47e/20180325-1.png 600w,
/static/946ec4acce648bdaf54c240de8101aaa/6af66/20180325-1.png 640w&quot;
        sizes=&quot;(max-width: 640px) 100vw, 640px&quot;
        style=&quot;width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;&quot;
        loading=&quot;lazy&quot;
      /&gt;
    &lt;/span&gt;  &lt;/p&gt;
&lt;p&gt;&lt;strong&gt;파일 &gt; 새로 만들기 &gt; 새 프로젝트&lt;/strong&gt;를 누르면 나오는 창이다.&lt;/p&gt;
&lt;p&gt;기존 버전에서는 이 목록에 ‘Win32 콘솔 응용 프로그램’이 있었는데 업데이트로 자취를 감췄다.  &lt;/p&gt;
&lt;p&gt;&lt;span
      class=&quot;gatsby-resp-image-wrapper&quot;
      style=&quot;position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 640px; &quot;
    &gt;
      &lt;span
    class=&quot;gatsby-resp-image-background-image&quot;
    style=&quot;padding-bottom: 69.66666666666667%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAOCAIAAACgpqunAAAACXBIWXMAAAsTAAALEwEAmpwYAAACQElEQVQoz2WSy27TQBSG/QxIUKiiFOKxZ8YznrvtcZxLc2kLDS0sKhbtM0A3VEJILNghFixA4gEISdz2JTlOFLWi1qej8eic88+5BD9//f4zX8zny3ljF38Xq/r6drm6Xi7rVX2zqm8Xi7phdbtY3iyWK/AE/7q++fb9R1CWfWfzCGFCGMbJeDQpCm+Nsy7T2lDCEIoxpqnUQtl+f+hcoZQ1JpPKBdZk0+nLw6OZc55zcTA9MjZTxtosV9rGhIYRxiQRUqVCDgajqhpkmfdFl6c6UMp5X1mbS2kZEwejSS65E4lmOAnbeK9FnreSTltRxHDMU8W5ZFyCpYkIlHaD/j6IwH8qjJ9dRO8+k/Mv6OzTk9OrRycNO2+uwvOvneGZSFgqdJoqIVQTbG0xHh+AOFylqaa9163Z+9bJZfvkcmd2+fi4Yef4w7PTjy96bwXj4HMXrA082DSyTbCKw068t9vQ3sV7u2RL3H6axGgjexfMtmEboLFRjB+CophSJrZucEiYDCAZZymHey7WwSSK4ocgFFHQ+k8ZxlUOpr43KrrQtgycwhDBt7bRfQihUB3Eb6CJDKzzVNrU+P74VeF7MG3A2CLLStgEGOQGGGQKi6ItIQmURgmNMQ2yvEjgQZRNJofD4diXVVn2IEvZ7cEyGO0gBaC108bleQn6UD8KEcYMRuW01pynhe8qZcS6GVDSujAttzStEtKDU1lWVZXQpFGGLkIWqKgTQrUxijBCa9aH8B7gCXtqin7W3c/yLmzUP2FYuHfxEzFIAAAAAElFTkSuQmCC&apos;); background-size: cover; display: block;&quot;
  &gt;&lt;/span&gt;
  &lt;img
        class=&quot;gatsby-resp-image-image&quot;
        alt=&quot;20180325-2.png&quot;
        title=&quot;20180325-2.png&quot;
        src=&quot;/static/f2bdb5db4cf201f83975f27dccbfef0d/6af66/20180325-2.png&quot;
        srcset=&quot;/static/f2bdb5db4cf201f83975f27dccbfef0d/5a46d/20180325-2.png 300w,
/static/f2bdb5db4cf201f83975f27dccbfef0d/0a47e/20180325-2.png 600w,
/static/f2bdb5db4cf201f83975f27dccbfef0d/6af66/20180325-2.png 640w&quot;
        sizes=&quot;(max-width: 640px) 100vw, 640px&quot;
        style=&quot;width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;&quot;
        loading=&quot;lazy&quot;
      /&gt;
    &lt;/span&gt;  &lt;/p&gt;
&lt;p&gt;이제는 왼쪽 목록에서 &lt;strong&gt;Windows 데스크톱&lt;/strong&gt;을 선택하고, 중앙 목록에서 &lt;strong&gt;Windows 데스크톱 마법사&lt;/strong&gt;를 선택해야 한다.  &lt;/p&gt;
&lt;p&gt;&lt;span
      class=&quot;gatsby-resp-image-wrapper&quot;
      style=&quot;position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 640px; &quot;
    &gt;
      &lt;span
    class=&quot;gatsby-resp-image-background-image&quot;
    style=&quot;padding-bottom: 75%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAPCAIAAABr+ngCAAAACXBIWXMAAAsTAAALEwEAmpwYAAABnklEQVQoz32T63KCMBSEeZUit5AgEpBWVC5qwVZn7Ps/TT85LcX+cGbFk8vu2WzACYJQEIbRVD+BUrHWiY51Vrw6jBcL7+XFBa67oJ6DGc/zKXw/EDAEFMYkDgt1Xb+/98fjab+vu+7Qtu1mU91uX03TMnm9XofhjC/hTBJxrB3RyPOiKNbW5mm6Wq0ymUmS5XKZ8qOQhhOfIoqUgyQENmWZha+1wb9YdV0PGpPIleUrcoAzjxKQ43vnpjkMw2fXnfr+o+/PZblJUys+sbBelzBRgYZV5n87j2Q6s8OYJWvUFOwjSJZ4cpbdbo+KhDezHd/TxhUJoY1nhp7Y+s2GsyHKc5r5I/OXmMRmluZVtUWIDvOLnV/PfzLOFmGsk5W1VoLBoQQ2YU57IFOFOi3Kt6qq6rrhqjkhyZO/3AJ4RtZjTmzi2ECuGiDBk+GdQHuJ4l9gk8mxEDy8pJjzIx1E2g8VV0V4sH7IIhbcMTmblZ7PufaHy/H8lb21223b95eyrLhO5y9VhFUCPJP7Sj98TLRROopNGGk+qfFF0EqZb4rultK9kXD6AAAAAElFTkSuQmCC&apos;); background-size: cover; display: block;&quot;
  &gt;&lt;/span&gt;
  &lt;img
        class=&quot;gatsby-resp-image-image&quot;
        alt=&quot;20180325-3.png&quot;
        title=&quot;20180325-3.png&quot;
        src=&quot;/static/e666cfe0e30aac8e5ae87a813366dd61/6af66/20180325-3.png&quot;
        srcset=&quot;/static/e666cfe0e30aac8e5ae87a813366dd61/5a46d/20180325-3.png 300w,
/static/e666cfe0e30aac8e5ae87a813366dd61/0a47e/20180325-3.png 600w,
/static/e666cfe0e30aac8e5ae87a813366dd61/6af66/20180325-3.png 640w&quot;
        sizes=&quot;(max-width: 640px) 100vw, 640px&quot;
        style=&quot;width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;&quot;
        loading=&quot;lazy&quot;
      /&gt;
    &lt;/span&gt;  &lt;/p&gt;
&lt;p&gt;응용 프로그램 종류를 &lt;strong&gt;콘솔 응용 프로그램(.exe)&lt;/strong&gt;로 설정한다.&lt;/p&gt;
&lt;p&gt;추가옵션에서 기본으로는 &lt;strong&gt;미리 컴파일된 헤더&lt;/strong&gt;가 설정되어 있을텐데,&lt;/p&gt;
&lt;p&gt;나는 지금까지 &lt;strong&gt;미리 컴파일된 헤더&lt;/strong&gt;를 해제하고, &lt;strong&gt;빈 프로젝트&lt;/strong&gt;로 설정해서 사용했기 때문에 옵션을 바꾸었다.&lt;/p&gt;
&lt;p&gt;확인을 눌러 프로젝트를 생성하고, 소스 파일을 만들어 즐겁게 코딩하면 된다.&lt;/p&gt;</content:encoded></item><item><title><![CDATA[(번역글) Python은 call-by-value일까, call-by-reference일까?]]></title><description><![CDATA[파이썬에서는 함수 파라미터 작동을 어떻게 하는지 찾아보다 괜찮은 글이 있어 가져와 보았다. ( 이글 댓글창에서도 의견이 분분하지만 적어도 내가 생각하는 바와 비슷해서 옮겨왔다. / 발번역 ) 출처 : https://jeffknupp.com/blog…]]></description><link>https://blog.frec.kr/python/call-by-value-or-reference/</link><guid isPermaLink="false">https://blog.frec.kr/python/call-by-value-or-reference/</guid><pubDate>Fri, 09 Mar 2018 00:00:00 GMT</pubDate><content:encoded>&lt;p&gt;파이썬에서는 함수 파라미터 작동을 어떻게 하는지 찾아보다 괜찮은 글이 있어 가져와 보았다. ( 이글 댓글창에서도 의견이 분분하지만 적어도 내가 생각하는 바와 비슷해서 옮겨왔다. / 발번역 )&lt;/p&gt;
&lt;p&gt;출처 : &lt;a href=&quot;https://jeffknupp.com/blog/2012/11/13/is-python-callbyvalue-or-callbyreference-neither/&quot;&gt;https://jeffknupp.com/blog/2012/11/13/is-python-callbyvalue-or-callbyreference-neither/&lt;/a&gt;&lt;/p&gt;
&lt;h2 id=&quot;파이썬은-call-by-value나-call-by-reference로-작동할까-둘-다-아니다&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#%ED%8C%8C%EC%9D%B4%EC%8D%AC%EC%9D%80-call-by-value%EB%82%98-call-by-reference%EB%A1%9C-%EC%9E%91%EB%8F%99%ED%95%A0%EA%B9%8C-%EB%91%98-%EB%8B%A4-%EC%95%84%EB%8B%88%EB%8B%A4&quot; aria-label=&quot;파이썬은 call by value나 call by reference로 작동할까 둘 다 아니다 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;파이썬은 Call-by-value나 call-by-reference로 작동할까? 둘 다 아니다.&lt;/h2&gt;
&lt;p&gt;C나 Java 같은 언어에서 넘어온 개발자들이 파이썬 프로그래밍을 할 때 실수를 저지르는 것 중 하나는, 파이썬 함수에서 파라미터를 넘기는 방식에 대한 것이다. 더 기초적인 레벨에서, 이런 혼동은 파이썬의 객체 중심적 데이터 모델(object-centric data model)에 대한 오해에서 기인한다. 누군가 파이썬 함수의 호출 방식이 &lt;em&gt;“call-by-value”&lt;/em&gt; 인지, &lt;em&gt;“call-by-reference”&lt;/em&gt;인지 질문을 한다면, &lt;strong&gt;둘다 아니다&lt;/strong&gt;가 정확한 답이 될 것이다. 사실은, 이런 용어들을 파이썬의 모델에 끼워넣기식 번역을 하는 것은 파이썬을 제대로 이해하지 못한 탓이다. &lt;em&gt;“call-by-object”&lt;/em&gt;나 &lt;em&gt;“call-by-object-reference”&lt;/em&gt;가 파이썬의 방식을 설명하기에 더 적합한 용어일 것이다. 그러면 &lt;em&gt;“call-by-object”&lt;/em&gt;가 무슨 뜻일까?  &lt;/p&gt;
&lt;p&gt;파이썬에서는 (거의) 대부분이 객체다. 우리가 파이썬에서 보통 “변수”라고 부르던 것은 더 정확히는 &lt;em&gt;이름(names)&lt;/em&gt;이다. 비슷하게 &lt;em&gt;대입(assignment)&lt;/em&gt;은 실제로 객체에 이름을 &lt;em&gt;바인딩(binding, 연결)&lt;/em&gt; 하는 것일뿐이다. 각각의 바인딩에는 바인딩이 유지되는 &lt;em&gt;스코프(scope)&lt;/em&gt; (보통 이름이 시작되는 블록)가 있다.  &lt;/p&gt;
&lt;p&gt;한 번에 많은 용어들을 사용했지만 이런 기본 용어들이 파이썬 실행 모델의 기초를 형성한다. 그리고 C++과 비교했을 때의 차이는 미묘하지만 중요하다. 다음은 이러한 차이를 강조하는 구체적인 예제이다. 다음 C++ 예제가 실행될 때 일어날 일을 생각해보자.  &lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;cpp&quot;&gt;&lt;pre class=&quot;language-cpp&quot;&gt;&lt;code class=&quot;language-cpp&quot;&gt;string some_guy &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;Fred&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;token comment&quot;&gt;// ...&lt;/span&gt;
some_guy &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;George&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;위의 예제에서 &lt;code class=&quot;language-text&quot;&gt;some_guy&lt;/code&gt; 변수는 메모리의 한 위치를 가리키고 ‘Fred’라는 값은 그 위치에 삽입되어 있는 데이터이다 (실제로 우리는 &lt;code class=&quot;language-text&quot;&gt;some_guy&lt;/code&gt; 의 주소를 이용해서 참조되는 메모리 위치를 얻을 수 있다). 그리고 &lt;code class=&quot;language-text&quot;&gt;some_guy&lt;/code&gt; 가 가리키는 메모리 위치의 컨텐츠는 ‘George’ 로 바뀐다. 이전의 값은 더 이상 존재하지 않으며 새로운 값으로 덮어쓰기된 것이다. 아마 이 방법이 우리가 직관적으로 생각하던 방법에 더 가까울 것이다.  &lt;/p&gt;
&lt;p&gt;이번에는 위와 비슷한 파이썬 코드를 보자.  &lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;python&quot;&gt;&lt;pre class=&quot;language-python&quot;&gt;&lt;code class=&quot;language-python&quot;&gt;some_guy &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&apos;Fred&apos;&lt;/span&gt;
&lt;span class=&quot;token comment&quot;&gt;# ...&lt;/span&gt;
some_guy &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&apos;George&apos;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;h2 id=&quot;객체에-이름을-바인딩하기&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#%EA%B0%9D%EC%B2%B4%EC%97%90-%EC%9D%B4%EB%A6%84%EC%9D%84-%EB%B0%94%EC%9D%B8%EB%94%A9%ED%95%98%EA%B8%B0&quot; aria-label=&quot;객체에 이름을 바인딩하기 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;객체에 이름을 바인딩하기&lt;/h2&gt;
&lt;p&gt;첫째 줄에서 우리는 &lt;code class=&quot;language-text&quot;&gt;some_guy&lt;/code&gt; 라는 이름과, ‘Fred’ 값을 포함하는 문자열 객체를 바인딩했다. 프로그램의 맥락에서 보면 환경이 바뀐 것이다. 문자열 객체와 &lt;code class=&quot;language-text&quot;&gt;some_guy&lt;/code&gt; 라는 이름의 바인딩이 구문이 실행된 블록의 스코프에서 만들어졌다. 그 후에 &lt;code class=&quot;language-text&quot;&gt;some_guy = &amp;#39;George&amp;#39;&lt;/code&gt; 구문을 실행할 때, ‘Fred’ 값을 가지는 문자열 객체는 영향을 받지 않는 상태가 된다 (&lt;em&gt;unaffected&lt;/em&gt;). 우리는 단지 &lt;code class=&quot;language-text&quot;&gt;some_guy&lt;/code&gt; 이름의 바인딩을 바꿨을 뿐이다! 그러나 우리는 &lt;strong&gt;‘Fred’나 ‘George’ 문자열 객체를 바꾸지는 않았다&lt;/strong&gt;. 우리의 입장에서 그 객체들은 무제한으로 살아있게 된다.  &lt;/p&gt;
&lt;p&gt;너무 지나치게 세세한 것에 신경쓰는 것 같아 보일 수 있지만, 바인딩이 공유되거나 함수가 호출될 경우에는 단 하나의 바인딩을 하는 것이 더 중요할 것이다. 다음 파이썬 코드를 보고 다시 생각해보자.  &lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;python&quot;&gt;&lt;pre class=&quot;language-python&quot;&gt;&lt;code class=&quot;language-python&quot;&gt;some_guy &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&apos;Fred&apos;&lt;/span&gt;

first_names &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;
first_names&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;append&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;some_guy&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;

another_list_of_names &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; first_names
another_list_of_names&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;append&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&apos;George&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
some_guy &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&apos;Bill&apos;&lt;/span&gt;

&lt;span class=&quot;token keyword&quot;&gt;print&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;some_guy&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; first_names&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; another_list_of_names&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;마지막 줄에서는 무슨 결과가 출력되었을까? 처음부터 보자면 ‘Fred’ 문자열 객체와 &lt;code class=&quot;language-text&quot;&gt;some_guy&lt;/code&gt; 이름의 바인딩이 블록의 &lt;em&gt;namespace&lt;/em&gt;에 추가되었고, 그 뒤 &lt;code class=&quot;language-text&quot;&gt;first_name&lt;/code&gt; 이라는 이름이 빈 리스트 객체에 바인딩되었다. 4번째 줄에서는 &lt;code class=&quot;language-text&quot;&gt;first_name&lt;/code&gt;라는 이름이 바인딩된 리스트 객체에 &lt;code class=&quot;language-text&quot;&gt;some_guy&lt;/code&gt;가 바인딩 된 객체를 추가하는 함수가 호출된다. 이 부분에서, 실재하는 객체는 문자열과 리스트 객체 단 두 개 뿐이다. 그리고 &lt;code class=&quot;language-text&quot;&gt;some_guy&lt;/code&gt;와 &lt;code class=&quot;language-text&quot;&gt;first_name[0]&lt;/code&gt;은 둘 다 같은 객체를 가리킨다.  &lt;/p&gt;
&lt;p&gt;(실제로 &lt;code class=&quot;language-text&quot;&gt;print(some_guy is first_names[0])&lt;/code&gt; 구문의 결과가 이를 증명한다)  &lt;/p&gt;
&lt;p&gt;계속 분석해보자. 6번째 줄에서는 &lt;code class=&quot;language-text&quot;&gt;another_list_of_names&lt;/code&gt;라는 새로운 이름이 바인딩 된다. 이름간의 대입은 새로운 객체를 만들지 않는다. 이 이름들은 단순히 같은 객체에 바인딩된 것 뿐이다. 결과적으로 문자열 객체와 리스트 객체, 여전히 이 두 개만이 인터프리터에 의해 만들어진 객체가 된다. 7번째 줄에서는 &lt;code class=&quot;language-text&quot;&gt;another_list_of_names&lt;/code&gt;가 바인딩된 객체의 멤버 함수가 호출되며, ‘George’ 라는 새 객체를 추가하도록 변경된다. 그래서 아까 전의 질문에 대답하기 위해 코드의 출력 결과를 보면 다음과 같다.  &lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;python&quot;&gt;&lt;pre class=&quot;language-python&quot;&gt;&lt;code class=&quot;language-python&quot;&gt;Bill &lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&apos;Fred&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&apos;George&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&apos;Fred&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&apos;George&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;이 결과는 파이썬에서는 실제로 두 가지 종류의 객체가 있다는 중요한 점을 보여준다. &lt;strong&gt;&lt;em&gt;변경가능한 객체(mutable object)&lt;/em&gt;&lt;/strong&gt;는 시간에 따라 변화하는 동작을 하며, 바인딩된 모든 이름을 통해 알 수 있다. 파이썬의 리스트는 변경가능한 객체의 한 예이다. &lt;strong&gt;&lt;em&gt;변경불가능한 객체(immutable object)&lt;/em&gt;&lt;/strong&gt;는 만들어진 이후에 수정될 수 없다. 이들은 &lt;code class=&quot;language-text&quot;&gt;string.join()&lt;/code&gt;과 같은 함수가 새로운 객체의 값을 계산하기 위해 쓰일 수 있다. 이에 대해 생각해 볼 때, 파이썬에서 모든 것이 객체이기 때문에 이러한 &lt;strong&gt;“이분법”&lt;/strong&gt;적인 구분이 필요할 수 밖에 없다. 만약 정수형이 변경불가능했다면 우리는 프로그램에서 숫자 &lt;em&gt;2&lt;/em&gt;의 의미를 바꿀 수 있었을 것이다!  &lt;/p&gt;
&lt;p&gt;그러나 “변경가능한 객체는 바뀔 수 있고, 변경불가능한 객체는 바뀔 수 없다”고 말할 수는 없다. 다음의 예제를 고려해보자.  &lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;python&quot;&gt;&lt;pre class=&quot;language-python&quot;&gt;&lt;code class=&quot;language-python&quot;&gt;first_names &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&apos;Fred&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&apos;George&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&apos;Bill&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;
last_names &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&apos;Smith&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&apos;Jones&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&apos;Williams&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;
name_tuple &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;first_names&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; last_names&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;

first_names&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;append&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&apos;Igor&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;파이썬에서의 튜플은 변경불가능하다. 우리는 &lt;code class=&quot;language-text&quot;&gt;name_tuple&lt;/code&gt;으로 바인딩된 튜플 객체를 바꿀 수는 없다. 그러나 변경불가능한 컨테이너는 리스트와 같은 변경가능한 객체의 참조가 포함할 수 있다. 그러므로 &lt;code class=&quot;language-text&quot;&gt;name_tuple&lt;/code&gt;이 변경불가능하다고 해도, 마지막 줄에서 ‘Igor’가 &lt;code class=&quot;language-text&quot;&gt;first_name&lt;/code&gt;에 추가될 때 &lt;code class=&quot;language-text&quot;&gt;name_tuple&lt;/code&gt;은 변경된다. 이는 때로 유용할 수 있는 미묘한 부분이다.  &lt;/p&gt;
&lt;p&gt;이제는 파이썬에서 함수 호출이 어떻게 작동하는지 거의 알 수 있어야 한다. 만약 &lt;code class=&quot;language-text&quot;&gt;foo(bar)&lt;/code&gt;를 호출한다면, 함수가 호출될 때 foo 함수의 스코프 안에서 인수 bar가 바인딩된 객체에 바인딩을 하기만 하면 된다. &lt;strong&gt;만약&lt;/strong&gt; &lt;code class=&quot;language-text&quot;&gt;bar&lt;/code&gt;&lt;strong&gt;가 변경가능한 객체를 가리키고&lt;/strong&gt; &lt;code class=&quot;language-text&quot;&gt;foo&lt;/code&gt;&lt;strong&gt;가&lt;/strong&gt; &lt;code class=&quot;language-text&quot;&gt;bar&lt;/code&gt;&lt;strong&gt;의 값을 바꾼다면, 이는 함수 스코프 바깥에서도 적용된다.&lt;/strong&gt;  &lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;python&quot;&gt;&lt;pre class=&quot;language-python&quot;&gt;&lt;code class=&quot;language-python&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;foo&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;bar&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
    bar&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;append&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;42&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;bar&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;token comment&quot;&gt;# &gt;&gt; [42]&lt;/span&gt;

answer_list &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;
foo&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;answer_list&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;answer_list&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;token comment&quot;&gt;# &gt;&gt; [42]&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;반면에 &lt;code class=&quot;language-text&quot;&gt;bar&lt;/code&gt;가 변경불가능한 객체를 가리킨다면, &lt;code class=&quot;language-text&quot;&gt;foo&lt;/code&gt; 함수가 할 수 있는 것은 함수 내부의 &lt;em&gt;namespace&lt;/em&gt;에 &lt;code class=&quot;language-text&quot;&gt;bar&lt;/code&gt; 라는 이름을 만들고 완전히 다른 객체에 바인딩하는 것뿐이다.  &lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;python&quot;&gt;&lt;pre class=&quot;language-python&quot;&gt;&lt;code class=&quot;language-python&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;foo&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;bar&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
    bar &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&apos;new value&apos;&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;print&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;bar&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;token comment&quot;&gt;# &gt;&gt; &apos;new value&apos;&lt;/span&gt;

answer_list &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&apos;old value&apos;&lt;/span&gt;
foo&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;answer_list&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;answer_list&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;token comment&quot;&gt;# &gt;&gt; &apos;old value&apos;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;이제 왜 파이썬이 &lt;em&gt;“call-by-value”&lt;/em&gt;나 &lt;em&gt;“call-by-reference”&lt;/em&gt;가 아닌지 명확해졌을 거라고 생각한다. 파이썬에서의 변수는 메모리의 위치를 가리키는 것이 아니다. 단순히 파이썬 객체와의 바인딩을 뜻할 뿐이다. “모든 것이 객체다”라는 말이 파이썬에 익숙하지 않은 사람들에게는 혼란의 원인이 될 수 있지만, 이는 강력하고 유연한 언어 구조를 갖게 해준다.  &lt;/p&gt;</content:encoded></item><item><title><![CDATA[(C++11) Range-Based for Loop]]></title><description><![CDATA[Python, Javascript 등 다른 언어에서 편하게 사용되던 for문을 C++에서도 사용할 수 있게 C++11에서 추가된 문법이 Range-Based for Loop (범위 기반 for 루프) 이다.   위와 같은 Python 코드를 C…]]></description><link>https://blog.frec.kr/cpp/modern-cpp-1/</link><guid isPermaLink="false">https://blog.frec.kr/cpp/modern-cpp-1/</guid><pubDate>Tue, 30 Jan 2018 00:00:00 GMT</pubDate><content:encoded>&lt;p&gt;Python, Javascript 등 다른 언어에서 편하게 사용되던 for문을 C++에서도 사용할 수 있게 C++11에서 추가된 문법이 &lt;em&gt;Range-Based for Loop (범위 기반 for 루프)&lt;/em&gt; 이다.  &lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;python&quot;&gt;&lt;pre class=&quot;language-python&quot;&gt;&lt;code class=&quot;language-python&quot;&gt;country_list &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&quot;KOR&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;JPN&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;CHN&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;for&lt;/span&gt; country &lt;span class=&quot;token keyword&quot;&gt;in&lt;/span&gt; country_list&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
 &lt;span class=&quot;token keyword&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;country&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;위와 같은 Python 코드를 C++로 구현하려면 기존에는 다음과 같아야 할 것이다.  &lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;cpp&quot;&gt;&lt;pre class=&quot;language-cpp&quot;&gt;&lt;code class=&quot;language-cpp&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;using&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;namespace&lt;/span&gt; std&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;

vector&lt;span class=&quot;token operator&quot;&gt;&amp;lt;&lt;/span&gt;string&lt;span class=&quot;token operator&quot;&gt;&gt;&lt;/span&gt; li&lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&quot;KOR&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;JPN&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;CHN&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;

&lt;span class=&quot;token comment&quot;&gt;// auto로 간결하게 사용 가능&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;vector&lt;span class=&quot;token operator&quot;&gt;&amp;lt;&lt;/span&gt;string&lt;span class=&quot;token operator&quot;&gt;&gt;&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;::&lt;/span&gt;iterator it &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; li&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;begin&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt; it &lt;span class=&quot;token operator&quot;&gt;!=&lt;/span&gt; li&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;end&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;++&lt;/span&gt;it&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
 cout &lt;span class=&quot;token operator&quot;&gt;&amp;lt;&amp;lt;&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;*&lt;/span&gt;it&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;새로운 for문을 사용하면 다음처럼 간결해진다.  &lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;cpp&quot;&gt;&lt;pre class=&quot;language-cpp&quot;&gt;&lt;code class=&quot;language-cpp&quot;&gt;vector&lt;span class=&quot;token operator&quot;&gt;&amp;lt;&lt;/span&gt;string&lt;span class=&quot;token operator&quot;&gt;&gt;&lt;/span&gt; li&lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&quot;KOR&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;JPN&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;CHN&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;for&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token keyword&quot;&gt;auto&lt;/span&gt; it &lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; li&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
 cout &lt;span class=&quot;token operator&quot;&gt;&amp;lt;&amp;lt;&lt;/span&gt; it&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;Visual Studio 를 사용중인 경우에, for 구문의 it에 커서를 가져가면 다음과 같은 메세지가 띄워진다. (위의 두 가지 C++ 예제가 동치라는 것을 알 수 있다.)  &lt;/p&gt;
&lt;p&gt;&lt;code class=&quot;language-text&quot;&gt;std::string it&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;&lt;code class=&quot;language-text&quot;&gt;for(vector&amp;lt;string&amp;gt;::iterator it = li.begin(); it!=li.end(); ++it)&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;이 문법을 사용할 때 주의할 점이 있기는 한데,
당연하게도 예제에서 &lt;code class=&quot;language-text&quot;&gt;auto it&lt;/code&gt; 과 같이 for문에서 정의한 변수는 for문 바깥에서 사용할 수 없다.
만약 for문을 통해 단순히 값에 접근이 아니라 수정을 하고 싶다면 다음과 같이 레퍼런스로 받아오면 된다.  &lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;cpp&quot;&gt;&lt;pre class=&quot;language-cpp&quot;&gt;&lt;code class=&quot;language-cpp&quot;&gt;vector&lt;span class=&quot;token operator&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;token keyword&quot;&gt;int&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;&gt;&lt;/span&gt; li&lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;3&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;4&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;5&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token keyword&quot;&gt;auto&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;&amp;amp;&lt;/span&gt;it &lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; li&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
 it &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; it &lt;span class=&quot;token operator&quot;&gt;*&lt;/span&gt; it&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;(MSDN에 의하면) 새로운 for문은 다음 조건을 통해 &lt;em&gt;iterable&lt;/em&gt;한 객체를 인식한다.  &lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;배열을 자동으로 인식&lt;/li&gt;
&lt;li&gt;&lt;code class=&quot;language-text&quot;&gt;begin()&lt;/code&gt;, &lt;code class=&quot;language-text&quot;&gt;end()&lt;/code&gt;를 가지고 있는 객체를 인식&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;사용자가 정의한 class를 이 문법으로 사용 가능하게 하려면, class의 멤버 함수로 &lt;code class=&quot;language-text&quot;&gt;begin()&lt;/code&gt;, &lt;code class=&quot;language-text&quot;&gt;end()&lt;/code&gt;를 만들어주어야 하며,
&lt;em&gt;iterator&lt;/em&gt;에서는 &lt;code class=&quot;language-text&quot;&gt;operator++&lt;/code&gt;, &lt;code class=&quot;language-text&quot;&gt;operator!=&lt;/code&gt;, &lt;code class=&quot;language-text&quot;&gt;operator*&lt;/code&gt;를 구현해야 한다.&lt;/p&gt;</content:encoded></item><item><title><![CDATA[(C++11) std::unique_ptr]]></title><description><![CDATA[Smart Pointer C++에서 제공하는 동적 메모리 할당&해제는 분명히 장점도 있지만, 프로그래머의 실수로 인해 심각한 버그를 초래할 수 있다. Java 등과 같은 언어는 Garbage Collection…]]></description><link>https://blog.frec.kr/cpp/modern-cpp-0/</link><guid isPermaLink="false">https://blog.frec.kr/cpp/modern-cpp-0/</guid><pubDate>Fri, 05 Jan 2018 00:00:00 GMT</pubDate><content:encoded>&lt;h2 id=&quot;smart-pointer&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#smart-pointer&quot; aria-label=&quot;smart pointer permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;Smart Pointer&lt;/h2&gt;
&lt;p&gt;C++에서 제공하는 동적 메모리 할당&amp;#x26;해제는 분명히 장점도 있지만, 프로그래머의 실수로 인해 심각한 버그를 초래할 수 있다.&lt;/p&gt;
&lt;p&gt;Java 등과 같은 언어는 &lt;em&gt;Garbage Collection&lt;/em&gt; 기능을 지원해 자동으로 메모리 할당&amp;#x26;해제를 도와주며, 이는 C++의 메모리 관리에 비해 편리함이 자명하다.&lt;/p&gt;
&lt;p&gt;따라서 &lt;em&gt;Garbage Collection&lt;/em&gt;의 필요성이 C++에서도 대두되었고 그 결과 탄생한 것이 &lt;strong&gt;&lt;em&gt;Smart Pointer&lt;/em&gt;&lt;/strong&gt; 개념이다.&lt;/p&gt;
&lt;p&gt;스마트 포인터는 소멸될 때, 소유하고 있던 객체를 소멸시켜 메모리 누수 및 의도치 않은 상황을 방지한다.&lt;/p&gt;
&lt;p&gt;이렇게 &lt;em&gt;Dangling Pointer&lt;/em&gt; 위험성도 해결할 수 있다는 것이 스마트 포인터 사용의 장점이 될 수 있을 것이다.&lt;/p&gt;
&lt;p&gt;C++11 이전에 있던 스마트 포인터는 auto_ptr이 있었지만 사용 상에 여러 제약이 있어 폭넓게 사용되진 못했다고 한다.&lt;/p&gt;
&lt;p&gt;(C++11에서 deprecated, C++17에서 removed)&lt;/p&gt;
&lt;p&gt;C++11 이후에 추가된 스마트 포인터는 &lt;code class=&quot;language-text&quot;&gt;unique_ptr&lt;/code&gt;, &lt;code class=&quot;language-text&quot;&gt;shared_ptr&lt;/code&gt;, &lt;code class=&quot;language-text&quot;&gt;weak_ptr&lt;/code&gt;이 있으며 이번 포스팅에서는 &lt;code class=&quot;language-text&quot;&gt;unique_ptr&lt;/code&gt;을 다룰 것이다.&lt;/p&gt;
&lt;h2 id=&quot;stdunique_ptr&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#stdunique_ptr&quot; aria-label=&quot;stdunique_ptr permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;std::unique_ptr&lt;/h2&gt;
&lt;p&gt;&lt;code class=&quot;language-text&quot;&gt;unique_ptr&lt;/code&gt;은 포인터의 &lt;strong&gt;독점적인 소유권&lt;/strong&gt;을 가진 객체이다.&lt;/p&gt;
&lt;p&gt;즉, 하나의 대상 포인터를 여러 개의 &lt;code class=&quot;language-text&quot;&gt;unique_ptr&lt;/code&gt;이 소유할 수 없다.&lt;/p&gt;
&lt;p&gt;대상 포인터를 소유하던 &lt;code class=&quot;language-text&quot;&gt;unique_ptr&lt;/code&gt;이 소멸될 때, 포인터를 소멸시킨 후에 &lt;code class=&quot;language-text&quot;&gt;unique_ptr&lt;/code&gt;이 소멸된다.&lt;/p&gt;
&lt;p&gt;(&lt;code class=&quot;language-text&quot;&gt;shared_ptr&lt;/code&gt;의 경우에는 모든 &lt;code class=&quot;language-text&quot;&gt;shared_ptr&lt;/code&gt;이 소멸되어야 대상 포인터가 소멸된다.)&lt;/p&gt;
&lt;p&gt;unique_ptr을 사용하기 위해서 &lt;memory&gt; 헤더를 인클루드 해준다.&lt;/p&gt;
&lt;p&gt;( 참고 : &lt;code class=&quot;language-text&quot;&gt;auto_ptr&lt;/code&gt;은 STL 컨테이너에 사용할 수 없었지만, &lt;code class=&quot;language-text&quot;&gt;unique_ptr&lt;/code&gt;은 STL 컨테이너에서도 사용 가능하다. )&lt;/p&gt;
&lt;h2 id=&quot;생성&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#%EC%83%9D%EC%84%B1&quot; aria-label=&quot;생성 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;생성&lt;/h2&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;cpp&quot;&gt;&lt;pre class=&quot;language-cpp&quot;&gt;&lt;code class=&quot;language-cpp&quot;&gt;&lt;span class=&quot;token comment&quot;&gt;// 생성자를 사용한 생성.&lt;/span&gt;
std&lt;span class=&quot;token operator&quot;&gt;::&lt;/span&gt;unique_ptr&lt;span class=&quot;token operator&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;token keyword&quot;&gt;int&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;&gt;&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;ptr1&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token keyword&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;int&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;2018&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;

&lt;span class=&quot;token comment&quot;&gt;// [컴파일 에러] 복사 생성자 금지.&lt;/span&gt;
std&lt;span class=&quot;token operator&quot;&gt;::&lt;/span&gt;unique_ptr&lt;span class=&quot;token operator&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;token keyword&quot;&gt;int&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;&gt;&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;ptr2&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;ptr1&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;

&lt;span class=&quot;token comment&quot;&gt;// [컴파일 에러] 대입 연산자 사용 금지.&lt;/span&gt;
std&lt;span class=&quot;token operator&quot;&gt;::&lt;/span&gt;unique_ptr&lt;span class=&quot;token operator&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;token keyword&quot;&gt;int&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;&gt;&lt;/span&gt; ptr3 &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; ptr1&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;

&lt;span class=&quot;token comment&quot;&gt;// [컴파일 에러] raw pointer 대입 금지.&lt;/span&gt;
std&lt;span class=&quot;token operator&quot;&gt;::&lt;/span&gt;unique_ptr&lt;span class=&quot;token operator&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;token keyword&quot;&gt;int&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;&gt;&lt;/span&gt; ptr4 &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;int&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;2018&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;

&lt;span class=&quot;token comment&quot;&gt;// [C++14 기능] Factory 함수를 사용한 생성.&lt;/span&gt;
std&lt;span class=&quot;token operator&quot;&gt;::&lt;/span&gt;unique_ptr&lt;span class=&quot;token operator&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;token keyword&quot;&gt;int&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;&gt;&lt;/span&gt; ptr5 &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; std&lt;span class=&quot;token operator&quot;&gt;::&lt;/span&gt;make_unique&lt;span class=&quot;token operator&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;token keyword&quot;&gt;int&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;&gt;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;5&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;위 예제에서 볼 수 있듯이 &lt;code class=&quot;language-text&quot;&gt;unique_ptr&lt;/code&gt;은 &lt;strong&gt;복사 생성자, 대입 연산자(복사 지정)는 사용이 금지&lt;/strong&gt;되어 있다.&lt;/p&gt;
&lt;p&gt;복사 생성자가 허용되었다면 같은 포인터에 대해 여러 &lt;code class=&quot;language-text&quot;&gt;unique_ptr&lt;/code&gt;이 소유하고 있다는 착각을 할 수 있기 때문에 금지되었다고 한다.&lt;/p&gt;
&lt;p&gt;Scott Meyers는 생성자를 사용해 생성하는 것보다, &lt;strong&gt;make_unique 함수를 통해 생성하는 것을 선호&lt;/strong&gt;하라고 조언한다. 예외 안정성, 코드 중복 회피 측면에서 &lt;code class=&quot;language-text&quot;&gt;make_unique&lt;/code&gt; 함수가 낫다고 한다.&lt;/p&gt;
&lt;p&gt;( 출처 : Scott Meyers 저서 “Effective Modern C++” )&lt;/p&gt;
&lt;h2 id=&quot;reset-및-release&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#reset-%EB%B0%8F-release&quot; aria-label=&quot;reset 및 release permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;Reset 및 Release&lt;/h2&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;cpp&quot;&gt;&lt;pre class=&quot;language-cpp&quot;&gt;&lt;code class=&quot;language-cpp&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;int&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;*&lt;/span&gt; pInt1 &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;int&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;2017&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;int&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;*&lt;/span&gt; pInt2 &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;int&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;2018&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;

&lt;span class=&quot;token keyword&quot;&gt;auto&lt;/span&gt; ptr &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; std&lt;span class=&quot;token operator&quot;&gt;::&lt;/span&gt;make_unique&lt;span class=&quot;token operator&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;token keyword&quot;&gt;int&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;&gt;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;pInt1&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;

&lt;span class=&quot;token comment&quot;&gt;// 기존의 pInt1는 소멸되고 pInt2의 소유권을 가진다.&lt;/span&gt;
ptr&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;reset&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;pInt2&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;

&lt;span class=&quot;token comment&quot;&gt;// 기존의 pInt2는 소멸되고, 아무 것도 소유하지 않는다.&lt;/span&gt;
ptr&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;reset&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;위 예제와 같이 다른 포인터의 소유권을 가져올 수 있다.
만약 &lt;code class=&quot;language-text&quot;&gt;reset&lt;/code&gt; 함수에 파라미터가 주어지지 않는다면, 기존에 소유하던 포인터만 소멸시킨다.&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;cpp&quot;&gt;&lt;pre class=&quot;language-cpp&quot;&gt;&lt;code class=&quot;language-cpp&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;int&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;*&lt;/span&gt; pInt1 &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;int&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;2018&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;int&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;*&lt;/span&gt; pInt2 &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;nullptr&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;

&lt;span class=&quot;token keyword&quot;&gt;auto&lt;/span&gt; ptr &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; std&lt;span class=&quot;token operator&quot;&gt;::&lt;/span&gt;make_unique&lt;span class=&quot;token operator&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;token keyword&quot;&gt;int&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;&gt;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;pInt1&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;

&lt;span class=&quot;token comment&quot;&gt;// 소유권을 반환한다. (포인터 소멸X)&lt;/span&gt;
pInt2 &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; ptr&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;release&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
std&lt;span class=&quot;token operator&quot;&gt;::&lt;/span&gt;cout &lt;span class=&quot;token operator&quot;&gt;&amp;lt;&amp;lt;&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;*&lt;/span&gt;pInt2&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;token comment&quot;&gt;// [결과] : 2018&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;&lt;code class=&quot;language-text&quot;&gt;release()&lt;/code&gt; 함수를 통해 메모리 해제 없이 소유권만을 반환한다.&lt;/p&gt;
&lt;h2 id=&quot;custom-deleter-커스텀-삭제자&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#custom-deleter-%EC%BB%A4%EC%8A%A4%ED%85%80-%EC%82%AD%EC%A0%9C%EC%9E%90&quot; aria-label=&quot;custom deleter 커스텀 삭제자 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;Custom Deleter (커스텀 삭제자)&lt;/h2&gt;
&lt;p&gt;&lt;code class=&quot;language-text&quot;&gt;unique_ptr&lt;/code&gt;이 소유하던 포인터를 소멸시킬 때, 그 객체를 delete 하는 방식으로 소멸시킨다.&lt;/p&gt;
&lt;p&gt;다른 방식의 소멸 구현이 필요할 때는 그 객체만을 위한 Deleter를 만들어 지정할 수 있다.&lt;/p&gt;
&lt;p&gt;Custom Deleter 는 &lt;strong&gt;Functor&lt;/strong&gt;가 될 수도 있고, 아래 예제와 같이 &lt;strong&gt;Lambda 함수&lt;/strong&gt;가 될 수도 있다.&lt;/p&gt;
&lt;p&gt;( 물론 &lt;strong&gt;함수 포인터&lt;/strong&gt;도 가능하며 &lt;code class=&quot;language-text&quot;&gt;std::function&lt;/code&gt;도 사용 가능하다. )&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;cpp&quot;&gt;&lt;pre class=&quot;language-cpp&quot;&gt;&lt;code class=&quot;language-cpp&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;auto&lt;/span&gt; deleter &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;Human&lt;span class=&quot;token operator&quot;&gt;*&lt;/span&gt; human&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
  &lt;span class=&quot;token keyword&quot;&gt;delete&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt; human&lt;span class=&quot;token operator&quot;&gt;-&gt;&lt;/span&gt;name&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
  &lt;span class=&quot;token keyword&quot;&gt;delete&lt;/span&gt; human&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;
&lt;span class=&quot;token comment&quot;&gt;// Deleter를 지정한다.&lt;/span&gt;
std&lt;span class=&quot;token operator&quot;&gt;::&lt;/span&gt;unique_ptr&lt;span class=&quot;token operator&quot;&gt;&amp;lt;&lt;/span&gt;Human&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;decltype&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;deleter&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;&gt;&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;ptr&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token keyword&quot;&gt;new&lt;/span&gt; Human&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; deleter&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;( 주의 : &lt;code class=&quot;language-text&quot;&gt;std::make_unique&lt;/code&gt;를 사용한 생성에는 Custom Deleter를 지정할 수 없음. )&lt;/p&gt;
&lt;h2 id=&quot;데이터-접근&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#%EB%8D%B0%EC%9D%B4%ED%84%B0-%EC%A0%91%EA%B7%BC&quot; aria-label=&quot;데이터 접근 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;데이터 접근&lt;/h2&gt;
&lt;p&gt;이 스마트 포인터를 사용하다 보면 &lt;code class=&quot;language-text&quot;&gt;unique_ptr&lt;/code&gt;이 포인터를 소유하고 있는지 확인할 필요가 있을 것이다.&lt;/p&gt;
&lt;p&gt;&lt;code class=&quot;language-text&quot;&gt;unique_ptr::operator bool()&lt;/code&gt; 이 정의되어 있기 때문에 다음과 같이 확인하면 된다.&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;cpp&quot;&gt;&lt;pre class=&quot;language-cpp&quot;&gt;&lt;code class=&quot;language-cpp&quot;&gt;std&lt;span class=&quot;token operator&quot;&gt;::&lt;/span&gt;unique_ptr&lt;span class=&quot;token operator&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;token keyword&quot;&gt;int&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;&gt;&lt;/span&gt; ptr&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;

&lt;span class=&quot;token keyword&quot;&gt;if&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;ptr&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
  std&lt;span class=&quot;token operator&quot;&gt;::&lt;/span&gt;cout &lt;span class=&quot;token operator&quot;&gt;&amp;lt;&amp;lt;&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;*&lt;/span&gt;ptr &lt;span class=&quot;token operator&quot;&gt;&amp;lt;&amp;lt;&lt;/span&gt; std&lt;span class=&quot;token operator&quot;&gt;::&lt;/span&gt;endl&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;

&lt;span class=&quot;token keyword&quot;&gt;else&lt;/span&gt;
  std&lt;span class=&quot;token operator&quot;&gt;::&lt;/span&gt;cout &lt;span class=&quot;token operator&quot;&gt;&amp;lt;&amp;lt;&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;데이터가 존재하지 않음.\n&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;또한, &lt;code class=&quot;language-text&quot;&gt;unique_ptr&lt;/code&gt;이 가지고 있는 데이터에 접근할 때는 기존의 Raw Pointer 사용하던 것 처럼 &lt;code class=&quot;language-text&quot;&gt;*&lt;/code&gt;, &lt;code class=&quot;language-text&quot;&gt;-&amp;gt;&lt;/code&gt; 연산자를 통해 접근하면 된다.&lt;/p&gt;
&lt;h2 id=&quot;move-semantics&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#move-semantics&quot; aria-label=&quot;move semantics permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;move semantics&lt;/h2&gt;
&lt;p&gt;C++11에서 도입된 기능 중에 제일 중요한 기능이 &lt;em&gt;rvalue 참조&lt;/em&gt;와 &lt;em&gt;move semantics&lt;/em&gt; 라고 생각한다.&lt;/p&gt;
&lt;p&gt;&lt;code class=&quot;language-text&quot;&gt;unique_ptr&lt;/code&gt;는 &lt;em&gt;rvalue&lt;/em&gt;에 대해서는 대입 연산을 허용하고 있기 때문에 아래 예제와 같이 &lt;code class=&quot;language-text&quot;&gt;std::move&lt;/code&gt; 함수를 이용해서 &lt;strong&gt;소유권을 이동&lt;/strong&gt;하는 것이 가능하다.&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;cpp&quot;&gt;&lt;pre class=&quot;language-cpp&quot;&gt;&lt;code class=&quot;language-cpp&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;auto&lt;/span&gt; ptr1 &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; std&lt;span class=&quot;token operator&quot;&gt;::&lt;/span&gt;make_unique&lt;span class=&quot;token operator&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;token keyword&quot;&gt;int&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;&gt;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;2018&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;

&lt;span class=&quot;token comment&quot;&gt;// 소유권 이동. ptr1는 사용 불가.&lt;/span&gt;
std&lt;span class=&quot;token operator&quot;&gt;::&lt;/span&gt;unique_ptr&lt;span class=&quot;token operator&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;token keyword&quot;&gt;int&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;&gt;&lt;/span&gt; ptr2 &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; std&lt;span class=&quot;token operator&quot;&gt;::&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;move&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;ptr1&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;h2 id=&quot;references&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#references&quot; aria-label=&quot;references permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;references&lt;/h2&gt;
&lt;p&gt;Scott Meyers - ”&lt;em&gt;Effective Modern C++&lt;/em&gt;”&lt;/p&gt;
&lt;p&gt;&lt;a href=&quot;https://msdn.microsoft.com/ko-kr/library/hh279676.aspx&quot;&gt;https://msdn.microsoft.com/ko-kr/library/hh279676.aspx&lt;/a&gt;&lt;/p&gt;</content:encoded></item><item><title><![CDATA[현대인의 인공지능 공포증]]></title><description><![CDATA[《터미네이터》, 《매트릭스》, 《바이센테니얼 맨》, 《트랜센던스》. 인공지능(AI…]]></description><link>https://blog.frec.kr/essay/essay-0/</link><guid isPermaLink="false">https://blog.frec.kr/essay/essay-0/</guid><pubDate>Wed, 13 Dec 2017 00:00:00 GMT</pubDate><content:encoded>&lt;p&gt;《터미네이터》, 《매트릭스》, 《바이센테니얼 맨》, 《트랜센던스》. 인공지능(AI)이 주제인 영화들이다. 문명이 산업 시대를 넘어 정보화 시대가 열리면서 컴퓨터의 연산 능력은 기하급수적으로 높아졌고, 인간은 인공적으로 유사 ‘지능’을 창조하기에 이르렀다. 여러 분야에서 인간보다 월등한 인공지능이 계속 발전을 거듭하였고, 이는 인류 문명에 위협이 된다고 생각하는 사람도 늘어났다. 이러한 사람들의 생각에 맞추어서, 인공지능이 사회를 지배하는 암울한 근미래를 다룬 영화들이 많이 개봉했다. 그리고 인공지능에 대한 두려움은 지구촌 전체로 퍼져나갔다. 맹목적으로까지 보이는 사람들의 두려움이 과연 근거가 있는 두려움일까 고민하게 되었다.  &lt;/p&gt;
&lt;p&gt;사람들의 인공지능 공포증에 대해 생각하기 전, 인공지능 자체에 대해 다시 알아보았다. 인공지능에 대한 현대적인 정의는 1956년 존 매카시라는 공학자가 제안한 것으로, “기계를 인간 행동의 지식에서와 같이 행동하게 만드는 것”이라고 하였다. 단순하게 생각하면 인공지능은 사고하는 기계인 것이다. 그렇지 않아도 엄청난 속도의 정보 처리 능력을 가지고 있는 컴퓨터가, 초보적이지만 지능을 가지고 있다는 것은 분명 충격으로 다가올 것이다. 하지만 인공지능의 분야는 매우 방대해서, 사람들이 두려워하는 ‘스스로 사고하고 판단하는 인공지능’은 강인공지능이라 불리고, 그보다 저수준의 지능을 흉내 내는 인공지능은 약인공지능이라 불린다. 아직 현대는 약인공지능만이 개발되어 사용 중인 시대다.  &lt;/p&gt;
&lt;p&gt;인공지능 비판론자들은 벌써 인공지능이 우리 주변을 잠식해가고 있다고 말하는데, 어떻게 보면 옳은 말이다. 최근에 여러 회사에서 경쟁적으로 출시하는 음성인식 AI 스피커도 하나의 예시가 될 수 있으며, 우리가 모두 들고 다니는 스마트폰에도 시리, 빅스비 같은 AI가 탑재되어 있다. 또, 몇 년 전의 알파고는 사람들이 생각하는 대표적인 인공지능이다. 이렇게 여러 인공지능이 등장했으며 앞으로도 계속 발전되어 등장할 것이고, 인공지능이 인간의 일자리를 뺏어갈 시대가 다가오는 것처럼 보인다. 물론 인공지능이 여러 직종을 대체할 것이긴 하지만, 그렇다고 인공지능을 두려워할 이유가 있을까? AI, 로봇에 의해 대체되는 직종들은 대부분 고전적인 단순 노동의 직종이고 굳이 AI가 아니더라도 사라질 직종으로 평가받는다. 일자리에 대한 걱정이 아니라면, 결국 인간의 인공지능에 대한 두려움은 단 한 가지 이유에서 기인한 것으로 보인다. 먼 훗날, 인간이 창조한 지능에 의해 인류가 지배당할 것이라는 영화가 창조한 믿음.  &lt;/p&gt;
&lt;p&gt;하지만 사람들은 왜 영화와 같이 인공지능이 인간을 이기는 것은 두려워하면서, 주변에서 흔히 볼 수 있는 시리와 같은 스마트폰의 인공지능은 두려워하지 않을까? 여러 고민을 해본 끝에 내린 결론은 인간들이 역사적으로 신기술에 대해 본능적으로 두려움을 가지고 있고, 공포 분위기를 조성하는 사람들이 있다는 것이다. 선사시대에 불의 사용법을 알게 된 인류도 그 예시가 될 수 있다. 그리고 공포 분위기를 조성하는 사람들은 어느 시대에나 항상 존재했으며, 현대에는 관련 영화 제작자들이 그들이라고 생각한다. 인공지능으로 인한 디스토피아를 그린 영화들은, 인공지능을 떠올릴 때 인간을 지배하는 기계 로봇들의 사회를 바로 연상시키게 만들어버렸다. SF 영화가 많은 경우 허구를 그리긴 하지만, 인공지능이 인류를 지배하여 암울한 미래가 펼쳐진다는 클리셰를 사용하면서 온 지구촌에 두려움을 퍼뜨리는 과한 자극을 주지 않았으면 좋겠다고 생각한다. 그리고 인공지능이 어느 면에서 인간에게 피해를 주긴 하지만, 인공지능의 발전으로 우리가 입는 피해보다는 얻는 것이 더 많다고 생각한다. AI는 우리에게 윤택한 삶을 가져다 줄 수 있다. 생활에 있어서 불필요한 과정은 AI가 자동으로 처리하고 해결해주면 편안한 삶을 영위할 수 있지 않을까.  &lt;/p&gt;
&lt;p&gt;강인공지능으로의 발전은 멀고 험난하기에 아직 잘 알지도 못하는 미래에 대해 맹목적인 두려움을 가질 필요는 없다고 생각한다. 인간이 인공지능에게 지배당하는 것이 아니라 인간이 몇 가지 일처리를 인공지능에게 위임하는 미래가 펼쳐질 것으로 생각한다. 물론 인공지능의 발전이 가져올 미래에 대한 대비는 해야 하지만, 출처가 불분명한 두려움에 몸서리치며 스스로를 공포의 지배 하에 두지 않았으면 좋겠다.&lt;/p&gt;</content:encoded></item></channel></rss>